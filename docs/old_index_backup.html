<!DOCTYPE html>

<html lang="fr">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Mon Carnet d'Aventure Scout %</title>

    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles/main.css">

    <style>

        @keyframes floatUp {

            0% {

                transform: translateY(0) scale(1);

                opacity: 1;

            }

            100% {

                transform: translateY(-50px) scale(0.5);

                opacity: 0;

            }

        }

        

        @keyframes shake {

            0%, 100% { transform: translateX(0); }

            25% { transform: translateX(-5px); }

            75% { transform: translateX(5px); }

        }

        

        @keyframes slideIn {

            from {

                transform: translateX(100%);

                opacity: 0;

            }

            to {

                transform: translateX(0);

                opacity: 1;

            }

        }

        

        @keyframes slideOut {

            from {

                transform: translateX(0);

                opacity: 1;

            }

            to {

                transform: translateX(100%);

                opacity: 0;

            }

        }

    </style>

</head>

<body>

    <!-- D%cor for%t anim%e -->

    <div class="moonlight-rays"></div>

    <div class="magic-trees" id="trees"></div>

    <div class="fey-leaves" id="leaves"></div>

    <div class="fey-fireflies" id="fireflies"></div>

    <div class="fairy-sparkles" id="sparkles"></div>

    <div class="fairy-wings" id="wings"></div>

    <div class="magic-mushrooms" id="mushrooms"></div>

    <div class="starlight-twinkle" id="stars"></div>



    <!-- Page de connexion -->

    <div id="loginPage" class="fey-container" style="display: none;">

        <h1 class="fey-title"> Acc%s Scout </h1>

        <p class="fey-subtitle">Entrez le mot de passe pour acc%der au carnet d'aventure</p>



        <div class="fey-card" style="max-width: 400px; margin: 2rem auto;">

            <div class="fey-card-header"> Authentification</div>

            <div style="text-align: center;">

                <input type="password" id="passwordInput" placeholder="Mot de passe scout..."

                       style="width: 100%; padding: 1rem; font-size: 1.1rem; border: 3px solid var(--c-ink-900); border-radius: var(--r-sm); margin-bottom: 1rem; font-family: 'Patrick Hand', cursive;">

                <button id="loginBtn" class="fey-btn" style="width: 100%; font-size: 1.2rem;">

                    % Entrer dans l'aventure %

                </button>

                <div id="errorMessage" style="color: #d32f2f; margin-top: 1rem; font-weight: bold; display: none;">

                     Mot de passe incorrect !

                </div>

            </div>

        </div>



        <div class="fey-note" style="text-align: center; max-width: 500px; margin: 2rem auto;">

            <strong> Carnet d'aventure scout</strong><br>

            Ce site contient des informations priv%es pour les scouts et leurs familles.

        </div>

    </div>



    <!-- Contenu principal -->

    <div id="mainContent" class="fey-container" style="display: block;">

        <h1 class="fey-title">% Mon carnet d'aventure %</h1>

        <p class="fey-subtitle">Prochaine sortie % Jambville ,% Octobre 2025</p>



        <nav class="fey-nav">

            <button class="fey-tab active" onclick="window.showPage('liste')"> Ma Liste</button>

            <button class="fey-tab" onclick="window.showPage('tente')">Q% La Tente</button>

            <button class="fey-tab" onclick="window.showPage('infos')">% Infos</button>

            <button class="fey-tab" onclick="window.showPage('equipes')"> %quipes</button>

            <button class="fey-tab" onclick="window.showPage('calendrier')"> Calendrier</button>

            <button class="fey-tab" onclick="window.showPage('covoiturage')"> Covoiturage</button>

            <button class="fey-tab" onclick="window.showPage('chansons')"> Chansons</button>

            <button class="fey-tab" onclick="window.showPage('marin')"> Marin</button>

            <button class="fey-tab" onclick="window.showPage('loi')"> Loi Scout</button>

            <button class="fey-tab" onclick="window.showPage('admin')" id="adminTab" style="display: none; background: #9C27B0; color: white;"> Admin</button>

            <button class="fey-tab" onclick="window.showPage('registre')" id="registreTab" style="display: none; background: #FF5722; color: white;"> Registre d'Appel</button>

            <button class="fey-tab" onclick="logout()" style="background: #d32f2f; color: white;"> D%connexion</button>

        </nav>



        <!-- PAGE 1: LISTE -->

        <div id="liste" class="fey-page active">

        <div class="fey-stats">

            <div class="fey-stat">

                <span class="fey-stat-number" id="checkedCount">0</span>

                <span class="fey-stat-label"> Sac pr%t</span>

            </div>

            <div class="fey-stat" style="background: linear-gradient(135deg, var(--c-forest-700), var(--c-forest-500));">

                <span class="fey-stat-number" id="percentComplete">0%</span>

                <span class="fey-stat-label"> Aventure</span>

            </div>

            <div class="fey-stat" style="background: linear-gradient(135deg, #FF6B35, #FF8E53);">

                <span class="fey-stat-number" id="tempsRestant">2j</span>

                <span class="fey-stat-label">% D%part</span>

            </div>

        </div>



        <!-- Message pour les parents -->

        <div class="fey-card" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 6px solid #2196F3; margin-bottom: 2rem;">

            <div class="fey-card-header"> Message pour les Parents</div>

            <div class="fey-note" style="background: transparent; border: none; margin: 0;">

                <strong> Astuce :</strong> Cliquez sur les liens "exemple " pour voir le mat%riel recommand% !<br>

                <strong>% Temps de pr%paration :</strong> Comptez 30-45 minutes pour tout v%rifier.<br>

                <strong> Sauvegarde :</strong> Votre liste se sauvegarde automatiquement !

            </div>

        </div>



        <!-- Technique des 3 couches -->

        <div class="fey-card" style="margin-bottom: 2rem;">

            <div class="fey-card-header"> Technique des 3 couches</div>

            <div style="text-align: center; margin-bottom: 1rem;">

                <img src="./images/layering-guide.JPG"

                     alt="Guide des v%tements selon la temp%rature - Il n'y a pas de mauvais temps, seulement de mauvais v%tements"

                     style="width: 100%; max-width: 300px; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                <p style="font-size: 0.8rem; color: var(--c-forest-700); margin-top: 0.5rem; font-style: italic;">

                     "Il n'y a pas de mauvais temps, seulement de mauvais v%tements !"

                </p>

            </div>



            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1.5rem 0;">

                <div style="background: linear-gradient(135deg, #ff69b4, #ffb6c1); color: white; padding: 1rem; border-radius: var(--r-md); border: 2px solid var(--c-ink-900);">

                    <h4 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem;">1 COUCHE DE BASE</h4>

                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem;"><strong>R%$%le :</strong> %vacue la transpiration</p>

                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem;"><strong>Mat%riau :</strong> Laine m%rinos ou synth%tique</p>

                    <p style="font-size: 0.9rem;"><strong> %viter :</strong> Le coton (reste humide)</p>

                </div>



                <div style="background: linear-gradient(135deg, #32cd32, #90ee90); color: white; padding: 1rem; border-radius: var(--r-md); border: 2px solid var(--c-ink-900);">

                    <h4 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem;">2 COUCHE D'ISOLATION</h4>

                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem;"><strong>R%$%le :</strong> Retient la chaleur corporelle</p>

                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem;"><strong>Mat%riau :</strong> Polaire, duvet, synth%tique</p>

                    <p style="font-size: 0.9rem;"><strong> Astuce :</strong> L%ger et compressible</p>

                </div>



                <div style="background: linear-gradient(135deg, #87ceeb, #b0e0e6); color: white; padding: 1rem; border-radius: var(--r-md); border: 2px solid var(--c-ink-900);">

                    <h4 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem;">3 COUCHE DE PROTECTION</h4>

                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem;"><strong>R%$%le :</strong> Prot%ge des %l%ments</p>

                    <p style="font-size: 0.9rem; margin-bottom: 0.5rem;"><strong>Mat%riau :</strong> Imperm%able et respirant</p>

                    <p style="font-size: 0.9rem;"><strong> R%sistant :</strong> Vent, pluie, neige</p>

                </div>

            </div>

        </div>



        <!-- Mise en page en deux colonnes : Liste % gauche, Sac % droite -->

        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-bottom: 2rem;">

            <!-- Colonne gauche : Liste des %l%ments -->

            <div>



            <div class="fey-card">

                <div class="fey-card-header" onclick="toggleCategory('sac-couchage')" style="cursor: pointer; user-select: none;">

                     Sac et couchage <span id="sac-couchage-arrow" style="float: right; transition: transform 0.3s;">]%</span>

                </div>

                <div id="sac-couchage-content" class="fey-items">

                    <div class="fey-item">

                        <input type="checkbox" id="item1">

                        <label for="item1">

                            Sac % dos de camping (40L)

                            <a href="https://www.decathlon.fr/p/sac-a-dos-de-randonnee-trekking-enfant-40-10l-mh500-jr/_/R-p-324618?mc=8608376&c=bleu" target="_blank" class="fey-link">exemple </a>

                            <span class="fey-tooltip"> Pour le gros mat%riel. + Petit sac pliable pour les sorties : <a href="https://www.decathlon.fr/p/sac-a-dos-pliable-10l-travel/_/R-p-309861" target="_blank" style="color: var(--c-orange-600);">sac 10L </a></span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item2">

                        <label for="item2">

                            Sac de couchage confort 0,%%C

                            <a href="https://www.decathlon.fr/p/sac-de-couchage-de-camping-arpenaz-0-c/_/R-p-170019" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item3">

                        <label for="item3">

                            Sac % viande polaire

                            <a href="https://www.amazon.fr/dp/B0837GD38D?ref=ppx_yo2ov_dt_b_fed_asin_title&th=1" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item4">

                        <label for="item4">

                            Matelas autogonflant

                            <a href="https://www.decathlon.fr/p/matelas-autogonflant-de-camping-basic-60-cm-1-personne/_/R-p-312934?mc=8575620&c=bleu" target="_blank" class="fey-link">exemple </a>

                            <span class="fey-tooltip"> Plus confortable que la mousse ! Se gonfle tout seul.</span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item5">

                        <label for="item5">Oreiller (optionnel)</label>

                    </div>

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header" onclick="toggleCategory('v%tements')" style="cursor: pointer; user-select: none;">

                     V%tements <span id="v%tements-arrow" style="float: right; transition: transform 0.3s;">]%</span>

                </div>

                <div id="v%tements-content" class="fey-items">

                    <div class="fey-item">

                        <input type="checkbox" id="item6">

                        <label for="item6">T-shirts (2)</label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item7">

                        <label for="item7">

                            Sous-pull thermique (Heattech)

                            <a href="https://www.uniqlo.com/fr/fr/kids/heattech" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item8">

                        <label for="item8">

                            Pantalon confortable / Legging thermique

                            <a href="https://www.uniqlo.com/fr/fr/kids" target="_blank" class="fey-link">exemple </a>

                            <span class="fey-tooltip"> Selon m%t%o : legging thermique (froid) ou pantalon normal (doux).</span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item9">

                        <label for="item9">

                            Surpantalon imperm%able

                            <a href="https://www.decathlon.fr/p/surpantalon-impermeable-junior-100-vert/_/R-p-13028?mc=8314176&c=vert" target="_blank" class="fey-link">exemple </a>

                            <span class="fey-tooltip"> % porter par-dessus legging thermique ou pantalon polaire selon la m%t%o.</span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item10">

                        <label for="item10">

                            Polaire chaude

                            <a href="https://www.decathlon.fr/p/polaire-sherpa-chaude-enfant-7-15-ans-nh-900-blanc-et-violet/_/R-p-331697?mc=8817042&c=beige_gris_vert" target="_blank" class="fey-link">exemple </a>

                            <span class="fey-tooltip"> Alternative au pantalon : polaire chaude pour les jours tr%s froids.</span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item11">

                        <label for="item11">

                            Veste imperm%able

                            <a href="https://www.decathlon.fr/p/veste-impermeable-de-randonnee-nature-nh100-raincut/_/R-p-301349" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item12">

                        <label for="item12">Sous-v%tements (2)</label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item13">

                        <label for="item13">

                            Chaussettes chaudes (3-4 paires)

                            <span class="fey-tooltip"> 2 paires minimum % chaque fois parce qu'il pleut ! 1 pour la journ%e + 1 pour le soir. Les pieds mouill%s = froid garanti !</span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item14">

                        <label for="item14">Pyjama chaud</label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item15">

                        <label for="item15">

                            Foulard scout

                            <a href="https://boutique.sgdf.fr/foulards/308-foulard-scouts-guides.html" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item16">

                        <label for="item16">Gants imperm%ables</label>

                    </div>

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header" onclick="toggleCategory('chaussures')" style="cursor: pointer; user-select: none;">

                     Chaussures <span id="chaussures-arrow" style="float: right; transition: transform 0.3s;">]%</span>

                </div>

                <div id="chaussures-content" class="fey-items">

                    <div class="fey-item">

                        <input type="checkbox" id="item19">

                        <label for="item19">

                            Chaussures imperm%ables (boue)

                            <a href="https://www.decathlon.fr/p/chaussures-de-randonnee-montagne-enfant-crossrock-mid/_/R-p-301412" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item20">

                        <label for="item20">Chaussures s%ches (soir)</label>

                    </div>

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header">]% Hygi%ne</div>

                <div class="fey-items">

                    <div class="fey-item">

                        <input type="checkbox" id="item21">

                        <label for="item21">Brosse % dents + dentifrice</label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item22">

                        <label for="item22">

                            Serviette microfibre

                            <a href="https://www.decathlon.fr/p/serviette-microfibre-ultra-compacte/_/R-p-170644" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item23">

                        <label for="item23">Mouchoirs</label>

                    </div>

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header"> Repas</div>

                <div class="fey-items">

                    <div class="fey-item">

                        <input type="checkbox" id="item24">

                        <label for="item24">

                            Gourde

                            <a href="https://www.decathlon.fr/p/gourde-randonnee-900-bouchon-instantane-1-litre-aluminium/_/R-p-2064" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item25">

                        <label for="item25">

                            Thermos (chocolat chaud)

                            <a href="https://www.decathlon.fr/p/bouteille-isotherme-randonnee-inox-05l/_/R-p-301841" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item26">

                        <label for="item26">

                            Gamelle / Quart / Popote

                            <a href="https://www.decathlon.fr/p/lunch-box-randonnee-camp-du-randonneur-aluminium-1l/_/R-p-301837" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item27">

                        <label for="item27">

                            Couverts

                            <a href="https://www.decathlon.fr/p/couverts-camping-3-en-1/_/R-p-1884" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header"> Divers</div>

                <div class="fey-items">

                    <div class="fey-item">

                        <input type="checkbox" id="item29">

                        <label for="item29">

                            Lampe frontale (lib%re les mains !)

                            <a href="https://www.decathlon.fr/p/lampe-frontale-de-bivouac-a-piles-bivouac-500-usb-100-lumens/_/R-p-301785" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item30">

                        <label for="item30">Piles de rechange</label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item31">

                        <label for="item31">

                            Opinel % bout rond

                            <a href="https://www.opinel.com/couteaux-de-poche/mon-premier-opinel" target="_blank" class="fey-link">exemple </a>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item32">

                        <label for="item32">

                            Sacs poubelle (protection)

                            <span class="fey-tooltip"> Pour mettre les chaussures mouill%es % l'ext%rieur de la tente ! Garde l'int%rieur sec.</span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item33">

                        <label for="item33">

                            Pochettes %tanches

                            <span class="fey-tooltip"> Pour le carnet et stylo ! %vite que les feuilles se mouillent avec la pluie.</span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item34">

                        <label for="item34">Feuille et crayon</label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item35">

                        <label for="item35">

                            Jeu de l'escapade

                            <a href="https://boutique.sgdf.fr/jeux-et-activites/326-jeu-de-l-escapade.html" target="_blank" class="fey-link">exemple </a>

                            <span class="fey-tooltip"> Avec pochette plastique pour prot%ger les feuilles du carnet de jeu !</span>

                        </label>

                    </div>

                    <div class="fey-item">

                        <input type="checkbox" id="item36">

                        <label for="item36">V%tements cocoon (soir)</label>

                    </div>

                </div>

            </div>

            </div>



            <!-- Colonne droite : Animation du Sac % Dos -->

            <div>

                <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 6px solid #4CAF50; position: sticky; top: 2rem; z-index: 100;">

                    <div class="fey-card-header"> Animation du Sac % Dos</div>

                    <div style="text-align: center; padding: 2rem;">

                        <div id="backpackContainer" style="position: relative; display: inline-block; margin-bottom: 1rem;">

                            <div id="backpack" style="

                                width: 200px;

                                height: 250px;

                                background: linear-gradient(135deg, #8B4513, #A0522D);

                                border-radius: 20px 20px 5px 5px;

                                position: relative;

                                border: 3px solid #654321;

                                box-shadow: 0 8px 16px rgba(0,0,0,0.3);

                            ">

                                <!-- Sac % dos vide -->

                                <div style="

                                    position: absolute;

                                    top: 10px;

                                    left: 10px;

                                    right: 10px;

                                    bottom: 10px;

                                    background: linear-gradient(135deg, #2C3E50, #34495E);

                                    border-radius: 15px 15px 3px 3px;

                                    border: 2px solid #1A252F;

                                "></div>

                                

                                <!-- Contenu qui se remplit -->

                                <div id="backpackContent" style="

                                    position: absolute;

                                    top: 10px;

                                    left: 10px;

                                    right: 10px;

                                    bottom: 10px;

                                    background: linear-gradient(135deg, #27AE60, #2ECC71);

                                    border-radius: 15px 15px 3px 3px;

                                    border: 2px solid #1E8449;

                                    transform: scaleY(0);

                                    transform-origin: bottom;

                                    transition: transform 0.5s ease-in-out;

                                    display: flex;

                                    align-items: center;

                                    justify-content: center;

                                    color: white;

                                    font-weight: bold;

                                    font-size: 1.2rem;

                                ">

                                    <span id="backpackText"></span>

                                </div>

                                

                                <!-- Sangles -->

                                <div style="

                                    position: absolute;

                                    top: 20px;

                                    left: -15px;

                                    width: 8px;

                                    height: 60px;

                                    background: #8B4513;

                                    border-radius: 4px;

                                    box-shadow: 2px 0 4px rgba(0,0,0,0.3);

                                "></div>

                                <div style="

                                    position: absolute;

                                    top: 20px;

                                    right: -15px;

                                    width: 8px;

                                    height: 60px;

                                    background: #8B4513;

                                    border-radius: 4px;

                                    box-shadow: -2px 0 4px rgba(0,0,0,0.3);

                                "></div>

                            </div>

                            

                            <!-- Particules d'animation -->

                            <div id="particles" style="

                                position: absolute;

                                top: 0;

                                left: 0;

                                right: 0;

                                bottom: 0;

                                pointer-events: none;

                                z-index: 10;

                            "></div>

                        </div>

                        

                        <div style="margin-top: 1rem;">

                            <div id="backpackProgress" style="

                                width: 100%;

                                height: 20px;

                                background: #E0E0E0;

                                border-radius: 10px;

                                overflow: hidden;

                                border: 2px solid #BDBDBD;

                                margin-bottom: 1rem;

                            ">

                                <div id="backpackProgressBar" style="

                                    height: 100%;

                                    background: linear-gradient(90deg, #4CAF50, #8BC34A);

                                    width: 0%;

                                    transition: width 0.5s ease-in-out;

                                    display: flex;

                                    align-items: center;

                                    justify-content: center;

                                    color: white;

                                    font-weight: bold;

                                    font-size: 0.9rem;

                                "></div>

                            </div>

                            <p id="backpackStatus" style="font-weight: bold; color: var(--c-forest-700); margin: 0;">

                                 Sac vide - Commencez % cocher les %l%ments !

                            </p>

                        </div>

                    </div>

                </div>

            </div>

        </div>



        <!-- Jeu de Sac Scout -->

        <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 6px solid #4CAF50; margin-bottom: 2rem;">

            <div class="fey-card-header"> Jeu de Pr%paration du Sac Scout</div>

            <div class="fey-note" style="background: transparent; border: none; margin: 0;">

                <strong> D%fi :</strong> Pr%pare ton sac en rangeant les objets dans les bonnes cat%gories !<br>

                <strong> Objectif :</strong> Range tout avant le d%part pour l'aventure !

            </div>

            <div style="text-align: center; margin-top: 1rem;">

                <button class="fey-btn" onclick="ouvrirJeuSac()" style="background: #4CAF50; font-size: 1.1rem; padding: 1rem 2rem;">

                     Commencer le Jeu du Sac

                </button>

            </div>

        </div>



            <div class="fey-progress">

                <div class="fey-progress-fill" id="progressBar">

                    0% - Pr%t pour l'aventure ?

                </div>

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #C8E6C9, #A5D6A7); border-left: 6px solid #4CAF50; margin-top: 2rem;">

                <div class="fey-card-header"> D%fis Bonus</div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">

                    <div style="background: white; padding: 1rem; border-radius: 8px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>

                        <strong>D%fi Sac</strong><br>

                        <small>Range tout en 5 minutes</small>

                    </div>

                    <div style="background: white; padding: 1rem; border-radius: 8px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">Q%</div>

                        <strong>D%fi Tente</strong><br>

                        <small>Monte ta tente vite !</small>

                    </div>

                    <div style="background: white; padding: 1rem; border-radius: 8px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>

                        <strong>D%fi Pluie</strong><br>

                        <small>Reste au sec !</small>

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE 2: TENTE -->

        <div id="tente" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                Q% Comment monter une tente canadienne ?

            </div>



            <div class="fey-card" style="margin-bottom: 2rem;">

                <div class="fey-card-header">c% Tutoriel Vid%o</div>

                <div style="background: linear-gradient(135deg, #4CAF50, #45a049); color: white; padding: 2rem; border-radius: var(--r-md); text-align: center; border: 3px solid var(--c-ink-900);">

                    <div style="font-size: 4rem; margin-bottom: 1rem;"></div>

                    <h3 style="font-family: 'Patrick Hand', cursive; font-size: 1.5rem; margin-bottom: 1rem;">

                        Vid%o de Montage de Tente

                    </h3>

                    <p style="margin-bottom: 1.5rem; font-size: 1.1rem;">

                        Regarde cette vid%o pour apprendre % monter ta tente %tape par %tape !

                    </p>

                    <button class="fey-btn" onclick="ouvrirVideoTutorial()" style="background: #FF6B35; font-size: 1.2rem; padding: 1rem 2rem;">

                        Q% Regarder la Vid%o

                    </button>

                    <div style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.9;">

                         Ou joue au jeu interactif ci-dessous pour t'entra%ner !

                    </div>

                </div>

            </div>





            <div class="fey-card">

                <div class="fey-card-header"> Technique Rapide - Guide Visuel</div>

                <div style="background: linear-gradient(135deg, #2E7D32, #4CAF50); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); margin-bottom: 1rem;">

                    <h3 style="font-family: 'Patrick Hand', cursive; font-size: 1.5rem; margin-bottom: 1rem; text-align: center; color: #FFD166;"> Guide Visuel des %tapes</h3>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">%</div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">1. Terrain plat</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Choisir un sol d%gag%, sans pierres</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: linear-gradient(to bottom, #4CAF50 0%, #2E7D32 100%); border-radius: 6px; position: relative; border: 2px solid #1B5E20;">

                                <div style="position: absolute; top: 0; left: 0; right: 0; height: 15px; background: linear-gradient(90deg, #4CAF50, #66BB6A, #4CAF50); border-radius: 4px 4px 0 0;"></div>

                            </div>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">2. Piquets % 45,%%</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Angle vers l'ext%rieur pour la stabilit%</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 2px; height: 30px; background: #8B4513; transform-origin: bottom; transform: translateX(-50%) rotate(45deg);"></div>

                                <div style="position: absolute; top: 8px; right: 5px; font-size: 8px; color: #FFD166; font-weight: bold;">45,%%</div>

                            </div>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">3. M%t central</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Position exacte au centre de la toile</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 3px; height: 35px; background: #8B4513;"></div>

                                <div style="position: absolute; top: 3px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 6px solid transparent; border-right: 6px solid transparent; border-bottom: 10px solid #FFD166;"></div>

                            </div>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">4. Haubans tendus</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Ajuster et tendre les cordes</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 2px; height: 30px; background: #8B4513;"></div>

                                <div style="position: absolute; top: 15px; left: 15px; right: 15px; height: 1px; background: #FFD166; transform: rotate(-15deg);"></div>

                            </div>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">5. Double-toit</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Protection contre la pluie</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 0; left: 8px; right: 8px; height: 20px; background: linear-gradient(135deg, #8B4513, #A0522D); border-radius: 3px;"></div>

                                <div style="position: absolute; top: 8px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-bottom: 15px solid #FFD166;"></div>

                            </div>

                        </div>

                    </div>

                </div>

            </div>



            <div class="fey-note">

                <strong> Astuce :</strong> Creuse une petite rigole autour de la tente pour %vacuer l'eau de pluie !

            </div>



            <div class="fey-card" style="margin-top: 2rem;">

                <div class="fey-card-header"> Jeu Interactif</div>

                <div class="fey-note">

                    <strong> Pr%t % mettre en pratique ?</strong><br>

                    Teste tes connaissances avec notre jeu interactif de montage de tente !

                </div>

                <div style="text-align: center; margin-top: 1.5rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                    <button class="fey-btn" onclick="ouvrirJeuTente()" style="font-size: 1.1rem; padding: 1rem 1.5rem;">

                         Jeu de Tente 1 

                    </button>

                    <button class="fey-btn" onclick="ouvrirJeuTente2()" style="font-size: 1.1rem; padding: 1rem 1.5rem;">

                         Jeu de Tente 2 

                    </button>

                </div>

                <div class="fey-note" style="background: rgba(139, 90, 43, 0.1); border-left: 4px solid #8B5A2B; margin-top: 1rem;">

                    <strong> D%fi :</strong> Monte ta tente en 6 %tapes et gagne des points !<br>

                    <strong> Bonus :</strong> Utilise le guide visuel ci-dessus pour t'aider !

                </div>

            </div>

        </div>



        <!-- PAGE 3: INFOS -->

        <div id="infos" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                % Informations & Contact

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 6px solid #4CAF50;">

                <div class="fey-card-header"> Dates & Horaires</div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2.5rem; margin-bottom: 1rem;"></div>

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 0.5rem;" id="info-outing-name">Week-end Scout</h3>

                        <p><strong id="info-outing-dates">Du 25 au 27 octobre 2025</strong></p>

                        <p style="font-size: 0.9rem; color: #666;">3 jours d'aventure !</p>

                    </div>

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2.5rem; margin-bottom: 1rem;"></div>

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 0.5rem;">D%part</h3>

                        <p><strong id="info-departure-time">Vendredi 8h30</strong></p>

                        <p style="font-size: 0.9rem; color: #666;" id="info-departure-location">%cole Notre-Dame</p>

                    </div>

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2.5rem; margin-bottom: 1rem;"></div>

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 0.5rem;">Retour</h3>

                        <p><strong id="info-return-time">Dimanche 17h00</strong></p>

                        <p style="font-size: 0.9rem; color: #666;">M%me lieu</p>

                    </div>

                </div>

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 6px solid #FF9800;">

                <div class="fey-card-header"> Lieu & Contact</div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem;">

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900);">

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem;"> Lieu du Camp</h3>

                        <p><strong id="info-camp-location">Jambville (78440)</strong></p>

                        <p style="font-size: 0.9rem; color: #666;">Centre de formation scout</p>

                        <button class="fey-btn" onclick="ouvrirMaps()" style="margin-top: 1rem; width: 100%;">Q% Voir sur la carte</button>

                    </div>

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900);">

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem;"> Contacts</h3>

                        <div id="info-contacts-list">

                            <!-- Les contacts seront charg%s dynamiquement -->

                        </div>

                        <button class="fey-btn" onclick="ouvrirWhatsApp()" style="margin-top: 1rem; width: 100%; background: #25D366;"> WhatsApp</button>

                    </div>

                </div>

            </div>



            <!-- Section Documents Parents -->

            <div class="fey-card" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 6px solid #2196F3;">

                <div class="fey-card-header"> Documents pour les Parents</div>

                <div style="text-align: center; padding: 2rem;">

                    <div style="font-size: 3rem; margin-bottom: 1rem;"></div>

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-marine-700); margin-bottom: 1rem;">Drive des Documents</h3>

                    <p style="margin-bottom: 2rem; font-size: 1.1rem;">Acc%dez aux documents importants, autorisations, listes et informations pour les parents.</p>

                    <button class="fey-btn" onclick="ouvrirDrive()" style="background: #2196F3; font-size: 1.2rem; padding: 1rem 2rem;">

                         Acc%der au Drive

                    </button>

                </div>

            </div>



            <div class="fey-qr-grid">

                <div class="fey-qr-card">

                    <h3> Groupe WhatsApp Parents</h3>

                    <div class="fey-qr-code">

                        <img src="./images/frame.png" alt="QR Code WhatsApp Parents" style="max-width: 150px; height: auto; border-radius: 8px;">

                    </div>

                    <p>Scannez le QR code pour rejoindre le groupe WhatsApp des parents</p>

                    <button class="fey-btn" style="margin-top: 1rem; background: #25D366;" onclick="ouvrirWhatsApp()"> Rejoindre le groupe</button>

                </div>



                <div class="fey-qr-card">

                    <h3> Calendrier des %v%nements Scouts</h3>

                    <div style="margin: 1rem 0; background: #f5f5f5; padding: 1rem; border-radius: 8px;">

                        <p style="text-align: center; color: #666; margin-bottom: 1rem;">Consultez tous les %v%nements et sorties pr%vus</p>

                        <div style="width: 100%; height: 400px; border-radius: 8px; overflow: hidden; border: 2px solid var(--c-ink-900);">

                            <iframe 

                                src="https://calendar.google.com/calendar/embed?height=400&wkst=1&ctz=Europe%2FParis&showPrint=0&src=ZWVmZmI4OGNlZTAyMWMzNDJjNjQwZmVmYTI1Y2FlMWNkMDcyYjlhMWY1Yjk1ZWFlODFiZDk5MTM0ZWVlM2ViYkBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&color=%23f09300" 

                                style="border: none; width: 100%; height: 100%;" 

                                frameborder="0" 

                                scrolling="no">

                            </iframe>

                        </div>

                        <p style="text-align: center; color: #666; margin-top: 0.5rem; font-size: 0.9rem;">

                            % Le calendrier se met % jour automatiquement

                        </p>

                    </div>

                </div>

            </div>

        </div>



        <!-- SECTION ADMIN INFOS -->

        <div id="adminSection" class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 6px solid #FF9800; margin-top: 2rem; display: none;">

            <div class="fey-card-header"> Administration - Informations Pratiques</div>

            <div style="padding: 1.5rem;">

                <!-- Bouton de connexion admin -->

                <div id="adminLoginSection" style="text-align: center; margin-bottom: 2rem; padding: 2rem; background: white; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                    <h3 style="color: var(--c-orange-600); margin-bottom: 1rem;"> Connexion Administrateur</h3>

                    <p style="margin-bottom: 1.5rem; color: #666;">Entrez le mot de passe administrateur pour acc%der aux fonctions d'%dition.</p>

                    <div style="display: flex; gap: 1rem; justify-content: center; align-items: center; flex-wrap: wrap;">

                        <input type="password" id="adminPassword" placeholder="Mot de passe admin" 

                               style="padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); font-size: 1rem; min-width: 200px;">

                        <button class="fey-btn" onclick="loginAdmin()" style="background: #FF9800;"> Se connecter</button>

                    </div>

                    <p style="margin-top: 1rem; font-size: 0.8rem; color: #666;">

                        Mot de passe admin: <strong>Scout2025!</strong>

                    </p>

                </div>



                <!-- Section admin authentifi%e -->

                <div id="adminAuthenticatedSection" style="display: none;">

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">

                        <p style="color: #666; margin: 0;">Modifiez les dates, horaires et lieux des sorties directement depuis cette page.</p>

                        <button class="fey-btn" onclick="logoutAdmin()" style="background: #f44336; font-size: 0.9rem;"> D%connexion</button>

                    </div>

                

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">

                    <!-- Prochaine Sortie -->

                    <div style="background: white; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem;">

                        <h4 style="color: var(--c-orange-600); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">

                             Prochaine Sortie

                            <button onclick="editNextOuting()" style="background: #FF9800; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer;"></button>

                        </h4>

                        <div id="nextOutingInfo">

                            <p><strong>Titre:</strong> <span id="nextOutingTitle">Sortie en for%t</span></p>

                            <p><strong>Date:</strong> <span id="nextOutingDate">15 d%cembre 2024</span></p>

                            <p><strong>Heure:</strong> <span id="nextOutingTime">09h00 - 17h00</span></p>

                            <p><strong>Lieu:</strong> <span id="nextOutingLocation">For%t de Compi%gne</span></p>

                            <p><strong>Contact:</strong> <span id="nextOutingContact">Marie (06 12 34 56 78)</span></p>

                        </div>

                    </div>



                    <!-- Lieu de Rendez-vous -->

                    <div style="background: white; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem;">

                        <h4 style="color: var(--c-orange-600); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">

                             Lieu de Rendez-vous

                            <button onclick="editMeetingPlace()" style="background: #FF9800; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer;"></button>

                        </h4>

                        <div id="meetingPlaceInfo">

                            <p><strong>Adresse:</strong> <span id="meetingPlaceAddress">Local Scout, 123 Rue de la Paix, 60200 Compi%gne</span></p>

                            <p><strong>Heure habituelle:</strong> <span id="meetingPlaceTime">08h30</span></p>

                            <p><strong>Contact local:</strong> <span id="meetingPlaceContact">Jean (06 98 76 54 32)</span></p>

                        </div>

                    </div>



                    <!-- Informations G%n%rales -->

                    <div style="background: white; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem;">

                        <h4 style="color: var(--c-orange-600); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">

                            c% Informations G%n%rales

                            <button onclick="editGeneralInfo()" style="background: #FF9800; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer;"></button>

                        </h4>

                        <div id="generalInfo">

                            <p><strong>Responsable:</strong> <span id="generalResponsable">Marie Dubois</span></p>

                            <p><strong>T%l%phone:</strong> <span id="generalPhone">06 12 34 56 78</span></p>

                            <p><strong>Email:</strong> <span id="generalEmail">marie.dubois@scouts.fr</span></p>

                            <p><strong>Horaires habituels:</strong> <span id="generalHours">Samedi 09h-17h</span></p>

                        </div>

                    </div>



                    <!-- Gestion des Contacts Ann%e -->

                    <div style="background: white; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem; grid-column: 1 / -1;">

                        <h4 style="color: var(--c-orange-600); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">

                             Contacts de l'Ann%e

                            <button onclick="addNewContact()" style="background: #4CAF50; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer;"></button>

                        </h4>

                        <div id="contactsList">

                            <!-- Les contacts seront charg%s ici -->

                        </div>

                    </div>

                </div>



                <div style="margin-top: 1.5rem; text-align: center;">

                    <button class="fey-btn" onclick="saveAllInfo()" style="background: #4CAF50; margin-right: 1rem;">

                         Sauvegarder toutes les informations

                    </button>

                    <button class="fey-btn" onclick="resetAllInfo()" style="background: #f44336;">

                         R%initialiser

                    </button>

                </div>

                </div>

            </div>

        </div>



        <!-- PAGE 4: %QUIPES -->

        <div id="equipes" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                 Les %quipes de Vie

            </div>



            <div class="fey-note" style="margin-bottom: 2rem;">

                <strong> C'est quoi une %quipe de vie ?</strong><br>

                Pendant le week-end, tu feras partie d'une petite %quipe. Ensemble, vous monterez votre tente, pr%parerez les repas et vivrez de super aventures !

            </div>



            <div id="vieTeamsDisplay" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem;">

                <!-- Les %quipes de vie seront charg%es dynamiquement -->

            </div>



            <div class="fey-note" style="margin-top: 2rem;">

                <strong> Missions d'%quipe :</strong><br>

                 Monter et ranger la tente ensemble<br>

                 Pr%parer les repas<br>

                 Participer aux grands jeux<br>

                 S'entraider et faire vivre la bonne humeur !

            </div>



            <div class="fey-card" style="margin-top: 2rem;">

                <div class="fey-card-header"> %quipes de Nuit</div>

                <div class="fey-note">

                    <strong> C'est quoi une %quipe de nuit ?</strong><br>

                    Pendant la nuit, vous serez r%partis en petites %quipes pour dormir ensemble dans vos tentes. C'est l'occasion de partager des moments calmes et de cr%er des liens !

                </div>



                <div id="nuitTeamsDisplay" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">

                    <!-- Les %quipes de nuit seront charg%es dynamiquement -->

                </div>

            </div>



            <!-- Registres des Sorties -->

            <div class="fey-card" style="margin-top: 2rem; background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800;">

                <div class="fey-card-header"> Registres des Sorties</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong> Gestion des registres</strong><br>

                    S%lectionnez une sortie pour g%rer les pr%sences et les %quipes.<br>

                    <strong> Si aucune sortie n'appara%t :</strong> Cliquez sur le bouton " Recharger" % c%$%t% de la liste d%roulante.

                </div>

                

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 1rem;">

                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> S%lectionner une sortie</label>

                        <div style="display: flex; gap: 0.5rem; align-items: center;">

                            <select id="tripSelector" onchange="loadTripRegistry()" style="flex: 1; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            <option value="">-- Choisir une sortie --</option>

                            <!-- Les options seront charg%es dynamiquement depuis le calendrier -->

                        </select>

                            <button onclick="loadTripsFromCalendar()" class="fey-btn" style="background: #2196F3; padding: 0.75rem; white-space: nowrap;">

                                 Recharger

                            </button>

                        </div>

                    </div>

                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Gestion des %quipes</label>

                        <button onclick="toggleTeamEdit()" class="fey-btn" style="background: #9C27B0; width: 100%;">

                             Modifier les %quipes

                        </button>

                    </div>

                </div>



                <!-- Zone d'%dition des %quipes -->

                <div id="teamEditZone" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.1); border-radius: var(--r-sm);">

                    <h4 style="margin-bottom: 1rem;"> %dition des %quipes</h4>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Les Lions</label>

                            <textarea id="team-lions" rows="6" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">Oscar

Jules R

Dante

L%opold

Lev

Alexia</textarea>

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Les Aigles</label>

                            <textarea id="team-aigles" rows="6" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">Alfred

Jules P

Felix

Gabriel

Octave

Constance</textarea>

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">Q% Les Loups</label>

                            <textarea id="team-loups" rows="6" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">Romane

Louison

Madeleine

Claire

L%a Leal

Jeanne</textarea>

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Les Renards</label>

                            <textarea id="team-renards" rows="6" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">Gabrielle Wargnier

L%a F

Sybille

Ambre</textarea>

                        </div>

                    </div>

                    <div style="margin-top: 1rem; display: flex; gap: 1rem;">

                        <button onclick="saveTeamChangesFromEditor()" class="fey-btn" style="background: #4CAF50;"> Sauvegarder</button>

                        <button onclick="cancelTeamEdit()" class="fey-btn" style="background: #f44336;"> Annuler</button>

                    </div>

                </div>



                <!-- Registre de pr%sence -->

                <div id="tripRegistry" style="display: none; margin-top: 1rem;">

                    <h4 style="margin-bottom: 1rem;"> Registre de pr%sence</h4>

                    <div id="registryContent">

                        <!-- Contenu charg% dynamiquement -->

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE 5: CALENDRIER -->

        <div id="calendrier" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                 Calendrier des Activit%s

            </div>



            <!-- Gestion des Sorties -->

            <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50; margin-bottom: 2rem;">

                <div class="fey-card-header"> Gestion des Sorties</div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 1rem;">

                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Ajouter une nouvelle sortie</label>

                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">

                            <input type="text" id="newTripName" placeholder="Nom de la sortie" style="flex: 1; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            <input type="date" id="newTripDate" style="padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            <button onclick="addNewTrip()" class="fey-btn" style="background: #4CAF50;"> Ajouter</button>

                        </div>

                    </div>

                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Auto-inscription covoiturage</label>

                        <div style="display: flex; align-items: center; gap: 0.5rem;">

                            <input type="checkbox" id="autoCarpool" onchange="toggleAutoCarpool()">

                            <label for="autoCarpool">Cocher pour auto-inscription aux sorties de covoiturage</label>

                        </div>

                    </div>

                </div>

            </div>



            <!-- Calendrier embed -->

            <div class="fey-card" style="padding: 0; overflow: hidden;">

                <div class="fey-card-header" style="margin-bottom: 1rem;"> Calendrier des Sorties</div>

                <div id="calendar-container" style="width: 100%; height: 600px; border: 3px solid var(--c-ink-900); border-radius: var(--r-sm);">

                    <!-- Le calendrier sera charg% ici par JavaScript -->

                </div>

            </div>



            <!-- %v%nements % venir -->

            <div class="fey-card">

                <div class="fey-card-header"> Prochains %v%nements</div>

                <div id="upcoming-events">

                    <div class="fey-item" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800;">

                        <strong> Weekend Groupe</strong><br>

                        <span style="color: var(--c-forest-700);"> 18-19 Janvier 2025</span><br>

                        <span style="font-size: 0.9rem; color: var(--c-ink-900);">D%part: 8h00 - Retour: 17h00</span>

                        <div style="margin-top: 0.5rem;">

                            <input type="checkbox" id="carpool-weekend-groupe" onchange="toggleCarpoolRegistration('weekend-groupe', this.checked)">

                            <label for="carpool-weekend-groupe" style="font-size: 0.9rem;"> S'inscrire au covoiturage</label>

                        </div>

                    </div>

                    <div class="fey-item" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50;">

                        <strong> Sortie Voile</strong><br>

                        <span style="color: var(--c-forest-700);"> 25 Janvier 2025</span><br>

                        <span style="font-size: 0.9rem; color: var(--c-ink-900);">D%part: 9h00 - Retour: 16h00</span>

                        <div style="margin-top: 0.5rem;">

                            <input type="checkbox" id="carpool-sortie-voile" onchange="toggleCarpoolRegistration('sortie-voile', this.checked)">

                            <label for="carpool-sortie-voile" style="font-size: 0.9rem;"> S'inscrire au covoiturage</label>

                        </div>

                    </div>

                    <div class="fey-item" style="background: linear-gradient(135deg, #F3E5F5, #E1BEE7); border-left: 4px solid #9C27B0;">

                        <strong>% Sortie Neige</strong><br>

                        <span style="color: var(--c-forest-700);"> 1-2 F%vrier 2025</span><br>

                        <span style="font-size: 0.9rem; color: var(--c-ink-900);">Weekend ski et luge</span>

                        <div style="margin-top: 0.5rem;">

                            <input type="checkbox" id="carpool-sortie-neige" onchange="toggleCarpoolRegistration('sortie-neige', this.checked)">

                            <label for="carpool-sortie-neige" style="font-size: 0.9rem;"> S'inscrire au covoiturage</label>

                        </div>

                    </div>

                    <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                        <strong>% Jambville</strong><br>

                        <span style="color: var(--c-forest-700);"> 15-16 F%vrier 2025</span><br>

                        <span style="font-size: 0.9rem; color: var(--c-ink-900);">Grande sortie de groupe</span>

                        <div style="margin-top: 0.5rem;">

                            <input type="checkbox" id="carpool-jambville" onchange="toggleCarpoolRegistration('jambville', this.checked)">

                            <label for="carpool-jambville" style="font-size: 0.9rem;"> S'inscrire au covoiturage</label>

                        </div>

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE 6: COVOITURAGE -->

        <div id="covoiturage" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                 Covoiturage Scout

            </div>





            <!-- Sous-onglets par sortie -->

            <div class="fey-card">

                <div class="fey-card-header"> Choisir la Sortie</div>

                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">

                    <button class="fey-btn carpool-tab active" onclick="showCarpoolTab('weekend-groupe')" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;">

                         Weekend Groupe

                    </button>

                    <button class="fey-btn carpool-tab" onclick="showCarpoolTab('sortie-voile')" style="background: #2196F3; font-size: 0.9rem; padding: 0.5rem 1rem;">

                         Sortie Voile

                    </button>

                    <button class="fey-btn carpool-tab" onclick="showCarpoolTab('jambville')" style="background: #FF9800; font-size: 0.9rem; padding: 0.5rem 1rem;">

                        % Jambville

                    </button>

                    <button class="fey-btn carpool-tab" onclick="showCarpoolTab('autres')" style="background: #9C27B0; font-size: 0.9rem; padding: 0.5rem 1rem;">

                         Autres Sorties

                    </button>

                </div>

            </div>



            <!-- Weekend Groupe -->

            <div id="weekend-groupe" class="carpool-section">

                <div class="fey-card">

                    <div class="fey-card-header"> Weekend Groupe - Covoiturage</div>

                    <div class="fey-note" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                        <strong> Date :</strong> 15-16 Octobre 2025<br>

                        <strong> Lieu :</strong> Jambville<br>

                        <strong>% D%part :</strong> Samedi 8h00 - <strong>Retour :</strong> Dimanche 17h00

                    </div>



                    <!-- Dashboard Parents -->

                    <div class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800; margin-bottom: 1rem;">

                        <div class="fey-card-header"> Dashboard Parents</div>



                        <!-- Onglets Aller/Retour -->

                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">

                            <button class="fey-btn dashboard-tab active" onclick="showDashboardTab('weekend', 'aller')" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;">

                                 Aller

                            </button>

                            <button class="fey-btn dashboard-tab" onclick="showDashboardTab('weekend', 'retour')" style="background: #2196F3; font-size: 0.9rem; padding: 0.5rem 1rem;">

                                 Retour

                            </button>

                        </div>



                        <!-- Enfants sans place % l'aller -->

                        <div id="children-without-car-weekend-aller" class="dashboard-section">

                            <div style="text-align: center; color: var(--c-forest-700); margin: 1rem 0;">

                                <strong> Enfants sans place % l'ALLER</strong>

                            </div>

                            <div id="children-list-weekend-aller" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">

                                <!-- Charg% dynamiquement -->

                            </div>

                        </div>



                        <!-- Enfants sans place au retour -->

                        <div id="children-without-car-weekend-retour" class="dashboard-section" style="display: none;">

                            <div style="text-align: center; color: var(--c-forest-700); margin: 1rem 0;">

                                <strong> Enfants sans place au RETOUR</strong>

                            </div>

                            <div id="children-list-weekend-retour" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">

                                <!-- Charg% dynamiquement -->

                            </div>

                        </div>

                    </div>



                    <!-- Cr%er une voiture -->

                    <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50; margin-bottom: 1rem;">

                        <div class="fey-card-header"> Cr%er une voiture disponible</div>

                        <form id="carForm-weekend" style="display: flex; flex-direction: column; gap: 1rem;">

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom du Parent</label>

                                    <input type="text" name="parentName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                </div>

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% T%l%phone</label>

                                    <input type="tel" name="parentPhone" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                </div>

                            </div>



                            <!-- Les informations de lieu et heure sont d%j% affich%es en haut -->



                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Places Enfants Disponibles</label>

                                    <select name="childSeats" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                        <option value="">Choisir...</option>

                                        <option value="0">0 place enfant</option>

                                        <option value="1">1 place enfant</option>

                                        <option value="2">2 places enfants</option>

                                        <option value="3">3 places enfants</option>

                                        <option value="4">4+ places enfants</option>

                                    </select>

                                </div>

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Places Adultes Disponibles</label>

                                    <select name="adultSeats" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                        <option value="">Choisir...</option>

                                        <option value="0">0 place adulte</option>

                                        <option value="1">1 place adulte</option>

                                        <option value="2">2 places adultes</option>

                                        <option value="3">3 places adultes</option>

                                        <option value="4">4+ places adultes</option>

                                    </select>

                                </div>

                            </div>



                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Aller-Retour</label>

                                    <select name="roundTrip" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                        <option value="">Choisir...</option>

                                        <option value="aller-seulement">Aller seulement</option>

                                        <option value="retour-seulement">Retour seulement</option>

                                        <option value="aller-retour">Aller et Retour</option>

                                    </select>

                                </div>

                            </div>



                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Commentaires</label>

                                <textarea name="comments" placeholder="Informations compl%mentaires, contraintes, etc..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 80px; resize: vertical;"></textarea>

                            </div>



                            <button type="submit" class="fey-btn" style="width: 100%; font-size: 1.2rem; margin-top: 1rem;">

                                 Cr%er ma Voiture

                            </button>

                        </form>

                    </div>



                    <!-- %tape 2: S%lectionner les enfants -->

                    <div class="fey-card" id="children-selection-weekend" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3; display: none;">

                        <div class="fey-card-header"> %tape 2: S%lectionner les enfants</div>

                        <div id="selected-car-info-weekend" style="margin-bottom: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                            <!-- Informations de la voiture s%lectionn%e -->

                        </div>



                        <div id="children-selection-form-weekend">

                            <div style="margin-bottom: 1rem;">

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> S%lectionner les enfants % prendre en covoiturage</label>

                                <div id="children-checkboxes-weekend" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">

                                    <!-- Charg% dynamiquement -->

                                </div>

                            </div>



                            <button type="button" class="fey-btn" onclick="confirmChildrenSelection('weekend')" style="width: 100%; font-size: 1.2rem;">

                                 Confirmer la S%lection

                            </button>

                        </div>

                    </div>

                </div>



                <!-- Covoiturages Aller -->

                <div class="fey-card">

                    <div class="fey-card-header"> Covoiturages ALLER Disponibles</div>

                    <div id="carpoolList-weekend-aller">

                        <!-- Charg% dynamiquement -->

                    </div>

                </div>



                <!-- Covoiturages Retour -->

                <div class="fey-card">

                    <div class="fey-card-header"> Covoiturages RETOUR Disponibles</div>

                    <div id="carpoolList-weekend-retour">

                        <!-- Charg% dynamiquement -->

                    </div>

                </div>

            </div>



            <!-- Sortie Voile -->

            <div id="sortie-voile" class="carpool-section" style="display: none;">

                <div class="fey-card">

                    <div class="fey-card-header"> Sortie Voile - Covoiturage</div>

                    <div class="fey-note" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                        <strong> Date :</strong> 25 Octobre 2025<br>

                        <strong> Lieu :</strong> Base Nautique de Conflans<br>

                        <strong>% D%part :</strong> 8h30 - <strong>Retour :</strong> 16h30

                    </div>



                    <form id="carpoolForm-voile" class="carpool-form" style="display: flex; flex-direction: column; gap: 1rem;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom du Parent</label>

                                <input type="text" name="parentName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% T%l%phone</label>

                                <input type="tel" name="parentPhone" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> S%lectionner l'Enfant</label>

                                <select name="childName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir un enfant...</option>

                                    <option value="DESCAMPS JEANNE">DESCAMPS Jeanne</option>

                                    <option value="LAURENT BILLET CLAIRE">LAURENT BILLET Claire</option>

                                    <option value="PICHEREAU JULES">PICHEREAU Jules</option>

                                    <option value="POTTER FELIX">POTTER Felix</option>

                                    <option value="ROUSSEAU LEOPOLD">ROUSSEAU Leopold</option>

                                    <option value="JEANJEAN MADELEINE">JEANJEAN Madeleine</option>

                                    <option value="LALIGAND LEA">LALIGAND Lea</option>

                                    <option value="MILLART CONSTANCE">MILLART Constance</option>

                                    <option value="REYNAL DE SAINT MICHEL ALEXIA">REYNAL DE SAINT MICHEL Alexia</option>

                                    <option value="D'ANDREA DANTE">D'ANDREA Dante</option>

                                    <option value="JANDARD LEV">JANDARD Lev</option>

                                    <option value="ROIG OCTAVE">ROIG Octave</option>

                                    <option value="RUEF ALFRED">RUEF Alfred</option>

                                    <option value="MATHIEN AMBRE">MATHIEN Ambre</option>

                                    <option value="FAUGERE LEA">FAUGERE Lea</option>

                                    <option value="GENTIL CONSTANCE">GENTIL Constance</option>

                                    <option value="HUCHEZ SIBYLLE">HUCHEZ Sibylle</option>

                                    <option value="LANASPRE ROMANE">LANASPRE Romane</option>

                                    <option value="NIERAT ZOE">NIERAT Zoe</option>

                                    <option value="SERVONNAT LOUISON">SERVONNAT Louison</option>

                                    <option value="WARGNIER GABRIELLE">WARGNIER Gabrielle</option>

                                    <option value="POTTER OSCAR">POTTER Oscar</option>

                                    <option value="ROIG JULES">ROIG Jules</option>

                                    <option value="TALPAERT GABRIEL">TALPAERT Gabriel</option>

                                </select>

                            </div>

                            <!-- Les informations de lieu sont d%j% affich%es en haut -->

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Places Enfants Disponibles</label>

                                <select name="childSeats" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="0">0 place enfant</option>

                                    <option value="1">1 place enfant</option>

                                    <option value="2">2 places enfants</option>

                                    <option value="3">3 places enfants</option>

                                    <option value="4">4+ places enfants</option>

                                </select>

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Places Adultes Disponibles</label>

                                <select name="adultSeats" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="0">0 place adulte</option>

                                    <option value="1">1 place adulte</option>

                                    <option value="2">2 places adultes</option>

                                    <option value="3">3 places adultes</option>

                                    <option value="4">4+ places adultes</option>

                                </select>

                            </div>

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Aller-Retour</label>

                                <select name="roundTrip" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="aller-seulement">Aller seulement</option>

                                    <option value="retour-seulement">Retour seulement</option>

                                    <option value="aller-retour">Aller et Retour</option>

                                </select>

                            </div>

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Commentaires</label>

                            <textarea name="comments" placeholder="Informations compl%mentaires, contraintes, etc..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 80px; resize: vertical;"></textarea>

                        </div>



                        <button type="submit" class="fey-btn" style="width: 100%; font-size: 1.2rem; margin-top: 1rem;">

                             S'inscrire au Covoiturage Voile

                        </button>

                    </form>

                </div>



                <!-- Liste des covoiturages Voile -->

                <div class="fey-card">

                    <div class="fey-card-header"> Covoiturages Voile Disponibles</div>

                    <div id="carpoolList-voile">

                        <!-- Charg% dynamiquement -->

                    </div>

                </div>

            </div>



            <!-- Jambville -->

            <div id="jambville" class="carpool-section" style="display: none;">

                <div class="fey-card">

                    <div class="fey-card-header">% Jambville - Covoiturage</div>

                    <div class="fey-note" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800;">

                        <strong> Date :</strong> 15-16 Novembre 2025<br>

                        <strong> Lieu :</strong> Ch%teau de Jambville<br>

                        <strong>% D%part :</strong> Samedi 8h00 - <strong>Retour :</strong> Dimanche 17h00

                    </div>



                    <form id="carpoolForm-jambville" class="carpool-form" style="display: flex; flex-direction: column; gap: 1rem;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom du Parent</label>

                                <input type="text" name="parentName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% T%l%phone</label>

                                <input type="tel" name="parentPhone" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> S%lectionner l'Enfant</label>

                                <select name="childName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir un enfant...</option>

                                    <option value="DESCAMPS JEANNE">DESCAMPS Jeanne</option>

                                    <option value="LAURENT BILLET CLAIRE">LAURENT BILLET Claire</option>

                                    <option value="PICHEREAU JULES">PICHEREAU Jules</option>

                                    <option value="POTTER FELIX">POTTER Felix</option>

                                    <option value="ROUSSEAU LEOPOLD">ROUSSEAU Leopold</option>

                                    <option value="JEANJEAN MADELEINE">JEANJEAN Madeleine</option>

                                    <option value="LALIGAND LEA">LALIGAND Lea</option>

                                    <option value="MILLART CONSTANCE">MILLART Constance</option>

                                    <option value="REYNAL DE SAINT MICHEL ALEXIA">REYNAL DE SAINT MICHEL Alexia</option>

                                    <option value="D'ANDREA DANTE">D'ANDREA Dante</option>

                                    <option value="JANDARD LEV">JANDARD Lev</option>

                                    <option value="ROIG OCTAVE">ROIG Octave</option>

                                    <option value="RUEF ALFRED">RUEF Alfred</option>

                                    <option value="MATHIEN AMBRE">MATHIEN Ambre</option>

                                    <option value="FAUGERE LEA">FAUGERE Lea</option>

                                    <option value="GENTIL CONSTANCE">GENTIL Constance</option>

                                    <option value="HUCHEZ SIBYLLE">HUCHEZ Sibylle</option>

                                    <option value="LANASPRE ROMANE">LANASPRE Romane</option>

                                    <option value="NIERAT ZOE">NIERAT Zoe</option>

                                    <option value="SERVONNAT LOUISON">SERVONNAT Louison</option>

                                    <option value="WARGNIER GABRIELLE">WARGNIER Gabrielle</option>

                                    <option value="POTTER OSCAR">POTTER Oscar</option>

                                    <option value="ROIG JULES">ROIG Jules</option>

                                    <option value="TALPAERT GABRIEL">TALPAERT Gabriel</option>

                                </select>

                            </div>

                            <!-- Les informations de lieu sont d%j% affich%es en haut -->

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Places Enfants Disponibles</label>

                                <select name="childSeats" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="0">0 place enfant</option>

                                    <option value="1">1 place enfant</option>

                                    <option value="2">2 places enfants</option>

                                    <option value="3">3 places enfants</option>

                                    <option value="4">4+ places enfants</option>

                                </select>

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Places Adultes Disponibles</label>

                                <select name="adultSeats" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="0">0 place adulte</option>

                                    <option value="1">1 place adulte</option>

                                    <option value="2">2 places adultes</option>

                                    <option value="3">3 places adultes</option>

                                    <option value="4">4+ places adultes</option>

                                </select>

                            </div>

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Aller-Retour</label>

                                <select name="roundTrip" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="aller-seulement">Aller seulement</option>

                                    <option value="retour-seulement">Retour seulement</option>

                                    <option value="aller-retour">Aller et Retour</option>

                                </select>

                            </div>

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Commentaires</label>

                            <textarea name="comments" placeholder="Informations compl%mentaires, contraintes, etc..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 80px; resize: vertical;"></textarea>

                        </div>



                        <button type="submit" class="fey-btn" style="width: 100%; font-size: 1.2rem; margin-top: 1rem;">

                            % S'inscrire au Covoiturage Jambville

                        </button>

                    </form>

                </div>



                <!-- Liste des covoiturages Jambville -->

                <div class="fey-card">

                    <div class="fey-card-header">% Covoiturages Jambville Disponibles</div>

                    <div id="carpoolList-jambville">

                        <!-- Charg% dynamiquement -->

                    </div>

                </div>

            </div>



            <!-- Autres Sorties -->

            <div id="autres" class="carpool-section" style="display: none;">

                <div class="fey-card">

                    <div class="fey-card-header"> Autres Sorties - Covoiturage</div>

                    <div class="fey-note" style="background: linear-gradient(135deg, #F3E5F5, #E1BEE7); border-left: 4px solid #9C27B0;">

                        <strong> Dates :</strong> Variables selon les activit%s<br>

                        <strong> Lieux :</strong> Divers (% pr%ciser selon l'activit%)<br>

                        <strong>% Horaires :</strong> % d%finir selon l'%v%nement

                    </div>



                    <form id="carpoolForm-autres" class="carpool-form" style="display: flex; flex-direction: column; gap: 1rem;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom du Parent</label>

                                <input type="text" name="parentName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% T%l%phone</label>

                                <input type="tel" name="parentPhone" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> S%lectionner l'Enfant</label>

                                <select name="childName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir un enfant...</option>

                                    <option value="DESCAMPS JEANNE">DESCAMPS Jeanne</option>

                                    <option value="LAURENT BILLET CLAIRE">LAURENT BILLET Claire</option>

                                    <option value="PICHEREAU JULES">PICHEREAU Jules</option>

                                    <option value="POTTER FELIX">POTTER Felix</option>

                                    <option value="ROUSSEAU LEOPOLD">ROUSSEAU Leopold</option>

                                    <option value="JEANJEAN MADELEINE">JEANJEAN Madeleine</option>

                                    <option value="LALIGAND LEA">LALIGAND Lea</option>

                                    <option value="MILLART CONSTANCE">MILLART Constance</option>

                                    <option value="REYNAL DE SAINT MICHEL ALEXIA">REYNAL DE SAINT MICHEL Alexia</option>

                                    <option value="D'ANDREA DANTE">D'ANDREA Dante</option>

                                    <option value="JANDARD LEV">JANDARD Lev</option>

                                    <option value="ROIG OCTAVE">ROIG Octave</option>

                                    <option value="RUEF ALFRED">RUEF Alfred</option>

                                    <option value="MATHIEN AMBRE">MATHIEN Ambre</option>

                                    <option value="FAUGERE LEA">FAUGERE Lea</option>

                                    <option value="GENTIL CONSTANCE">GENTIL Constance</option>

                                    <option value="HUCHEZ SIBYLLE">HUCHEZ Sibylle</option>

                                    <option value="LANASPRE ROMANE">LANASPRE Romane</option>

                                    <option value="NIERAT ZOE">NIERAT Zoe</option>

                                    <option value="SERVONNAT LOUISON">SERVONNAT Louison</option>

                                    <option value="WARGNIER GABRIELLE">WARGNIER Gabrielle</option>

                                    <option value="POTTER OSCAR">POTTER Oscar</option>

                                    <option value="ROIG JULES">ROIG Jules</option>

                                    <option value="TALPAERT GABRIEL">TALPAERT Gabriel</option>

                                </select>

                            </div>

                            <!-- Les informations de lieu sont d%j% affich%es en haut -->

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Places Enfants Disponibles</label>

                                <select name="childSeats" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="0">0 place enfant</option>

                                    <option value="1">1 place enfant</option>

                                    <option value="2">2 places enfants</option>

                                    <option value="3">3 places enfants</option>

                                    <option value="4">4+ places enfants</option>

                                </select>

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Places Adultes Disponibles</label>

                                <select name="adultSeats" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="0">0 place adulte</option>

                                    <option value="1">1 place adulte</option>

                                    <option value="2">2 places adultes</option>

                                    <option value="3">3 places adultes</option>

                                    <option value="4">4+ places adultes</option>

                                </select>

                            </div>

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Aller-Retour</label>

                                <select name="roundTrip" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                    <option value="">Choisir...</option>

                                    <option value="aller-seulement">Aller seulement</option>

                                    <option value="retour-seulement">Retour seulement</option>

                                    <option value="aller-retour">Aller et Retour</option>

                                </select>

                            </div>

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Commentaires</label>

                            <textarea name="comments" placeholder="Informations compl%mentaires, contraintes, etc..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 80px; resize: vertical;"></textarea>

                        </div>



                        <button type="submit" class="fey-btn" style="width: 100%; font-size: 1.2rem; margin-top: 1rem;">

                             S'inscrire au Covoiturage

                        </button>

                    </form>

                </div>



                <!-- Liste des covoiturages Autres -->

                <div class="fey-card">

                    <div class="fey-card-header"> Covoiturages Autres Sorties</div>

                    <div id="carpoolList-autres">

                        <!-- Charg% dynamiquement -->

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE 7: CHANSONS -->

        <div id="chansons" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                 Chansons & Pri%res

            </div>



            <div class="fey-card">

                <div class="fey-card-header"> Pri%res du matin</div>

                <div class="fey-note">

                    <strong> Pri%re scoute du matin :</strong><br>

                    "Seigneur, aide-moi % %tre un bon scout aujourd'hui. Donne-moi la force d'aider les autres et de respecter la nature. Amen."

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header"> Pri%re Scoute Officielle</div>

                <div class="fey-note" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                    <strong> %coute la pri%re scoute :</strong><br>

                    <div style="margin: 1rem 0;">

                        <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/track/4I7UDLZJvbYkQQCRXVw9WL?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

                    </div>

                </div>



                <div class="fey-note" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800; margin-top: 1rem;">

                    <strong> Paroles de la Pri%re Scoute :</strong><br>

                    <div style="font-family: 'Patrick Hand', cursive; font-size: 1.1rem; line-height: 1.6; color: var(--c-forest-700); margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm);">

                        <strong>Seigneur J%sus,</strong><br>

                        Apprenez-nous % %tre g%n%reux,<br>

                        A Vous servir comme Vous le m%ritez<br>

                        A donner sans compter,<br>

                        A combattre sans souci des blessures,<br>

                        A travailler sans chercher le repos,<br>

                        A nous d%penser, sans attendre d'autre r%compense,<br>

                        que celle de savoir que nous faisons Votre Sainte Volont%.

                    </div>

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header"> Chansons Scoutes % Conna%tre</div>

                <div class="fey-note" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50;">

                    <strong> Playlist des chansons scoutes essentielles :</strong><br>

                    <div style="margin: 1rem 0;">

                        <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/0udNpspSVRNHFyFd3OhyqA?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

                    </div>

                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm);">

                        <strong> Chansons incluses :</strong><br>

                         <strong>Moins Sollanel</strong> - Chanson traditionnelle scout<br>

                         Chansons de veill%e et de marche<br>

                         Chansons de camaraderie<br>

                         Chansons de la nature et de l'aventure<br>

                        <em style="color: var(--c-forest-700); font-size: 0.9rem;">Ces chansons sont souvent chant%es lors des activit%s scoutes !</em>

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE 6: MARIN -->

        <div id="marin" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                 Marin

            </div>



            <div class="fey-card">

                <div class="fey-card-header"> % venir</div>

                <div class="fey-note" style="text-align: center; padding: 2rem;">

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; font-size: 1.5rem;">

                         Section en construction

                    </h3>

                    <p>Cette section sera bient%$%t disponible avec du contenu marin sp%cialement con%u pour les scouts !</p>

                </div>

            </div>

        </div>



        <!-- PAGE 7: LOI SCOUT -->

        <div id="loi" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                 Loi Scout - Loi des Sylphes

            </div>



            <div class="fey-card">

                <div class="fey-card-header"> La Loi des Sylphes</div>

                <div class="fey-note">

                    <strong>% Les Sylphes nous enseignent % vivre en harmonie avec la nature et les autres.</strong><br>

                    Voici comment ils nous guideraient dans nos comportements quotidiens :

                </div>

            </div>



            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin: 2rem 0;">

                <div style="background: linear-gradient(135deg, #8e44ad, #9b59b6); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #8e44ad; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;">%</div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">VRAI - Yz%$%</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Moral</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je donne mon avis et je fais ce que je dis."</p>

                </div>



                <div style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #27ae60; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;"></div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">RESPECTUEUX - Kawane</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Affectif</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je prends soin de moi et des autres."</p>

                </div>



                <div style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #f39c12; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;"></div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">D%BROUILLARD - Th%la</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Intellectuel</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je d%couvre le monde et je cr%e de mes mains. Je prot%ge notre plan%te."</p>

                </div>



                <div style="background: linear-gradient(135deg, #8e44ad, #9b59b6); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #8e44ad; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;"></div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">DYNAMIQUE - Laline</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Physique</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je suis actif et bon joueur."</p>

                </div>



                <div style="background: linear-gradient(135deg, #95a5a6, #bdc3c7); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #95a5a6; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;"></div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">CURIEUX DE DIEU - Ma%%ls</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Spirituel</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"J'apprends % dire qui est J%sus pour moi."</p>

                </div>



                <div style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #e74c3c; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;">Q%</div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">SOLIDAIRE - Blogane</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Social</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je suis copain avec tous, ici et ailleurs."</p>

                </div>

            </div>



            <div class="fey-note" style="margin-top: 2rem;">

                <strong> Message des Sylphes :</strong><br>

                "Petits scouts, souvenez-vous : chaque jour est une nouvelle aventure. Soyez bons, soyez courageux, et la magie de la nature vous accompagnera dans tous vos d%fis !"

            </div>



            <!-- Jeu de la Promesse -->

            <div class="fey-card" style="margin-top: 2rem;">

                <div class="fey-card-header"> La Qu%te des Sylphes</div>

                <div class="fey-note">

                    <strong> Apprends la loi et la pri%re scoute en jouant !</strong><br>

                    Choisis un mode de jeu et rel%ve les d%fis pour devenir un vrai scout.

                </div>



                <!-- Section d'accueil du jeu -->

                <div id="jeu-accueil" style="text-align: center; margin: 2rem 0;">

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; font-size: 1.5rem;">

                         Choisis ton Mode de Jeu 

                    </h3>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 2rem 0;">

                        <div class="sylphe-card" onclick="selectMode('association')" style="background: linear-gradient(135deg, #8e44ad, #9b59b6); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900); cursor: pointer; transition: transform 0.3s;">

                            <div style="font-size: 3rem; margin-bottom: 0.5rem;"></div>

                            <h4 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem;">Mode Association</h4>

                            <p style="font-size: 0.9rem;">Relie les situations aux sylphes</p>

                        </div>

                        <div class="sylphe-card" onclick="selectMode('scenarios')" style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900); cursor: pointer; transition: transform 0.3s;">

                            <div style="font-size: 3rem; margin-bottom: 0.5rem;"></div>

                            <h4 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem;">Mode Sc%narios</h4>

                            <p style="font-size: 0.9rem;">Vis des aventures scoutes</p>

                        </div>

                    </div>

                </div>



                <!-- Mode Association -->

                <div id="section-association" style="display: none;">

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; font-size: 1.5rem;">

                         Mode Association

                    </h3>



                    <div class="fey-note">

                        <strong> Comment jouer ?</strong><br>

                        1. Lis chaque situation<br>

                        2. Glisse-la vers le Sylphe qui correspond le mieux<br>

                        3. Clique sur "V%rifier" pour voir tes r%sultats !

                    </div>



                    <div style="text-align: center; margin: 1rem 0; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <strong>Associations: <span id="association-count">0</span>/6</strong>

                    </div>



                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">

                        <div style="background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem;">

                            <h4 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; text-align: center;"> Situations</h4>

                            <div id="situations-list">

                                <!-- Situations ajout%es par JavaScript -->

                            </div>

                        </div>



                        <div style="background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem;">

                            <h4 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; text-align: center;"> Sylphes</h4>

                            <div id="sylphes-zones">

                                <!-- Zones de d%p%$%t ajout%es par JavaScript -->

                            </div>

                        </div>

                    </div>



                    <div id="feedback-association" style="display: none; background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem; margin: 1.5rem 0;"></div>



                    <div style="text-align: center; margin: 2rem 0;">

                        <button class="fey-btn" onclick="verifierAssociations()"> V%rifier les Associations</button>

                        <button class="fey-btn" onclick="recommencerAssociation()" style="background: var(--c-forest-700);"> Recommencer</button>

                        <button class="fey-btn" onclick="retourMenu()" style="background: var(--c-forest-700);"> Menu Principal</button>

                    </div>

                </div>



                <!-- Mode Sc%narios -->

                <div id="section-scenarios" style="display: none;">

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; font-size: 1.5rem;">

                         Mode Sc%narios

                    </h3>

                    <p style="text-align: center; color: var(--c-forest-700); font-style: italic; margin-bottom: 2rem;">

                        Vis des aventures scoutes et prends les bonnes d%cisions !

                    </p>



                    <div style="text-align: center; margin: 1rem 0; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <strong>Score: <span id="scenarios-score">0</span> points  | Sc%nario <span id="scenario-number">1</span>/<span id="total-scenarios">5</span></strong>

                    </div>



                    <div id="scenario-container">

                        <!-- Le sc%nario sera affich% ici -->

                    </div>



                    <div id="scenario-feedback" style="display: none; background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem; margin: 1.5rem 0;"></div>



                    <!-- %cran final des sc%narios -->

                    <div id="scenarios-final" style="display: none;">

                        <div style="background: linear-gradient(135deg, #c8e6c9, #a5d6a7); border: 3px solid #2e7d32; border-radius: var(--r-lg); padding: 2rem; margin: 2rem 0; text-align: center;">

                            <h3 style="font-family: 'Patrick Hand', cursive; font-size: 2rem; color: #2e7d32; margin-bottom: 1rem;">

                                 Aventure Termin%e ! 

                            </h3>

                            <p style="font-size: 1.2rem; margin-bottom: 1rem;">

                                Score final : <span id="final-scenarios-score" style="font-weight: bold; color: var(--c-orange-600);">0</span> points

                            </p>

                            <p style="font-size: 1.1rem;">

                                Bonnes r%ponses : <span id="final-correct-answers">0</span>/<span id="final-total-questions">0</span>

                            </p>

                        </div>



                        <div style="background: white; padding: 2rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); margin: 2rem 0;">

                            <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; text-align: center;">

                                 Message des Sylphes

                            </h3>

                            <p id="final-sylphes-message" style="font-size: 1.1rem; line-height: 1.6; text-align: center;">

                            </p>

                        </div>



                        <div style="text-align: center; margin: 2rem 0;">

                            <button class="fey-btn" onclick="recommencerScenarios()"> Rejouer</button>

                            <button class="fey-btn" onclick="retourMenu()" style="background: var(--c-forest-700);"> Menu Principal</button>

                        </div>

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE ADMIN -->

        <div id="admin" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                 Mode Administrateur

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #FFE0E6, #FFB3BA); border-left: 6px solid #E91E63;">

                <div class="fey-card-header"> Acc%s Administrateur</div>

                <div class="fey-note" style="background: transparent; border: none; margin: 0;">

                    <strong> Zone r%serv%e aux responsables</strong><br>

                    <strong> Gestion :</strong> Modifiez les informations des %quipes, contacts et %v%nements.<br>

                    <strong> S%curit% :</strong> Toutes les modifications sont trac%es.

                </div>

            </div>



            <!-- Notes Administrateur -->

            <div class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 6px solid #FF9800;">

                <div class="fey-card-header"> Notes Administrateur</div>

                <div class="fey-note" style="background: transparent; border: none; margin: 0 0 1rem 0;">

                    <strong> Ajoutez des notes :</strong> Partagez des informations importantes avec les parents et scouts.<br>

                    <strong> Astuce :</strong> Ces notes appara%tront en haut de la page principale.

                </div>

                

                <div style="margin-bottom: 1rem;">

                    <textarea id="adminNotes" placeholder="Tapez vos notes ici..." 

                              style="width: 100%; min-height: 100px; padding: 1rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); font-family: 'Nunito', sans-serif; font-size: 1rem; resize: vertical;"></textarea>

                </div>

                

                <div style="display: flex; gap: 1rem;">

                    <button class="fey-btn" onclick="saveAdminNotes()" style="background: #4CAF50;">

                         Sauvegarder les Notes

                    </button>

                    <button class="fey-btn" onclick="clearAdminNotes()" style="background: #f44336;">

                         Effacer les Notes

                    </button>

                    <button class="fey-btn" onclick="previewAdminNotes()" style="background: #2196F3;">

                         Aper%u

                    </button>

                </div>

                

                <div id="adminNotesPreview" style="margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.8); border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); display: none;">

                    <h4 style="color: var(--c-orange-600); margin-bottom: 0.5rem;"> Aper%u des Notes :</h4>

                    <div id="previewContent"></div>

                </div>

            </div>



            <!-- Gestion de la Liste de Checklist -->

            <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 6px solid #4CAF50;">

                <div class="fey-card-header"> Gestion de la Liste de Checklist</div>

                <div class="fey-note" style="background: transparent; border: none; margin: 0 0 1rem 0;">

                    <strong> Gestion des %l%ments :</strong> Ajoutez, modifiez ou supprimez des %l%ments de la liste.<br>

                    <strong> Options :</strong> Marquez des %l%ments comme facultatifs ou obligatoires.

                </div>

                

                <div style="margin-bottom: 1rem;">

                    <button class="fey-btn" onclick="showAddItemModal()" style="background: #4CAF50; margin-right: 1rem;">

                         Ajouter un %l%ment

                    </button>

                    <button class="fey-btn" onclick="showEditItemsModal()" style="background: #2196F3; margin-right: 1rem;">

                         Modifier les %l%ments

                    </button>

                    <button class="fey-btn" onclick="resetChecklistItems()" style="background: #FF9800;">

                         R%initialiser la Liste

                    </button>

                </div>

                

                <div id="checklistItemsList" style="max-height: 400px; overflow-y: auto; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1rem; background: white;">

                    <!-- Les %l%ments de la liste seront charg%s ici -->

                </div>

            </div>



            <!-- Personnalisation de l'Apparence -->

            <div class="fey-card">

                <div class="fey-card-header"> Personnalisation de l'Apparence</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong> Th%me :</strong> Personnalisez les couleurs et l'apparence de l'application.

                </div>



                <!-- Couleurs principales -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;"> Couleurs Principales</h3>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Couleur Orange</label>

                            <input type="color" value="#F77F00" id="colorOrange" style="width: 100%; height: 40px; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Couleur For%t</label>

                            <input type="color" value="#2E7D32" id="colorForest" style="width: 100%; height: 40px; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Couleur Or</label>

                            <input type="color" value="#FFD166" id="colorGold" style="width: 100%; height: 40px; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Couleur Marine</label>

                            <input type="color" value="#1B1F3B" id="colorMarine" style="width: 100%; height: 40px; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>

                </div>



                <!-- Personnalisation des textes -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;"> Textes Personnalis%s</h3>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Titre Principal</label>

                            <input type="text" value="Mon carnet d'aventure" id="mainTitle" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Sous-titre</label>

                            <input type="text" value="Prochaine sortie % Jambville ,% Octobre 2025" id="subtitle" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>

                </div>



                <div style="text-align: center; margin-top: 2rem;">

                    <button class="fey-btn" onclick="applyCustomization()" style="background: #4CAF50; font-size: 1rem; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                         Appliquer les Changements

                    </button>

                    <button class="fey-btn" onclick="resetCustomization()" style="background: #FF9800; font-size: 1rem; padding: 0.75rem 1.5rem;">

                         R%initialiser

                    </button>

                </div>

            </div>



            <!-- Gestion des %quipes de Vie et de Nuit -->

            <div class="fey-card">

                <div class="fey-card-header"> Gestion des %quipes</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong> %dition des %quipes :</strong> Modifiez les membres des %quipes de vie et de nuit. Les modifications sont sauvegard%es automatiquement.

                </div>



                <!-- %quipes de Vie -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;"> %quipes de Vie</h3>

                    <div id="life-teams-editor">

                        <!-- Les %quipes seront g%n%r%es dynamiquement -->

                    </div>

                </div>



                <!-- %quipes de Nuit -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-marine-700); margin-bottom: 1rem; font-size: 1.2rem;"> %quipes de Nuit</h3>

                    <div id="night-teams-editor">

                        <!-- Les %quipes seront g%n%r%es dynamiquement -->

                    </div>

                </div>



                <div style="text-align: center; margin-top: 2rem;">

                    <button class="fey-btn" onclick="saveTeams()" style="background: #4CAF50; font-size: 1rem; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                         Sauvegarder toutes les %quipes

                    </button>

                    <button class="fey-btn" onclick="resetTeams()" style="background: #FF9800; font-size: 1rem; padding: 0.75rem 1.5rem;">

                         R%initialiser

                    </button>

                </div>

            </div>



            <!-- Gestion des Contacts -->

            <div class="fey-card">

                <div class="fey-card-header">% Gestion des Contacts</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong> Modification des contacts :</strong> Modifiez les informations de contact qui apparaissent dans la page "Infos". Les modifications sont sauvegard%es automatiquement.

                </div>

                



                <!-- Contacts responsables -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;"> Contacts Responsables</h3>

                    <div id="contacts-management">

                        <!-- Les contacts seront charg%s dynamiquement -->

                    </div>

                </div>



                <!-- Lien vers le drive des parents -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;"> Documents pour les Parents</h3>

                    <div style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); padding: 1.5rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <div style="display: grid; grid-template-columns: 1fr auto; gap: 1rem; align-items: center;">

                            <div>

                                <h4 style="margin: 0 0 0.5rem 0; color: var(--c-marine-700);"> Drive des Documents</h4>

                                <p style="margin: 0; font-size: 0.9rem; color: #666;">Acc%dez aux documents importants, autorisations, listes et informations pour les parents.</p>

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold; font-size: 0.9rem;"> URL du Drive</label>

                                <input type="url" id="driveLink" value="https://drive.google.com/drive/folders/1BiH607P0bDlCc7g8thPl5V-uZQ71qA_a" 

                                       style="width: 300px; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); font-size: 0.9rem;">

                            </div>

                        </div>

                    </div>

                </div>



                <!-- Actions -->

                <div style="text-align: center; margin-top: 2rem;">

                    <button class="fey-btn" onclick="saveContactInfo()" style="background: #4CAF50; font-size: 1rem; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                         Sauvegarder toutes les informations

                    </button>

                    <button class="fey-btn" onclick="addContact()" style="background: #9C27B0; font-size: 1rem; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                         Ajouter un Contact

                    </button>

                    <button class="fey-btn" onclick="resetContactInfo()" style="background: #FF9800; font-size: 1rem; padding: 0.75rem 1.5rem;">

                         R%initialiser

                    </button>

                </div>

            </div>



            <!-- Gestion des Sorties Covoiturage -->

            <div class="fey-card">

                <div class="fey-card-header"> Gestion des Sorties Covoiturage</div>

                <div id="trips-management">

                    <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; align-items: center;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom de la Sortie</label>

                                <input type="text" value="Weekend Groupe" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Date</label>

                                <input type="date" value="2025-10-15" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Point de D%part (FIX%)</label>

                                <input type="text" value="Place de la Mairie" readonly style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); background: #f5f5f5;">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Point d'Arriv%e (FIX%)</label>

                                <input type="text" value="Jambville" readonly style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); background: #f5f5f5;">

                            </div>

                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure D%part</label>

                                <input type="time" value="08:00" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure Retour</label>

                                <input type="time" value="17:00" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">

                            <button class="fey-btn" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;"> Sauvegarder</button>

                            <button class="fey-btn" style="background: #FF9800; font-size: 0.9rem; padding: 0.5rem 1rem;"> Modifier</button>

                            <button class="fey-btn" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;"> Supprimer</button>

                        </div>

                    </div>

                </div>



                <div style="margin-top: 1rem; text-align: center;">

                    <button class="fey-btn" onclick="showCreateTripModal()" style="background: #9C27B0; font-size: 1rem; padding: 0.75rem 1.5rem;">

                         Cr%er une Nouvelle Sortie

                    </button>

                </div>

            </div>



            <!-- Modal Cr%ation Sortie -->

            <div id="createTripModal" class="fey-card" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; background: white; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto;">

                <div class="fey-card-header"> Cr%er une Nouvelle Sortie</div>

                <form id="createTripForm" style="display: flex; flex-direction: column; gap: 1rem;">

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom de la Sortie</label>

                            <input type="text" name="tripName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Date D%but</label>

                            <input type="date" name="startDate" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>



                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Date Fin</label>

                            <input type="date" name="endDate" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Point de D%part</label>

                            <input type="text" name="departurePoint" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>



                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Point d'Arriv%e</label>

                            <input type="text" name="arrivalPoint" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure D%part</label>

                            <input type="time" name="departureTime" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>



                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure Retour</label>

                        <input type="time" name="returnTime" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                    </div>



                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Description</label>

                        <textarea name="description" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 80px; resize: vertical;"></textarea>

                    </div>



                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">

                        <button type="submit" class="fey-btn" style="background: #4CAF50; flex: 1;">

                             Cr%er la Sortie

                        </button>

                        <button type="button" class="fey-btn" onclick="hideCreateTripModal()" style="background: #F44336; flex: 1;">

                             Annuler

                        </button>

                    </div>

                </form>

            </div>



            <!-- Gestion des Sorties -->

            <div class="fey-card">

                <div class="fey-card-header"> Gestion des Sorties</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong> Gestion des sorties :</strong> Toutes les sorties du calendrier ont automatiquement un registre d'appel. Cochez uniquement celles qui n%cessitent du covoiturage.

                </div>



                <!-- Sorties du calendrier avec s%lection covoiturage -->

                <div id="calendar-trips-management" style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;"> Sorties du Calendrier</h3>

                    <div class="fey-note" style="margin-bottom: 1rem; background: #E3F2FD; border-left: 4px solid #2196F3;">

                        <strong> Instructions :</strong> Toutes les sorties apparaissent automatiquement dans le registre d'appel. Cochez uniquement celles qui n%cessitent du covoiturage.

                    </div>

                    <div id="calendar-trips-list">

                        <!-- Les sorties du calendrier seront charg%es ici -->

                    </div>

                    <div style="margin-top: 1rem; text-align: center;">

                        <button onclick="saveTripSelections()" class="fey-btn" style="background: #4CAF50; margin-right: 1rem;">

                             Sauvegarder les s%lections

                        </button>

                        <button onclick="loadCalendarTrips()" class="fey-btn" style="background: #2196F3;">

                             Recharger

                        </button>

                    </div>

                </div>



                <!-- Liste des sorties existantes -->

                <div id="outings-list" style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;"> Sorties Programm%es</h3>

                    <div class="fey-item" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; align-items: center;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom de la Sortie</label>

                                <input type="text" value="Weekend Groupe" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Date</label>

                                <input type="date" value="2025-01-18" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Lieu</label>

                                <input type="text" value="Jambville" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure D%part</label>

                                <input type="time" value="08:00" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure Retour</label>

                                <input type="time" value="17:00" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="margin-top: 1rem;">

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Description</label>

                            <textarea style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 60px; resize: vertical;">Weekend de groupe avec activit%s de plein air, jeux et veill%e.</textarea>

                        </div>

                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">

                            <button class="fey-btn" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;"> Sauvegarder</button>

                            <button class="fey-btn" style="background: #FF9800; font-size: 0.9rem; padding: 0.5rem 1rem;"> Modifier</button>

                            <button class="fey-btn" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;"> Supprimer</button>

                        </div>

                    </div>

                </div>



                <div style="margin-top: 1rem; text-align: center;">

                    <button class="fey-btn" onclick="showCreateOutingModal()" style="background: #9C27B0; font-size: 1rem; padding: 0.75rem 1.5rem;">

                         Ajouter une Sortie

                    </button>

                </div>

            </div>



            <!-- Statistiques Admin -->

            <div class="fey-card">

                <div class="fey-card-header"> Statistiques</div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">

                    <div style="background: linear-gradient(135deg, #4CAF50, #66BB6A); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;">12</div>

                        <div> %quipes</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #2196F3, #42A5F5); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;">45</div>

                        <div>% Contacts</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #FF9800, #FFB74D); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;">8</div>

                        <div> %v%nements</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #9C27B0, #BA68C8); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;">23</div>

                        <div> Covoiturages</div>

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE REGISTRE D'APPEL -->

        <div id="registre" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                 Registre d'Appel des Sorties

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 6px solid #FF5722;">

                <div class="fey-card-header"> Gestion du Registre d'Appel</div>

                <div class="fey-note" style="background: transparent; border: none; margin: 0;">

                    <strong> Fonctionnalit%s :</strong> G%rez les pr%sences pour chaque sortie, consultez les statistiques et exportez les donn%es.<br>

                    <strong> S%curit% :</strong> Toutes les modifications sont trac%es et sauvegard%es.

                </div>

            </div>



            <!-- S%lection de Sortie -->

            <div class="fey-card">

                <div class="fey-card-header"> S%lection de la Sortie</div>

                <div style="margin-bottom: 1rem;">

                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Choisir une sortie :</label>

                    <div id="outingsList" style="max-height: 300px; overflow-y: auto; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1rem;">

                        <div style="text-align: center; color: #666; padding: 2rem;">

                             Cliquez sur "Recharger" pour charger les sorties

                </div>

                    </div>

                    <button onclick="loadTripsFromCalendar()" class="fey-btn" style="background: #2196F3; padding: 0.75rem; margin-top: 0.5rem; width: 100%;">

                         Recharger les Sorties

                    </button>

                </div>

                <div style="text-align: center; margin-top: 1rem;">

                    <button class="fey-btn" onclick="exportAttendanceData()" style="background: #2196F3; font-size: 1rem; padding: 0.75rem 1.5rem;">

                         Exporter les Donn%es

                    </button>

                </div>

            </div>



            <!-- Informations de la Sortie S%lectionn%e -->

            <div id="outingInfo" class="fey-card" style="display: none;">

                <div class="fey-card-header"> Informations de la Sortie</div>

                <div id="outingDetails" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">

                    <!-- Les d%tails seront charg%s dynamiquement -->

                </div>

            </div>



            <!-- Liste des Participants -->

            <div id="participantsList" class="fey-card" style="display: none;">

                <div class="fey-card-header"> Liste des Participants</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong> Instructions :</strong> Marquez la pr%sence de chaque participant. Les absences peuvent %tre justifi%es ou non.

                </div>

                

                <!-- Filtres et Actions Rapides -->

                <div style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">

                    <button class="fey-btn" onclick="markAllPresent()" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;">

                         Tous Pr%sents

                    </button>

                    <button class="fey-btn" onclick="markAllAbsent()" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;">

                         Tous Absents

                    </button>

                    <button class="fey-btn" onclick="clearAttendance()" style="background: #FF9800; font-size: 0.9rem; padding: 0.5rem 1rem;">

                         Effacer Tout

                    </button>

                    <select id="teamFilter" onchange="filterByTeam()" style="padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        <option value="">Toutes les %quipes</option>

                        <option value="life">%quipes de Vie</option>

                        <option value="night">%quipes de Nuit</option>

                    </select>

                </div>



                <!-- Liste des participants -->

                <div id="participantsTable">

                    <!-- Le contenu sera g%n%r% dynamiquement -->

                </div>



                <!-- Statistiques en temps r%el -->

                <div style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">

                    <div style="background: linear-gradient(135deg, #4CAF50, #66BB6A); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;" id="presentCount">0</div>

                        <div> Pr%sents</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #F44336, #EF5350); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;" id="absentCount">0</div>

                        <div> Absents</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #FF9800, #FFB74D); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;" id="justifiedCount">0</div>

                        <div> Justifi%s</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #2196F3, #42A5F5); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;" id="totalCount">0</div>

                        <div> Total</div>

                    </div>

                </div>



                <!-- Actions finales -->

                <div style="text-align: center; margin-top: 2rem;">

                    <button class="fey-btn" onclick="saveAttendanceRecord()" style="background: #4CAF50; font-size: 1.2rem; padding: 1rem 2rem; margin-right: 1rem;">

                         Sauvegarder le Registre

                    </button>

                    <button class="fey-btn" onclick="printAttendanceRecord()" style="background: #FF9800; font-size: 1.2rem; padding: 1rem 2rem;">

                         Imprimer

                    </button>

                </div>

            </div>



            <!-- Historique des Registres -->

            <div class="fey-card">

                <div class="fey-card-header"> Historique des Registres</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong> Consultation :</strong> Consultez les registres d'appel des sorties pr%c%dentes.

                </div>

                

                <div style="margin-bottom: 1rem; text-align: center;">

                    <button onclick="cleanAttendanceHistory()" class="fey-btn" style="background: #FF9800; padding: 0.5rem 1rem; margin-right: 0.5rem;">

                        c% Nettoyer l'Historique

                    </button>

                    <button onclick="clearAllAttendanceHistory()" class="fey-btn" style="background: #F44336; padding: 0.5rem 1rem;">

                         Tout Supprimer

                    </button>

                </div>

                

                <div id="attendanceHistory">

                    <!-- L'historique sera charg% dynamiquement -->

                </div>

            </div>

        </div>

    </div>



    <script src="js/common.js"></script>

    <script src="js/equipes.js"></script>

    <script>

        // Override showPage function to add page-specific loading

        const originalShowPage = window.showPage;

        window.showPage = function(pageId) {

            // Call the original function

            originalShowPage(pageId);

            

            // Add page-specific functionality

            if (pageId === 'calendrier') {

                setTimeout(() => {

                    if (typeof loadCalendar === 'function') {

                        loadCalendar();

                    }

                }, 100);

            }

            

            // Charger les sorties pour le registre d'appel

            if (pageId === 'registre') {

                setTimeout(() => {

                    if (typeof loadTripsFromCalendar === 'function') {

                        loadTripsFromCalendar();

                    }

                }, 100);

            }

        };



        // Fonction d'authentification

        function authenticate() {

            const password = document.getElementById('passwordInput').value;

            const errorMessage = document.getElementById('errorMessage');

            

            if (password === 'Scout2025!' || password === 'Moussaillons!2025!2026!') {

                // Connexion utilisateur normale

                sessionStorage.setItem('scout_session', 'true');

                document.getElementById('loginPage').style.display = 'none';

                document.getElementById('mainContent').style.display = 'block';

                showPage('liste');

            } else if (password === 'Scout2025!') {

                // Connexion admin

                sessionStorage.setItem('scout_session', 'true');

                sessionStorage.setItem('admin_mode', 'true');

                localStorage.setItem('admin-authenticated', 'true');

                document.getElementById('loginPage').style.display = 'none';

                document.getElementById('mainContent').style.display = 'block';

                enableAdminMode();

                showPage('liste');

            } else {

                // Mot de passe incorrect

                errorMessage.style.display = 'block';

                setTimeout(() => {

                    errorMessage.style.display = 'none';

                }, 3000);

            }

        }



        // Initialiser au chargement

        document.addEventListener('DOMContentLoaded', function() {

            // Ajouter l'event listener pour le bouton de connexion

            const loginBtn = document.getElementById('loginBtn');

            if (loginBtn) {

                loginBtn.addEventListener('click', authenticate);

            }

            

            // Ajouter l'event listener pour la touche Entr%e

            const passwordInput = document.getElementById('passwordInput');

            if (passwordInput) {

                passwordInput.addEventListener('keypress', function(e) {

                    if (e.key === 'Enter') {

                        authenticate();

                    }

                });

            }

            

            // V%rifier la session

            checkSession();

        });



        // Cr%er arbres magiques - R%duit pour les performances

        const treesContainer = document.getElementById('trees');

        for (let i = 0; i < 5; i++) {

            const tree = document.createElement('div');

            tree.className = 'magic-tree';

            tree.textContent = ['%', '%', '$%'][Math.floor(Math.random() * 3)];

            tree.style.left = Math.random() * 100 + '%';

            tree.style.animationDelay = Math.random() * 6 + 's';

            treesContainer.appendChild(tree);

        }



        // Cr%er feuilles tombantes - R%duit pour les performances

        const leavesContainer = document.getElementById('leaves');

        for (let i = 0; i < 6; i++) {

            const leaf = document.createElement('div');

            leaf.className = 'fey-leaf';

            leaf.textContent = ['', '', '%', ''][Math.floor(Math.random() * 4)];

            leaf.style.left = Math.random() * 100 + '%';

            leaf.style.animationDelay = Math.random() * 8 + 's';

            leaf.style.animationDuration = (8 + Math.random() * 4) + 's';

            leavesContainer.appendChild(leaf);

        }



        // Cr%er lucioles - R%duit pour les performances

        const firefliesContainer = document.getElementById('fireflies');

        for (let i = 0; i < 8; i++) {

            const firefly = document.createElement('div');

            firefly.className = 'fey-firefly';

            firefly.style.left = Math.random() * 100 + '%';

            firefly.style.top = Math.random() * 100 + '%';

            firefly.style.animationDelay = Math.random() * 3 + 's';

            firefliesContainer.appendChild(firefly);

        }



        // Cr%er %tincelles de f%e - R%duit pour les performances

        const sparklesContainer = document.getElementById('sparkles');

        for (let i = 0; i < 10; i++) {

            const sparkle = document.createElement('div');

            sparkle.className = 'fairy-sparkle';

            sparkle.style.left = Math.random() * 100 + '%';

            sparkle.style.top = Math.random() * 100 + '%';

            sparkle.style.animationDelay = Math.random() * 4 + 's';

            sparklesContainer.appendChild(sparkle);

        }



        // Cr%er ailes de f%e - R%duit pour les performances

        const wingsContainer = document.getElementById('wings');

        for (let i = 0; i < 3; i++) {

            const wing = document.createElement('div');

            wing.className = 'fairy-wing';

            wing.style.left = Math.random() * 100 + '%';

            wing.style.top = Math.random() * 80 + '%';

            wing.style.animationDelay = Math.random() * 5 + 's';

            wingsContainer.appendChild(wing);

        }



        // Cr%er champignons magiques - R%duit pour les performances

        const mushroomsContainer = document.getElementById('mushrooms');

        for (let i = 0; i < 5; i++) {

            const mushroom = document.createElement('div');

            mushroom.className = 'magic-mushroom';

            mushroom.textContent = ['', ''][Math.floor(Math.random() * 2)];

            mushroom.style.left = Math.random() * 100 + '%';

            mushroom.style.animationDelay = Math.random() * 4 + 's';

            mushroomsContainer.appendChild(mushroom);

        }



        // Cr%er %toiles scintillantes - R%duit pour les performances

        const starsContainer = document.getElementById('stars');

        for (let i = 0; i < 8; i++) {

            const star = document.createElement('div');

            star.className = 'twinkle-star';

            star.style.left = Math.random() * 100 + '%';

            star.style.top = Math.random() * 100 + '%';

            star.style.animationDelay = Math.random() * 3 + 's';

            starsContainer.appendChild(star);

        }



        // Gamification

        const checkboxes = document.querySelectorAll('input[type="checkbox"]');



        function updateProgress() {

            const total = checkboxes.length;

            const checked = document.querySelectorAll('input[type="checkbox"]:checked').length;

            const percentage = Math.round((checked / total) * 100);



            const progressBar = document.getElementById('progressBar');

            progressBar.style.width = percentage + '%';



            if (percentage === 0) {

                progressBar.textContent = '0% - Pr%t pour l\'aventure ?';

            } else if (percentage < 100) {

                progressBar.textContent = percentage + '% - Continue !';

            } else {

                progressBar.textContent = ' Bravo ! Ton sac est pr%t ! ';

                createConfetti();

            }



            document.getElementById('checkedCount').textContent = checked;

            document.getElementById('percentComplete').textContent = percentage + '%';



            // Animation du sac % dos

            updateBackpackAnimation(percentage);

        }



        function createConfetti() {

            const emojis = ['', '', '%', '', '', '', '', '', 'Q%', '', '', ''];

            for (let i = 0; i < 50; i++) {

                const confetti = document.createElement('div');

                confetti.textContent = emojis[Math.floor(Math.random() * emojis.length)];

                confetti.style.position = 'fixed';

                confetti.style.left = Math.random() * 100 + '%';

                confetti.style.top = '-20px';

                confetti.style.fontSize = '2rem';

                confetti.style.zIndex = '9999';

                confetti.style.pointerEvents = 'none';

                confetti.style.animation = 'leavesFall 4s linear';

                confetti.style.filter = 'drop-shadow(0 0 10px rgba(255, 215, 0, 0.8))';

                document.body.appendChild(confetti);

                setTimeout(() => confetti.remove(), 4000);

            }

        }



        // Fonction pour animer le sac % dos

        function updateBackpackAnimation(percentage) {

            const backpackContent = document.getElementById('backpackContent');

            const backpackProgressBar = document.getElementById('backpackProgressBar');

            const backpackStatus = document.getElementById('backpackStatus');

            const backpackText = document.getElementById('backpackText');



            if (!backpackContent || !backpackProgressBar || !backpackStatus || !backpackText) {

                return; // %l%ments pas encore charg%s

            }



            // Animation du remplissage du sac

            backpackContent.style.transform = `scaleY(${percentage / 100})`;

            backpackProgressBar.style.width = percentage + '%';



            // Mise % jour du texte et des particules

            if (percentage === 0) {

                backpackText.textContent = '';

                backpackStatus.textContent = ' Sac vide - Commencez % cocher les %l%ments !';

                backpackStatus.style.color = 'var(--c-forest-700)';

            } else if (percentage < 25) {

                backpackText.textContent = '';

                backpackStatus.textContent = ' Sac commence % se remplir...';

                backpackStatus.style.color = '#FF9800';

                createParticles('');

            } else if (percentage < 50) {

                backpackText.textContent = '';

                backpackStatus.textContent = ' Sac se remplit bien !';

                backpackStatus.style.color = '#FF9800';

                createParticles('');

            } else if (percentage < 75) {

                backpackText.textContent = '';

                backpackStatus.textContent = ' Sac presque plein !';

                backpackStatus.style.color = '#4CAF50';

                createParticles('');

            } else if (percentage < 100) {

                backpackText.textContent = '';

                backpackStatus.textContent = ' Sac presque pr%t !';

                backpackStatus.style.color = '#4CAF50';

                createParticles('');

            } else {

                backpackText.textContent = '';

                backpackStatus.textContent = ' Sac pr%t pour l\'aventure !';

                backpackStatus.style.color = '#2E7D32';

                createParticles('');

                // Animation de secousse pour le sac plein

                const backpack = document.getElementById('backpack');

                if (backpack) {

                    backpack.style.animation = 'shake 0.5s ease-in-out';

                    setTimeout(() => {

                        backpack.style.animation = '';

                    }, 500);

                }

            }

        }



        // Fonction pour cr%er des particules d'animation

        function createParticles(emoji) {

            const particlesContainer = document.getElementById('particles');

            const backpack = document.getElementById('backpack');

            

            if (!particlesContainer || !backpack) {

                return; // %l%ments pas encore charg%s

            }



            const backpackRect = backpack.getBoundingClientRect();

            

            // Cr%er 3-5 particules

            for (let i = 0; i < 3; i++) {

                const particle = document.createElement('div');

                particle.textContent = emoji;

                particle.style.cssText = `

                    position: absolute;

                    font-size: 1.5rem;

                    pointer-events: none;

                    z-index: 20;

                    animation: floatUp 1s ease-out forwards;

                `;

                

                // Position al%atoire autour du sac

                const x = backpackRect.left + Math.random() * backpackRect.width;

                const y = backpackRect.top + Math.random() * backpackRect.height;

                

                particle.style.left = x + 'px';

                particle.style.top = y + 'px';

                

                particlesContainer.appendChild(particle);

                

                // Supprimer la particule apr%s l'animation

                setTimeout(() => {

                    if (particle.parentNode) {

                        particle.parentNode.removeChild(particle);

                    }

                }, 1000);

            }

        }



        checkboxes.forEach(checkbox => {

            checkbox.addEventListener('change', () => {

                updateProgress();

                localStorage.setItem('scout-list', JSON.stringify(

                    Array.from(checkboxes).map(cb => cb.checked)

                ));

            });

        });



        // Charger %tat sauvegard%

        window.addEventListener('load', () => {

            const saved = JSON.parse(localStorage.getItem('scout-list') || '[]');

            checkboxes.forEach((checkbox, index) => {

                if (saved[index]) {

                    checkbox.checked = true;

                }

            });

            updateProgress();

        });



        updateProgress();



        // Jeu de la Promesse - La Qu%te des Sylphes

        function commencerJeu(sylphe) {

            document.getElementById('jeu-accueil').style.display = 'none';

            document.getElementById('defi-loi').style.display = 'block';

            initialiserDefiLoi();

        }



        // Initialiser le d%fi de la loi scoute

        function initialiserDefiLoi() {

            const loiScoute = [

                "Le louveteau %coute les anciens.",

                "Le louveteau pense d'abord aux autres.",

                "Le louveteau dit toujours la v%rit%.",

                "Le louveteau est propre et ordonn%.",

                "Le louveteau est toujours joyeux.",

                "Le louveteau est %conome et soigneux.",

                "Le louveteau est courageux.",

                "Le louveteau est respectueux.",

                "Le louveteau est bon fr%re et bon ami.",

                "Le louveteau est disciplin%."

            ];



            const loiMelangee = [...loiScoute].sort(() => Math.random() - 0.5);

            const jeuLoi = document.getElementById("jeu-loi");

            jeuLoi.innerHTML = '';

            loiMelangee.forEach(article => {

                const div = document.createElement("div");

                div.style.cssText = "background: var(--c-orange-600); color: white; padding: 0.75rem; margin: 0.25rem; border-radius: var(--r-sm); cursor: move; display: inline-block; border: 2px solid var(--c-ink-900); font-size: 0.9rem;";

                div.textContent = article;

                div.draggable = true;

                div.ondragstart = (e) => {

                    e.dataTransfer.setData("text/plain", article);

                };

                jeuLoi.appendChild(div);

            });



            const zoneDepot = document.getElementById("zone-depot");

            zoneDepot.innerHTML = '<p style="text-align: center; color: var(--c-orange-600); font-weight: bold;">D%pose les articles ici dans le bon ordre</p>';

            zoneDepot.ondragover = (e) => {

                e.preventDefault();

            };



            zoneDepot.ondrop = (e) => {

                e.preventDefault();

                const article = e.dataTransfer.getData("text/plain");

                const div = document.createElement("div");

                div.style.cssText = "background: var(--c-forest-700); color: white; padding: 0.75rem; margin: 0.25rem; border-radius: var(--r-sm); display: inline-block; border: 2px solid var(--c-ink-900); font-size: 0.9rem;";

                div.textContent = article;

                zoneDepot.appendChild(div);

            };

        }



        // V%rifier l'ordre de la loi scoute

        function verifierOrdreLoi() {

            const loiScoute = [

                "Le louveteau %coute les anciens.",

                "Le louveteau pense d'abord aux autres.",

                "Le louveteau dit toujours la v%rit%.",

                "Le louveteau est propre et ordonn%.",

                "Le louveteau est toujours joyeux.",

                "Le louveteau est %conome et soigneux.",

                "Le louveteau est courageux.",

                "Le louveteau est respectueux.",

                "Le louveteau est bon fr%re et bon ami.",

                "Le louveteau est disciplin%."

            ];



            const articlesDeposes = Array.from(document.getElementById("zone-depot").children).slice(1).map(el => el.textContent);

            if (JSON.stringify(articlesDeposes) === JSON.stringify(loiScoute)) {

                alert(" Bravo ! Tu as retrouv% la loi scoute dans le bon ordre !");

                document.getElementById('defi-loi').style.display = 'none';

                document.getElementById('defi-priere').style.display = 'block';

                initialiserDefiPriere();

            } else {

                alert(" Ce n'est pas encore %a. R%essaye !");

            }

        }



        // Initialiser le d%fi de la pri%re scoute

        function initialiserDefiPriere() {

            const priereScoute = [

                "Seigneur J%sus,",

                "apprends-nous % %tre g%n%reux,",

                "% te servir comme tu le m%rites,",

                "% donner sans compter,",

                "% combattre sans souci des blessures,",

                "% travailler sans chercher le repos,",

                "% nous donner sans attendre de r%compense,",

                "sauf celle de savoir que nous faisons ta volont%."

            ];



            const priereMelangee = [...priereScoute].sort(() => Math.random() - 0.5);

            const jeuPriere = document.getElementById("jeu-priere");

            jeuPriere.innerHTML = '';

            priereMelangee.forEach(mot => {

                const div = document.createElement("div");

                div.style.cssText = "background: var(--c-marine-700); color: white; padding: 0.75rem; margin: 0.25rem; border-radius: var(--r-sm); cursor: move; display: inline-block; border: 2px solid var(--c-ink-900); font-size: 0.9rem;";

                div.textContent = mot;

                div.draggable = true;

                div.ondragstart = (e) => {

                    e.dataTransfer.setData("text/plain", mot);

                };

                jeuPriere.appendChild(div);

            });



            const zoneDepotPriere = document.getElementById("zone-depot-priere");

            zoneDepotPriere.innerHTML = '<p style="text-align: center; color: var(--c-orange-600); font-weight: bold;">D%pose les mots ici dans le bon ordre</p>';

            zoneDepotPriere.ondragover = (e) => {

                e.preventDefault();

            };



            zoneDepotPriere.ondrop = (e) => {

                e.preventDefault();

                const mot = e.dataTransfer.getData("text/plain");

                const div = document.createElement("div");

                div.style.cssText = "background: var(--c-forest-700); color: white; padding: 0.75rem; margin: 0.25rem; border-radius: var(--r-sm); display: inline-block; border: 2px solid var(--c-ink-900); font-size: 0.9rem;";

                div.textContent = mot;

                zoneDepotPriere.appendChild(div);

            };

        }



        // V%rifier l'ordre de la pri%re scoute

        function verifierOrdrePriere() {

            const priereScoute = [

                "Seigneur J%sus,",

                "apprends-nous % %tre g%n%reux,",

                "% te servir comme tu le m%rites,",

                "% donner sans compter,",

                "% combattre sans souci des blessures,",

                "% travailler sans chercher le repos,",

                "% nous donner sans attendre de r%compense,",

                "sauf celle de savoir que nous faisons ta volont%."

            ];



            const motsDeposes = Array.from(document.getElementById("zone-depot-priere").children).slice(1).map(el => el.textContent);

            if (JSON.stringify(motsDeposes) === JSON.stringify(priereScoute)) {

                alert(" Bravo ! Tu as retrouv% la pri%re scoute dans le bon ordre !");

                document.getElementById('defi-priere').style.display = 'none';

                document.getElementById('defi-quiz').style.display = 'block';

                initialiserQuiz();

            } else {

                alert(" Ce n'est pas encore %a. R%essaye !");

            }

        }



        // Initialiser le quiz

        function initialiserQuiz() {

            const questions = [

                {

                    question: "Quel est le premier article de la loi scoute ?",

                    options: [

                        "Le louveteau %coute les anciens.",

                        "Le louveteau pense d'abord aux autres.",

                        "Le louveteau dit toujours la v%rit%."

                    ],

                    reponse: 0

                },

                {

                    question: "Que dit la pri%re scoute sur le service ?",

                    options: [

                        "% te servir comme tu le m%rites",

                        "% donner sans compter",

                        "% combattre sans souci des blessures"

                    ],

                    reponse: 0

                },

                {

                    question: "Quel est le dernier article de la loi scoute ?",

                    options: [

                        "Le louveteau est disciplin%.",

                        "Le louveteau est respectueux.",

                        "Le louveteau est courageux."

                    ],

                    reponse: 0

                }

            ];



            const quiz = document.getElementById("quiz");

            quiz.innerHTML = '';

            questions.forEach((q, index) => {

                const divQuestion = document.createElement("div");

                divQuestion.style.cssText = "background: rgba(255, 255, 255, 0.7); padding: 1rem; margin: 1rem 0; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);";

                divQuestion.innerHTML = `<h4 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 0.5rem;">${index + 1}. ${q.question}</h4>`;

                const optionsDiv = document.createElement("div");

                optionsDiv.style.cssText = "display: flex; flex-direction: column; gap: 0.5rem; margin-left: 1rem;";

                q.options.forEach((option, i) => {

                    const divOption = document.createElement("div");

                    divOption.style.cssText = "display: flex; align-items: center; gap: 0.5rem;";

                    divOption.innerHTML = `

                        <input type="radio" id="q${index}-option${i}" name="q${index}" value="${i}" style="margin: 0;">

                        <label for="q${index}-option${i}" style="cursor: pointer; font-size: 0.9rem;">${option}</label>

                    `;

                    optionsDiv.appendChild(divOption);

                });

                divQuestion.appendChild(optionsDiv);

                quiz.appendChild(divQuestion);

            });

        }



        // V%rifier les r%ponses du quiz

        function verifierReponsesQuiz() {

            const questions = [

                { reponse: 0 },

                { reponse: 0 },

                { reponse: 0 }

            ];



            let toutesCorrectes = true;

            questions.forEach((q, index) => {

                const reponse = document.querySelector(`input[name="q${index}"]:checked`);

                if (!reponse || parseInt(reponse.value) !== q.reponse) {

                    toutesCorrectes = false;

                }

            });

            if (toutesCorrectes) {

                alert(" Bravo ! Tu as r%ussi le quiz des sylphes !");

                document.getElementById('defi-quiz').style.display = 'none';

                document.getElementById('jeu-fin').style.display = 'block';

            } else {

                alert(" Ce n'est pas encore %a. R%essaye !");

            }

        }



        // Recommencer le jeu

        function recommencerJeu() {

            document.getElementById('jeu-fin').style.display = 'none';

            document.getElementById('jeu-accueil').style.display = 'block';

        }



        // ==================== JEU DES SYLPHES ====================



        // Donn%es des Sylphes

        const sylphes = {

            yzo: {

                name: "Yz%$%",

                icon: "%",

                image: "./images/yzo.png",

                trait: "FRANC",

                description: "Je dis toujours ce que je pense, je fais ce que je dis !",

                color: "#8e44ad"

            },

            kawane: {

                name: "Kawane",

                icon: "",

                image: "./images/kawane.png",

                trait: "RESPECTUEUX",

                description: "Je prends soin de moi et des autres.",

                color: "#27ae60"

            },

            laline: {

                name: "Laline",

                icon: "",

                image: "./images/laline.png",

                trait: "DYNAMIQUE",

                description: "Je suis actif et bon joueur.",

                color: "#e74c3c"

            },

            mayls: {

                name: "Ma%%ls",

                icon: "",

                image: "./images/mayls.png",

                trait: "CURIEUX DE DIEU",

                description: "J'apprends % dire qui est J%sus pour moi.",

                color: "#95a5a6"

            },

            thela: {

                name: "Th%la",

                icon: "",

                image: "./images/thela.png",

                trait: "D%BROUILLARD",

                description: "Je d%couvre le monde et je cr%e de mes mains, je prot%ge notre plan%te.",

                color: "#f39c12"

            },

            blogane: {

                name: "Blogane",

                icon: "Q%",

                image: "./images/blogane.png",

                trait: "SOLIDAIRE",

                description: "Je suis copain avec tous, ici et ailleurs !",

                color: "#e91e63"

            }

        };



        // Situations % associer

        const situations = [

            {

                id: 1,

                text: "Tu vois quelqu'un seul dans son coin pendant la r%cr%ation",

                emoji: "",

                correctSylphe: "blogane",

                explanation: "Blogane est solidaire : %tre copain avec tous, c'est aller vers ceux qui sont seuls !"

            },

            {

                id: 2,

                text: "Tu as cass% quelque chose par accident et personne ne t'a vu",

                emoji: "",

                correctSylphe: "yzo",

                explanation: "Yz%$% est franc : dire la v%rit% m%me quand c'est difficile, c'est du courage !"

            },

            {

                id: 3,

                text: "Ton %quipe perd au jeu mais vous vous %tes bien amus%s",

                emoji: "%",

                correctSylphe: "laline",

                explanation: "Laline est dynamique : %tre bon joueur, c'est savoir perdre avec le sourire !"

            },

            {

                id: 4,

                text: "Tu trouves un oiseau bless% dans la for%t",

                emoji: "",

                correctSylphe: "kawane",

                explanation: "Kawane est respectueux : prendre soin des animaux, c'est respecter la nature !"

            },

            {

                id: 5,

                text: "Il faut r%parer la cabane avec du mat%riel recycl%",

                emoji: "W%",

                correctSylphe: "thela",

                explanation: "Th%la est d%brouillard : cr%er et prot%ger la plan%te, c'est utiliser nos talents !"

            },

            {

                id: 6,

                text: "Tu veux dire merci pour cette belle journ%e ensemble",

                emoji: "",

                correctSylphe: "mayls",

                explanation: "Ma%%ls est curieux de Dieu : prier et remercier, c'est grandir spirituellement !"

            }

        ];



        // Variables globales

        let associations = {};

        let draggedElement = null;



        // S%lection du mode

        function selectMode(mode) {

            document.getElementById('jeu-accueil').style.display = 'none';

            if (mode === 'association') {

                document.getElementById('section-association').style.display = 'block';

                initAssociationMode();

            } else if (mode === 'scenarios') {

                document.getElementById('section-scenarios').style.display = 'block';

                initScenariosMode();

            }

        }



        // Retour au menu

        function retourMenu() {

            document.getElementById('jeu-accueil').style.display = 'block';

            document.getElementById('section-association').style.display = 'none';

            document.getElementById('section-scenarios').style.display = 'none';

            resetAssociations();

        }



        // Initialiser le mode association

        function initAssociationMode() {

            associations = {};

            const situationsList = document.getElementById('situations-list');

            const sylphesZones = document.getElementById('sylphes-zones');



            // Cr%er les situations

            situationsList.innerHTML = '';

            situations.forEach(situation => {

                const div = document.createElement('div');

                div.className = 'situation-item';

                div.draggable = true;

                div.dataset.situationId = situation.id;

                div.style.cssText = "background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 2px solid var(--c-orange-600); border-radius: var(--r-sm); padding: 1rem; margin-bottom: 1rem; cursor: move; transition: all 0.3s ease; font-size: 0.95rem;";

                div.innerHTML = `

                    <span style="font-size: 1.5rem; margin-right: 0.5rem;">${situation.emoji}</span>

                    ${situation.text}

                `;

                div.addEventListener('dragstart', handleDragStart);

                div.addEventListener('dragend', handleDragEnd);

                situationsList.appendChild(div);

            });



            // Cr%er les zones de d%p%$%t pour chaque Sylphe

            sylphesZones.innerHTML = '';

            Object.keys(sylphes).forEach(key => {

                const sylphe = sylphes[key];

                const zone = document.createElement('div');

                zone.className = 'sylphe-drop-zone';

                zone.dataset.sylpheKey = key;

                zone.style.cssText = "background: rgba(255, 255, 255, 0.5); border: 2px dashed var(--c-forest-700); border-radius: var(--r-sm); padding: 1rem; margin-bottom: 1rem; min-height: 100px; transition: all 0.3s ease;";

                zone.innerHTML = `

                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.8rem; padding: 0.5rem; background: white; border-radius: var(--r-sm);">

                        <img src="${sylphe.image}" alt="${sylphe.name}" style="width: 70px; height: 70px; object-fit: contain;"

                             onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';">

                        <span style="display:none; font-size: 2.5rem;">${sylphe.icon}</span>

                        <div style="flex: 1;">

                            <div style="font-family: 'Patrick Hand', cursive; font-size: 1.1rem; color: var(--c-orange-600); font-weight: bold;">${sylphe.name}</div>

                            <div style="font-size: 0.85rem; color: var(--c-forest-700); font-weight: bold;">${sylphe.trait}</div>

                        </div>

                    </div>

                    <div class="drop-area" data-sylphe="${key}">

                        <!-- Situations d%pos%es ici -->

                    </div>

                `;

                zone.addEventListener('dragover', handleDragOver);

                zone.addEventListener('drop', handleDrop);

                zone.addEventListener('dragleave', handleDragLeave);

                zone.addEventListener('dragenter', handleDragEnter);

                sylphesZones.appendChild(zone);

            });



            updateAssociationCount();

        }



        // Gestion du drag and drop

        function handleDragStart(e) {

            draggedElement = e.target;

            e.target.classList.add('dragging');

            e.dataTransfer.effectAllowed = 'move';

            e.dataTransfer.setData('text/html', e.target.innerHTML);

        }



        function handleDragEnd(e) {

            e.target.classList.remove('dragging');

        }



        function handleDragOver(e) {

            if (e.preventDefault) {

                e.preventDefault();

            }

            e.dataTransfer.dropEffect = 'move';

            return false;

        }



        function handleDragEnter(e) {

            if (e.target.classList.contains('sylphe-drop-zone') ||

                e.target.closest('.sylphe-drop-zone')) {

                const zone = e.target.classList.contains('sylphe-drop-zone') ?

                    e.target : e.target.closest('.sylphe-drop-zone');

                zone.classList.add('drag-over');

                zone.style.background = 'rgba(46, 125, 50, 0.1)';

                zone.style.borderColor = 'var(--c-orange-600)';

                zone.style.borderStyle = 'solid';

                zone.style.transform = 'scale(1.02)';

            }

        }



        function handleDragLeave(e) {

            if (e.target.classList.contains('sylphe-drop-zone')) {

                e.target.classList.remove('drag-over');

                e.target.style.background = 'rgba(255, 255, 255, 0.5)';

                e.target.style.borderColor = 'var(--c-forest-700)';

                e.target.style.borderStyle = 'dashed';

                e.target.style.transform = 'scale(1)';

            }

        }



        function handleDrop(e) {

            if (e.stopPropagation) {

                e.stopPropagation();

            }



            const zone = e.target.classList.contains('sylphe-drop-zone') ?

                e.target : e.target.closest('.sylphe-drop-zone');



            if (zone && draggedElement) {

                zone.classList.remove('drag-over');

                zone.style.background = 'rgba(255, 255, 255, 0.5)';

                zone.style.borderColor = 'var(--c-forest-700)';

                zone.style.borderStyle = 'dashed';

                zone.style.transform = 'scale(1)';



                const situationId = parseInt(draggedElement.dataset.situationId);

                const sylpheKey = zone.dataset.sylpheKey;



                // Cr%er l'%l%ment d%pos%

                const dropArea = zone.querySelector('.drop-area');

                const droppedDiv = document.createElement('div');

                droppedDiv.className = 'dropped-situation';

                droppedDiv.style.cssText = "background: linear-gradient(135deg, #e3f2fd, #bbdefb); border: 2px solid #2196f3; border-radius: var(--r-sm); padding: 0.8rem; margin-top: 0.5rem; font-size: 0.9rem;";

                droppedDiv.innerHTML = draggedElement.innerHTML;

                droppedDiv.dataset.situationId = situationId;



                // Supprimer l'ancienne association si elle existe

                Object.keys(associations).forEach(key => {

                    if (associations[key] === situationId) {

                        delete associations[key];

                    }

                });



                // Supprimer les anciennes versions de cette situation

                document.querySelectorAll(`[data-situation-id="${situationId}"]`).forEach(el => {

                    if (el.classList.contains('dropped-situation')) {

                        el.remove();

                    }

                });



                dropArea.appendChild(droppedDiv);



                // Enregistrer l'association

                associations[sylpheKey] = situationId;



                // Cacher la situation originale

                draggedElement.style.display = 'none';



                updateAssociationCount();

            }



            return false;

        }



        // Mettre % jour le compteur

        function updateAssociationCount() {

            const count = Object.keys(associations).length;

            document.getElementById('association-count').textContent = count;

        }



        // V%rifier les associations

        function verifierAssociations() {

            if (Object.keys(associations).length < 6) {

                alert(' Tu dois associer toutes les situations avant de v%rifier !');

                return;

            }



            let correctCount = 0;

            const feedback = document.getElementById('feedback-association');

            let feedbackHTML = '';



            // V%rifier chaque association

            Object.keys(associations).forEach(sylpheKey => {

                const situationId = associations[sylpheKey];

                const situation = situations.find(s => s.id === situationId);

                const isCorrect = situation.correctSylphe === sylpheKey;



                const zone = document.querySelector(`[data-sylphe-key="${sylpheKey}"]`);

                if (isCorrect) {

                    zone.style.background = 'rgba(46, 125, 50, 0.2)';

                    zone.style.borderColor = '#2e7d32';

                    correctCount++;

                    feedbackHTML += `<p> <strong>${sylphes[sylpheKey].name}</strong> : ${situation.explanation}</p>`;

                } else {

                    zone.style.background = 'rgba(211, 47, 47, 0.2)';

                    zone.style.borderColor = '#d32f2f';

                    const correctSylphe = sylphes[situation.correctSylphe];

                    feedbackHTML += `<p> Cette situation correspond plut%$%t % <strong>${correctSylphe.name}</strong> (${correctSylphe.trait})</p>`;

                }

            });



            // Afficher le feedback

            feedback.style.display = 'block';

            if (correctCount === 6) {

                feedback.style.background = 'linear-gradient(135deg, #c8e6c9, #a5d6a7)';

                feedback.style.borderColor = '#2e7d32';

                feedback.innerHTML = `

                    <div style="font-family: 'Patrick Hand', cursive; font-size: 1.8rem; margin-bottom: 1rem; text-align: center;"> Parfait ! 6/6 ! </div>

                    <div style="line-height: 1.6; margin-bottom: 1rem; font-size: 1.1rem;">

                        <p>Bravo ! Tu as parfaitement compris la loi des Sylphes !</p>

                        ${feedbackHTML}

                    </div>

                `;

            } else {

                feedback.style.background = 'linear-gradient(135deg, #fff9c4, #fff59d)';

                feedback.style.borderColor = '#fbc02d';

                feedback.innerHTML = `

                    <div style="font-family: 'Patrick Hand', cursive; font-size: 1.8rem; margin-bottom: 1rem; text-align: center;"> Bien jou% ! ${correctCount}/6</div>

                    <div style="line-height: 1.6; margin-bottom: 1rem; font-size: 1.1rem;">

                        ${feedbackHTML}

                    </div>

                `;

            }



            // D%filer vers le feedback

            feedback.scrollIntoView({ behavior: 'smooth', block: 'center' });

        }



        // Recommencer le mode association

        function recommencerAssociation() {

            // R%initialiser les zones

            document.querySelectorAll('.sylphe-drop-zone').forEach(zone => {

                zone.style.background = 'rgba(255, 255, 255, 0.5)';

                zone.style.borderColor = 'var(--c-forest-700)';

                zone.style.borderStyle = 'dashed';

                const dropArea = zone.querySelector('.drop-area');

                if (dropArea) {

                    dropArea.innerHTML = '';

                }

            });



            // R%afficher toutes les situations

            document.querySelectorAll('.situation-item').forEach(item => {

                item.style.display = 'block';

            });



            // Cacher le feedback

            const feedback = document.getElementById('feedback-association');

            feedback.style.display = 'none';

            feedback.innerHTML = '';



            // R%initialiser les associations

            associations = {};

            updateAssociationCount();



            // D%filer vers le haut

            window.scrollTo({ top: 0, behavior: 'smooth' });

        }



        // R%initialiser compl%tement

        function resetAssociations() {

            associations = {};

            document.getElementById('situations-list').innerHTML = '';

            document.getElementById('sylphes-zones').innerHTML = '';

            const feedback = document.getElementById('feedback-association');

            feedback.style.display = 'none';

            feedback.innerHTML = '';

        }



        // ==================== MODE SC%NARIOS ====================



        // Sc%narios avec choix multiples

        const scenarios = [

            {

                id: 1,

                situation: " Pendant le camp, tu remarques qu'un autre scout a oubli% son sac de couchage. Il fait froid ce soir.",

                choices: [

                    {

                        emoji: "",

                        text: "Je lui pr%te ma couverture de secours m%me si j'aurai un peu froid",

                        correct: true,

                        sylphe: "kawane",

                        feedback: "Excellent ! Tu prends soin des autres comme Kawane. Le respect et l'entraide sont essentiels.",

                        points: 20

                    },

                    {

                        emoji: "",

                        text: "Je fais comme si je n'avais rien vu, ce n'est pas mon probl%me",

                        correct: false,

                        feedback: "Un scout ne laisse jamais un camarade dans le besoin. La solidarit% est une valeur fondamentale.",

                        points: 0

                    },

                    {

                        emoji: "",

                        text: "Je vais voir les chefs pour trouver une solution ensemble",

                        correct: true,

                        sylphe: "thela",

                        feedback: "Tr%s bien ! Tu es d%brouillard et tu cherches des solutions comme Th%la.",

                        points: 20

                    }

                ]

            },

            {

                id: 2,

                situation: "Q% Ton %quipe doit monter la tente, mais certains scouts veulent jouer au lieu d'aider.",

                choices: [

                    {

                        emoji: "",

                        text: "Je monte la tente tout seul sans rien dire",

                        correct: false,

                        feedback: "Le travail d'%quipe est important. Il faut communiquer avec les autres !",

                        points: 0

                    },

                    {

                        emoji: "",

                        text: "Je dis clairement qu'on doit tous participer et j'explique pourquoi c'est important",

                        correct: true,

                        sylphe: "yzo",

                        feedback: "Parfait ! Tu dis la v%rit% avec honn%tet% comme Yz%$%. La communication est essentielle.",

                        points: 20

                    },

                    {

                        emoji: "",

                        text: "Je transforme le montage en jeu amusant pour motiver tout le monde",

                        correct: true,

                        sylphe: "laline",

                        feedback: "G%nial ! Tu es dynamique et bon joueur comme Laline. Tu sais motiver l'%quipe !",

                        points: 20

                    }

                ]

            },

            {

                id: 3,

                situation: "% En randonn%e, vous trouvez un joli endroit avec des fleurs rares. Tes amis veulent en cueillir.",

                choices: [

                    {

                        emoji: "",

                        text: "J'explique qu'il faut prot%ger la nature et je propose de prendre des photos % la place",

                        correct: true,

                        sylphe: "thela",

                        feedback: "Excellent ! Tu prot%ges la plan%te comme Th%la. Un scout respecte la nature.",

                        points: 20

                    },

                    {

                        emoji: "",

                        text: "Je cueille quelques fleurs, ce n'est pas grave",

                        correct: false,

                        feedback: "Un scout prot%ge la nature et respecte l'environnement. Les fleurs rares doivent rester dans leur habitat.",

                        points: 0

                    },

                    {

                        emoji: "",

                        text: "Je reste silencieux m%me si je pense que ce n'est pas bien",

                        correct: false,

                        feedback: "Il faut oser dire ce qu'on pense quand c'est important ! Le courage de ses convictions est essentiel.",

                        points: 0

                    }

                ]

            },

            {

                id: 4,

                situation: " Pendant le repas, un nouveau scout est seul dans son coin et ne parle % personne.",

                choices: [

                    {

                        emoji: "",

                        text: "Je vais le voir et je l'invite % venir manger avec notre groupe",

                        correct: true,

                        sylphe: "blogane",

                        feedback: "Parfait ! Tu es solidaire comme Blogane. L'inclusion est une valeur scoute essentielle.",

                        points: 20

                    },

                    {

                        emoji: "",

                        text: "Je reste avec mes amis, il viendra bien quand il voudra",

                        correct: false,

                        feedback: "Un scout fait toujours le premier pas pour accueillir quelqu'un. L'accueil est au c<%ur du scoutisme.",

                        points: 0

                    },

                    {

                        emoji: "",

                        text: "Je lui demande comment il se sent et ce qu'il aime faire",

                        correct: true,

                        sylphe: "kawane",

                        feedback: "Tr%s bien ! Tu es attentif aux autres comme Kawane. L'%coute est pr%cieuse.",

                        points: 20

                    }

                ]

            },

            {

                id: 5,

                situation: " Pendant le grand jeu, ton %quipe perd. Certains scouts sont d%%us et en col%re.",

                choices: [

                    {

                        emoji: "",

                        text: "Je dis que ce n'est pas grave, l'important c'est de s'%tre amus%s et d'avoir fait de notre mieux",

                        correct: true,

                        sylphe: "laline",

                        feedback: "Super ! Tu es bon joueur comme Laline. L'esprit sportif est important.",

                        points: 20

                    },

                    {

                        emoji: "",

                        text: "Je me plains et je dis que ce n'est pas juste",

                        correct: false,

                        feedback: "Un scout sait perdre avec %l%gance et apprend de ses erreurs. La d%faite fait partie du jeu.",

                        points: 0

                    },

                    {

                        emoji: "",

                        text: "Je prends un moment pour remercier mon %quipe et on r%fl%chit % ce qu'on peut am%liorer",

                        correct: true,

                        sylphe: "yzo",

                        feedback: "Excellent ! Tu es honn%te et constructif comme Yz%$%. Apprendre de ses erreurs est important.",

                        points: 20

                    }

                ]

            }

        ];



        // Variables du mode sc%narios

        let currentScenarioIndex = 0;

        let scenariosScore = 0;

        let scenariosCorrectAnswers = 0;

        let selectedChoice = null;



        // Initialiser le mode sc%narios

        function initScenariosMode() {

            currentScenarioIndex = 0;

            scenariosScore = 0;

            scenariosCorrectAnswers = 0;

            selectedChoice = null;



            document.getElementById('scenarios-final').style.display = 'none';

            document.getElementById('scenarios-score-display').style.display = 'block';

            document.getElementById('total-scenarios').textContent = scenarios.length;



            displayScenario();

        }



        // Afficher un sc%nario

        function displayScenario() {

            const scenario = scenarios[currentScenarioIndex];

            const container = document.getElementById('scenario-container');



            let html = `

                <div style="background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 3px solid var(--c-orange-600); border-radius: var(--r-md); padding: 2rem; margin: 2rem 0;">

                    <h3 style="font-family: 'Patrick Hand', cursive; font-size: 1.8rem; color: var(--c-orange-600); margin-bottom: 1rem; text-align: center;">Sc%nario ${currentScenarioIndex + 1}</h3>

                    <div style="background: white; padding: 1.5rem; border-radius: var(--r-sm); border-left: 4px solid var(--c-orange-600); margin-bottom: 1.5rem; font-size: 1.1rem; line-height: 1.6;">${scenario.situation}</div>

                    <p style="text-align: center; font-weight: bold; color: var(--c-orange-600); margin-bottom: 1rem;">

                        Que ferais-tu ? 

                    </p>

                    <div style="display: flex; flex-direction: column; gap: 1rem; margin: 2rem 0;">

            `;



            scenario.choices.forEach((choice, index) => {

                html += `

                    <button style="background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem; text-align: left; cursor: pointer; transition: all 0.3s ease; font-family: 'Nunito', sans-serif; font-size: 1rem; line-height: 1.5; display: flex; align-items: flex-start; gap: 1rem;" onclick="selectScenarioChoice(${index})" data-choice-index="${index}">

                        <span style="font-size: 2rem; flex-shrink: 0;">${choice.emoji}</span>

                        <span style="flex: 1;">${choice.text}</span>

                    </button>

                `;

            });



            html += `

                    </div>

                </div>

            `;



            container.innerHTML = html;



            // Cacher le feedback

            const feedback = document.getElementById('scenario-feedback');

            feedback.style.display = 'none';

            feedback.innerHTML = '';



            // Mettre % jour le num%ro de sc%nario

            document.getElementById('scenario-number').textContent = currentScenarioIndex + 1;

            document.getElementById('scenarios-score').textContent = scenariosScore;



            selectedChoice = null;

        }



        // S%lectionner un choix

        function selectScenarioChoice(choiceIndex) {

            const scenario = scenarios[currentScenarioIndex];

            const choice = scenario.choices[choiceIndex];

            const buttons = document.querySelectorAll('[data-choice-index]');



            // D%sactiver tous les boutons

            buttons.forEach(btn => {

                btn.style.pointerEvents = 'none';

                btn.style.opacity = '0.7';

            });



            // Marquer le choix s%lectionn%

            const selectedButton = document.querySelector(`[data-choice-index="${choiceIndex}"]`);

            selectedButton.style.background = choice.correct ? 'rgba(46, 125, 50, 0.2)' : 'rgba(211, 47, 47, 0.2)';

            selectedButton.style.borderColor = choice.correct ? '#2e7d32' : '#d32f2f';



            selectedChoice = choiceIndex;



            // Mettre % jour le score

            if (choice.correct) {

                scenariosScore += choice.points;

                scenariosCorrectAnswers++;

                document.getElementById('scenarios-score').textContent = scenariosScore;

            }



            // Afficher le feedback

            showScenarioFeedback(choice);



            // Afficher le bouton suivant apr%s un d%lai

            setTimeout(() => {

                const feedback = document.getElementById('scenario-feedback');

                const nextBtn = document.createElement('div');

                nextBtn.style.textAlign = 'center';

                nextBtn.style.margin = '2rem 0';

                nextBtn.innerHTML = `

                    <button class="fey-btn" onclick="nextScenario()">

                        ${currentScenarioIndex < scenarios.length - 1 ? ' Sc%nario Suivant' : ' Voir les R%sultats'}

                    </button>

                `;

                feedback.appendChild(nextBtn);

            }, 500);

        }



        // Afficher le feedback d'un choix

        function showScenarioFeedback(choice) {

            const feedback = document.getElementById('scenario-feedback');

            feedback.style.display = 'block';

            feedback.style.background = choice.correct ? 'linear-gradient(135deg, #c8e6c9, #a5d6a7)' : 'linear-gradient(135deg, #ffcdd2, #ffab91)';

            feedback.style.borderColor = choice.correct ? '#2e7d32' : '#d32f2f';



            let reactionHTML = '';

            if (choice.correct && choice.sylphe) {

                const sylphe = sylphes[choice.sylphe];

                reactionHTML = `

                    <div style="background: rgba(255, 255, 255, 0.9); padding: 1rem; border-radius: var(--r-sm); border-left: 4px solid var(--c-orange-600); margin-top: 1rem; font-style: italic; display: flex; align-items: center; gap: 1rem;">

                        <img src="${sylphe.image}" alt="${sylphe.name}" style="width: 60px; height: 60px; object-fit: contain; flex-shrink: 0;" onerror="this.style.display='none';">

                        <div>

                            <strong>${sylphe.icon} ${sylphe.name} dit :</strong><br>

                            ${choice.feedback}

                        </div>

                    </div>

                `;

            } else {

                reactionHTML = `

                    <div style="background: rgba(255, 255, 255, 0.9); padding: 1rem; border-radius: var(--r-sm); border-left: 4px solid var(--c-orange-600); margin-top: 1rem; font-style: italic; display: flex; align-items: center; gap: 1rem;">

                        <div style="font-size: 2rem;"></div>

                        <div>${choice.feedback}</div>

                    </div>

                `;

            }



            feedback.innerHTML = `

                <div style="font-family: 'Patrick Hand', cursive; font-size: 1.8rem; margin-bottom: 1rem; text-align: center;">

                    ${choice.correct ? ' Bien jou% !' : ' Pas tout % fait...'}

                </div>

                ${reactionHTML}

            `;



            // D%filer vers le feedback

            feedback.scrollIntoView({ behavior: 'smooth', block: 'center' });

        }



        // Sc%nario suivant

        function nextScenario() {

            currentScenarioIndex++;

            if (currentScenarioIndex < scenarios.length) {

                displayScenario();

                window.scrollTo({ top: 0, behavior: 'smooth' });

            } else {

                showScenariosResult();

            }

        }



        // Afficher les r%sultats finaux

        function showScenariosResult() {

            document.getElementById('scenario-container').style.display = 'none';

            document.getElementById('scenario-feedback').style.display = 'none';

            document.getElementById('scenarios-score-display').style.display = 'none';

            document.getElementById('scenarios-final').style.display = 'block';



            const percentage = Math.round((scenariosCorrectAnswers / scenarios.length) * 100);



            document.getElementById('final-scenarios-score').textContent = scenariosScore;

            document.getElementById('final-correct-answers').textContent = scenariosCorrectAnswers;

            document.getElementById('final-total-questions').textContent = scenarios.length;



            let message = '';

            if (percentage === 100) {

                message = " Incroyable ! Tu es un vrai scout ! Tous les Sylphes sont fiers de toi. Tu as compris l'esprit du scoutisme !";

            } else if (percentage >= 80) {

                message = " Bravo ! Tu as tr%s bien r%ussi ! Les Sylphes te f%licitent. Continue sur cette voie !";

            } else if (percentage >= 60) {

                message = " Bien jou% ! Tu es sur la bonne voie. Les Sylphes t'encouragent % continuer d'apprendre !";

            } else {

                message = " Continue tes efforts ! Les Sylphes croient en toi. Chaque jour est une nouvelle chance d'apprendre !";

            }



            document.getElementById('final-sylphes-message').textContent = message;



            window.scrollTo({ top: 0, behavior: 'smooth' });

        }



        // Recommencer le mode sc%narios

        function recommencerScenarios() {

            document.getElementById('scenario-container').style.display = 'block';

            document.getElementById('scenario-feedback').style.display = 'block';

            initScenariosMode();

        }



        // Ouvrir le jeu de tente 1

        function ouvrirJeuTente() {

            const windowFeatures = 'width=900,height=700,scrollbars=yes,resizable=yes,status=yes,toolbar=no,menubar=no,location=no';

            const jeuWindow = window.open('jeu_tente.html', 'JeuTente', windowFeatures);



            if (jeuWindow) {

                // Centrer la fen%tre

                jeuWindow.moveTo(

                    (screen.width - 900) / 2,

                    (screen.height - 700) / 2

                );

                jeuWindow.focus();

            } else {

                // Si les popups sont bloqu%s, ouvrir dans un nouvel onglet

                window.open('jeu_tente.html', '_blank');

            }

        }



        // Ouvrir le jeu de tente 2

        function ouvrirJeuTente2() {

            const windowFeatures = 'width=900,height=700,scrollbars=yes,resizable=yes,status=yes,toolbar=no,menubar=no,location=no';

            const jeuWindow = window.open('jeu_tente2.html', 'JeuTente2', windowFeatures);



            if (jeuWindow) {

                // Centrer la fen%tre

                jeuWindow.moveTo(

                    (screen.width - 900) / 2,

                    (screen.height - 700) / 2

                );

                jeuWindow.focus();

            } else {

                // Si les popups sont bloqu%s, ouvrir dans un nouvel onglet

                window.open('jeu_tente2.html', '_blank');

            }

        }



        // Ouvrir le jeu de sac scout

        function ouvrirJeuSac() {

            const windowFeatures = 'width=1200,height=800,scrollbars=yes,resizable=yes,status=yes,toolbar=no,menubar=no,location=no';

            const jeuWindow = window.open('scout_bag_game (1).html', 'JeuSacScout', windowFeatures);



            if (jeuWindow) {

                // Centrer la fen%tre

                jeuWindow.moveTo(

                    (screen.width - 1200) / 2,

                    (screen.height - 800) / 2

                );

                jeuWindow.focus();

            } else {

                // Si les popups sont bloqu%s, ouvrir dans un nouvel onglet

                window.open('scout_bag_game (1).html', '_blank');

            }

        }



        // Ouvrir la vid%o tutoriel

        function ouvrirVideoTutorial() {

            // Ouvrir la vid%o YouTube dans un nouvel onglet

            window.open('https://www.youtube.com/watch?v=1s6PgZ0o-vk', '_blank');



            // Afficher un message informatif

            alert(' La vid%o s\'ouvre dans un nouvel onglet !\n\n Conseil : Mets la vid%o en plein %cran pour mieux voir les d%tails du montage de tente.');

        }



        // Ouvrir Google Maps

        function ouvrirMaps() {

            window.open('https://maps.google.com/?q=Jambville+78440', '_blank');

        }



        // Ouvrir WhatsApp

        function ouvrirWhatsApp() {

            window.open('https://chat.whatsapp.com/F2crLBuVQ17L5VbrzoR0xX', '_blank');

        }



        // Fonction supprim%e - le calendrier est maintenant int%gr% directement dans la page



        // Variables globales pour le calendrier

        let currentCalendarMonth = new Date().getMonth();

        let currentCalendarYear = new Date().getFullYear();



        // Fonction pour charger le calendrier

        function loadCalendar() {

            const calendarContainer = document.getElementById('calendar-container');

            if (!calendarContainer) return;



            const monthNames = [

                'Janvier', 'F%vrier', 'Mars', 'Avril', 'Mai', 'Juin',

                'Juillet', 'Ao%W%t', 'Septembre', 'Octobre', 'Novembre', 'D%cembre'

            ];



            const daysInMonth = new Date(currentCalendarYear, currentCalendarMonth + 1, 0).getDate();

            const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1).getDay();

            const today = new Date();



            let calendarHTML = `

                <div style="background: white; padding: 1rem; height: 100%; overflow-y: auto;">

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">

                        <button onclick="changeMonth(-1)" style="

                            background: var(--c-orange-600);

                            color: white;

                            border: 2px solid var(--c-ink-900);

                            border-radius: var(--r-sm);

                            padding: 0.5rem 1rem;

                            cursor: pointer;

                            font-family: 'Patrick Hand', cursive;

                            font-size: 1rem;

                            transition: all 0.3s ease;

                        " onmouseover="this.style.background='var(--c-gold-400)'" onmouseout="this.style.background='var(--c-orange-600)'">

                             Mois pr%c%dent

                        </button>

                        <div style="display: flex; flex-direction: column; align-items: center;">

                            <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); font-size: 1.5rem; margin: 0;">

                                ${monthNames[currentCalendarMonth]} ${currentCalendarYear}

                            </h3>

                            <button onclick="goToToday()" style="

                                background: var(--c-forest-700);

                                color: white;

                                border: 2px solid var(--c-ink-900);

                                border-radius: var(--r-sm);

                                padding: 0.25rem 0.75rem;

                                cursor: pointer;

                                font-family: 'Patrick Hand', cursive;

                                font-size: 0.8rem;

                                transition: all 0.3s ease;

                                margin-top: 0.25rem;

                            " onmouseover="this.style.background='var(--c-forest-500)'" onmouseout="this.style.background='var(--c-forest-700)'">

                                 Aujourd'hui

                            </button>

                        </div>

                        <button onclick="changeMonth(1)" style="

                            background: var(--c-orange-600);

                            color: white;

                            border: 2px solid var(--c-ink-900);

                            border-radius: var(--r-sm);

                            padding: 0.5rem 1rem;

                            cursor: pointer;

                            font-family: 'Patrick Hand', cursive;

                            font-size: 1rem;

                            transition: all 0.3s ease;

                        " onmouseover="this.style.background='var(--c-gold-400)'" onmouseout="this.style.background='var(--c-orange-600)'">

                            Mois suivant 

                        </button>

                    </div>

                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; margin-bottom: 1rem;">

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Lun</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Mar</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Mer</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Jeu</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Ven</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Sam</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Dim</div>

                    </div>

                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px;">

            `;



            // Ajouter les jours vides du d%but du mois

            for (let i = 0; i < firstDay; i++) {

                calendarHTML += `<div style="padding: 0.5rem; min-height: 40px;"></div>`;

            }



            // Ajouter les jours du mois

            for (let day = 1; day <= daysInMonth; day++) {

                const isToday = day === today.getDate() &&

                               currentCalendarMonth === today.getMonth() &&

                               currentCalendarYear === today.getFullYear();

                const isEvent = hasEventOnDay(day, currentCalendarMonth + 1, currentCalendarYear);



                let dayStyle = `

                    padding: 0.5rem;

                    min-height: 40px;

                    border: 2px solid var(--c-ink-900);

                    border-radius: var(--r-sm);

                    cursor: pointer;

                    transition: all 0.3s ease;

                    background: ${isToday ? 'var(--c-orange-600)' : isEvent ? 'var(--c-forest-700)' : 'white'};

                    color: ${isToday || isEvent ? 'white' : 'var(--c-ink-900)'};

                `;



                calendarHTML += `

                    <div style="${dayStyle}" onclick="showEventDetails(${day}, ${currentCalendarMonth + 1}, ${currentCalendarYear})">

                        <div style="font-weight: bold; margin-bottom: 0.25rem;">${day}</div>

                        ${isEvent ? '<div style="font-size: 0.7rem;"></div>' : ''}

                    </div>

                `;

            }



            calendarHTML += `</div></div>`;

            calendarContainer.innerHTML = calendarHTML;

        }



        // Fonction pour charger les sorties du calendrier dans le registre

        function loadTripsFromCalendar() {

            console.log(' Chargement des sorties du calendrier...');

            

            const outingsList = document.getElementById('outingsList');

            if (!outingsList) {

                console.error(' outingsList non trouv%');

                alert(' outingsList non trouv%');

                return;

            }



            console.log(' outingsList trouv%');



            // R%cup%rer les %v%nements

            const events = getCalendarEvents();

            console.log(' %v%nements r%cup%r%s:', Object.keys(events).length);

            

            if (Object.keys(events).length === 0) {

                outingsList.innerHTML = '<div style="text-align: center; color: #666; padding: 2rem;"> Aucune sortie trouv%e dans le calendrier</div>';

                return;

            }

            

            // Construire le HTML des cases % cocher

            let checkboxesHTML = '';

            let count = 0;

            

            Object.entries(events).forEach(([dateKey, event]) => {

                console.log(` Ajout: ${dateKey} - ${event.title}`);

                

                // Cr%er un ID simple

                const tripId = dateKey.replace(/-/g, '_');

                

                // Cr%er une case % cocher

                checkboxesHTML += `

                    <div style="display: flex; align-items: center; padding: 0.5rem; border-bottom: 1px solid #eee;">

                        <input type="checkbox" id="outing_${tripId}" value="${tripId}" onchange="selectOuting('${tripId}')" style="margin-right: 0.75rem; transform: scale(1.2);">

                        <label for="outing_${tripId}" style="flex: 1; cursor: pointer; font-size: 1rem;">

                            <strong>${event.title}</strong>

                            <br><small style="color: #666;">${dateKey}</small>

                        </label>

                    </div>

                `;

                count++;

                

                console.log(` Case % cocher ajout%e: ${event.title}`);

            });

            

            // Remplacer le contenu

            outingsList.innerHTML = checkboxesHTML;

            

            console.log(` ${count} sorties ajout%es avec cases % cocher`);

            alert(` ${count} sorties charg%es avec cases % cocher`);

        }

        

        // Fonction pour g%rer la s%lection d'une sortie

        function selectOuting(tripId) {

            console.log(' Sortie s%lectionn%e:', tripId);

            

            // D%cocher toutes les autres cases

            const allCheckboxes = document.querySelectorAll('#outingsList input[type="checkbox"]');

            allCheckboxes.forEach(checkbox => {

                if (checkbox.value !== tripId) {

                    checkbox.checked = false;

                }

            });

            

            // Charger les d%tails de la sortie s%lectionn%e

            if (document.getElementById(`outing_${tripId}`).checked) {

                loadAttendanceForOuting(tripId);

            } else {

                // Masquer les d%tails si d%coch%

                const outingInfo = document.getElementById('outingInfo');

                if (outingInfo) {

                    outingInfo.style.display = 'none';

                }

            }

        }



        // Fonction pour r%cup%rer les %v%nements du calendrier

        function getCalendarEvents() {

            // R%cup%rer les sorties depuis le localStorage (admin-outings)

            const adminOutings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            

            // Convertir les sorties admin en format %v%nements calendrier

            const events = {};

            

            adminOutings.forEach(outing => {

                // Convertir la date au format DD-MM-YYYY pour la cl%

                const dateKey = outing.startDate.split('-').reverse().join('-');

                

                events[dateKey] = {

                    title: outing.name,

                    time: outing.departureTime || 'Non sp%cifi%e',

                    description: outing.description || 'Aucune description'

                };

            });

            

            // Si aucune sortie admin, utiliser les sorties par d%faut du programme 2025-2026

            if (Object.keys(events).length === 0) {

                return getDefaultCalendarEvents();

            }

            

            // Code de fallback (ne devrait plus %tre utilis%)

            return {

                // D%cembre 2024

                '15-12-2024': {

                    title: ' Lumi%re de Bethl%em 2024',

                    time: 'Dimanche',

                    description: 'Lumi%re de Bethl%em + Cr%che vivante'

                },

                '21-12-2024': {

                    title: ' R%union de Fin d\'Ann%e',

                    time: 'Samedi',

                    description: 'R%union de cl%$%ture de l\'ann%e 2024'

                },

                '22-12-2024': {

                    title: ' R%union de Fin d\'Ann%e',

                    time: 'Dimanche',

                    description: 'R%union de cl%$%ture de l\'ann%e 2024'

                },



                // Janvier 2025

                '5-1-2025': {

                    title: ' R%union de Rentr%e',

                    time: 'Dimanche',

                    description: 'R%union de rentr%e pour l\'ann%e 2025'

                },

                '19-1-2025': {

                    title: ' Sortie Mus%e de la Marine',

                    time: 'Dimanche',

                    description: 'Sortie Mus%e de la Marine + galettes'

                },

                '26-1-2025': {

                    title: ' Weekend de Janvier',

                    time: 'Samedi - D%part',

                    description: 'Weekend d\'hiver avec activit%s scoutes'

                },

                '27-1-2025': {

                    title: ' Weekend de Janvier',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'hiver avec activit%s scoutes'

                },



                // F%vrier 2025

                '2-2-2025': {

                    title: ' Weekend de F%vrier',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'hiver avec activit%s scoutes'

                },

                '9-2-2025': {

                    title: ']% Sortie Montmartre',

                    time: 'Dimanche',

                    description: 'D%couverte de Montmartre'

                },

                '16-2-2025': {

                    title: ' Weekend de F%vrier',

                    time: 'Samedi - D%part',

                    description: 'Weekend d\'hiver avec activit%s scoutes'

                },

                '23-2-2025': {

                    title: '% Sortie Ch%teau',

                    time: 'Dimanche',

                    description: 'Visite d\'un ch%teau historique'

                },



                // Mars 2025

                '2-3-2025': {

                    title: ' Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },

                '9-3-2025': {

                    title: '% Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie d%couverte de la nature'

                },

                '16-3-2025': {

                    title: ' Weekend de Mars',

                    time: 'Samedi - D%part',

                    description: 'Weekend de printemps'

                },

                '23-3-2025': {

                    title: ' Sortie Culturelle',

                    time: 'Dimanche',

                    description: 'Sortie culturelle et artistique'

                },

                '30-3-2025': {

                    title: ' Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },



                // Avril 2025

                '6-4-2025': {

                    title: '% Weekend de P%ques',

                    time: 'Samedi - D%part',

                    description: 'Weekend de P%ques avec activit%s sp%ciales'

                },

                '13-4-2025': {

                    title: '% Weekend de P%ques',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de P%ques avec activit%s sp%ciales'

                },

                '20-4-2025': {

                    title: '% Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie d%couverte de la nature printani%re'

                },

                '27-4-2025': {

                    title: ' Weekend d\'Avril',

                    time: 'Samedi - D%part',

                    description: 'Weekend de printemps'

                },



                // Mai 2025

                '4-5-2025': {

                    title: ' Weekend de Mai',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },

                '11-5-2025': {

                    title: ' Sortie Voile',

                    time: 'Dimanche',

                    description: 'Sortie voile % Verneuil sur Seine'

                },

                '18-5-2025': {

                    title: ' Weekend de Mai',

                    time: 'Samedi - D%part',

                    description: 'Weekend de printemps'

                },

                '25-5-2025': {

                    title: ' Sortie Culturelle',

                    time: 'Dimanche',

                    description: 'Sortie culturelle et artistique'

                },



                // Juin 2025

                '1-6-2025': {

                    title: ' Weekend de Juin',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'%t%'

                },

                '8-6-2025': {

                    title: '% Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie d%couverte de la nature estivale'

                },

                '15-6-2025': {

                    title: ' Weekend de Juin',

                    time: 'Samedi - D%part',

                    description: 'Weekend d\'%t%'

                },

                '22-6-2025': {

                    title: ' Sortie Finale',

                    time: 'Dimanche',

                    description: 'Sortie de cl%$%ture de l\'ann%e scolaire'

                },

                '29-6-2025': {

                    title: ' R%union de Fin d\'Ann%e',

                    time: 'Dimanche',

                    description: 'R%union de cl%$%ture de l\'ann%e scolaire'

                },



                // Juillet 2025 - Camp d'%t%

                '6-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'D%but du camp',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '7-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 2',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '8-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 3',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '9-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 4',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '10-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 5',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '11-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 6',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '12-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 7',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '13-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 8',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '14-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 9',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '15-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 10',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '16-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 11',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '17-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 12',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '18-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 13',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '19-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Fin du camp',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },



                // Octobre 2025

                '3-10-2025': {

                    title: ' Weekend de Groupe',

                    time: 'Samedi - D%part',

                    description: 'Weekend de groupe avec activit%s scoutes'

                },

                '4-10-2025': {

                    title: ' Weekend de Groupe',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de groupe avec activit%s scoutes'

                },

                '12-10-2025': {

                    title: ' Sortie Voile',

                    time: 'Dimanche',

                    description: 'Sortie voile % Verneuil sur Seine'

                },



                // Novembre 2025

                '15-11-2025': {

                    title: '% Weekend Abbaye d\'Epernon',

                    time: 'Samedi - D%part',

                    description: 'Weekend % l\'Abbaye d\'Epernon'

                },

                '16-11-2025': {

                    title: '% Weekend Abbaye d\'Epernon',

                    time: 'Dimanche - Retour',

                    description: 'Weekend % l\'Abbaye d\'Epernon'

                }

            };

        }



        // Fonction pour charger le registre d'une sortie

        function loadTripRegistry() {

            const tripSelector = document.getElementById('tripSelector');

            const tripRegistry = document.getElementById('tripRegistry');

            const registryContent = document.getElementById('registryContent');



            if (!tripSelector || !tripRegistry || !registryContent) return;



            const selectedTripId = tripSelector.value;

            

            if (!selectedTripId) {

                tripRegistry.style.display = 'none';

                return;

            }



            // Afficher le registre

            tripRegistry.style.display = 'block';



            // Charger les donn%es de la sortie depuis le calendrier

            const calendarEvents = getCalendarEvents();

            let selectedTrip = null;

            let selectedDate = null;



            // Trouver la sortie s%lectionn%e

            Object.entries(calendarEvents).forEach(([dateKey, event]) => {

                const tripId = dateKey.replace(/-/g, '_');

                if (tripId === selectedTripId) {

                    selectedTrip = event;

                    selectedDate = dateKey;

                }

            });



            if (!selectedTrip) {

                registryContent.innerHTML = '<p> Sortie non trouv%e dans le calendrier</p>';

                return;

            }



            // Cr%er le contenu du registre

            const tripDate = new Date(selectedDate.split('-').reverse().join('-'));

            const formattedDate = tripDate.toLocaleDateString('fr-FR', {

                weekday: 'long',

                day: 'numeric',

                month: 'long',

                year: 'numeric'

            });



            registryContent.innerHTML = `

                <div style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); padding: 1rem; border-radius: var(--r-sm); margin-bottom: 1rem;">

                    <h4 style="margin: 0 0 0.5rem 0; color: var(--c-forest-700);">${selectedTrip.title}</h4>

                    <p style="margin: 0; color: var(--c-forest-600);"> ${formattedDate}</p>

                    ${selectedTrip.description ? `<p style="margin: 0.5rem 0 0 0; color: var(--c-forest-600);">${selectedTrip.description}</p>` : ''}

                </div>

                

                <div style="background: white; padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                    <h5 style="margin: 0 0 1rem 0; color: var(--c-ink-900);"> Registre de pr%sence</h5>

                    <p style="color: var(--c-ink-600); margin: 0;">Le registre de pr%sence sera disponible ici pour cette sortie.</p>

                    <div style="margin-top: 1rem; padding: 1rem; background: var(--c-gold-100); border-radius: var(--r-sm); border-left: 4px solid var(--c-gold-600);">

                        <strong> Fonctionnalit% en d%veloppement</strong><br>

                        Le syst%me de registre de pr%sence sera bient%$%t int%gr% avec les donn%es des %quipes.

                    </div>

                </div>

            `;

        }



        // Fonction pour changer de mois

        function changeMonth(direction) {

            currentCalendarMonth += direction;



            // G%rer le changement d'ann%e

            if (currentCalendarMonth < 0) {

                currentCalendarMonth = 11;

                currentCalendarYear--;

            } else if (currentCalendarMonth > 11) {

                currentCalendarMonth = 0;

                currentCalendarYear++;

            }



            // Recharger le calendrier

            loadCalendar();

        }



        // Fonction pour revenir au mois actuel

        function goToToday() {

            const today = new Date();

            currentCalendarMonth = today.getMonth();

            currentCalendarYear = today.getFullYear();

            loadCalendar();

        }



        // Fonction pour v%rifier s'il y a un %v%nement un jour donn%

        function hasEventOnDay(day, month, year) {

            const events = {

                // D%cembre 2024

                '15-12-2024': true, // Lumi%re de Bethl%em 2024

                '21-12-2024': true, // R%union de fin d'ann%e

                '22-12-2024': true, // R%union de fin d'ann%e



                // Janvier 2025

                '12-1-2025': true, // R%union de rentr%e

                '19-1-2025': true, // Sortie Mus%e de la Marine

                '26-1-2025': true, // Weekend de janvier



                // F%vrier 2025

                '2-2-2025': true, // Weekend de f%vrier

                '9-2-2025': true, // Sortie Montmartre

                '16-2-2025': true, // Weekend de f%vrier

                '23-2-2025': true, // Sortie ch%teau



                // Mars 2025

                '2-3-2025': true, // Weekend de mars

                '9-3-2025': true, // Sortie nature

                '16-3-2025': true, // Weekend de mars

                '23-3-2025': true, // Sortie culturelle

                '30-3-2025': true, // Weekend de mars



                // Avril 2025

                '6-4-2025': true, // Weekend de P%ques

                '13-4-2025': true, // Weekend de P%ques

                '20-4-2025': true, // Sortie nature

                '27-4-2025': true, // Weekend d'avril



                // Mai 2025

                '4-5-2025': true, // Weekend de mai

                '11-5-2025': true, // Sortie voile

                '18-5-2025': true, // Weekend de mai

                '25-5-2025': true, // Sortie culturelle



                // Juin 2025

                '1-6-2025': true, // Weekend de juin

                '8-6-2025': true, // Sortie nature

                '15-6-2025': true, // Weekend de juin

                '22-6-2025': true, // Sortie finale

                '29-6-2025': true, // R%union de fin d'ann%e



                // Juillet 2025

                '6-7-2025': true, // Camp d'%t% (d%but)

                '7-7-2025': true, // Camp d'%t%

                '8-7-2025': true, // Camp d'%t%

                '9-7-2025': true, // Camp d'%t%

                '10-7-2025': true, // Camp d'%t%

                '11-7-2025': true, // Camp d'%t%

                '12-7-2025': true, // Camp d'%t%

                '13-7-2025': true, // Camp d'%t%

                '14-7-2025': true, // Camp d'%t%

                '15-7-2025': true, // Camp d'%t%

                '16-7-2025': true, // Camp d'%t%

                '17-7-2025': true, // Camp d'%t%

                '18-7-2025': true, // Camp d'%t%

                '19-7-2025': true, // Camp d'%t% (fin)



                // Septembre 2025

                '28-9-2025': true, // R%union parents



                // Octobre 2025

                '3-10-2025': true, // Weekend de Groupe (Jour 1)

                '4-10-2025': true, // Weekend de Groupe (Jour 2)

                '12-10-2025': true, // Sortie voile (Verneuil sur Seine)



                // Novembre 2025

                '15-11-2025': true, // Weekend Abbaye d'Epernon (Jour 1)

                '16-11-2025': true, // Weekend Abbaye d'Epernon (Jour 2)



                // D%cembre 2025

                '14-12-2025': true, // Lumi%re de Bethl%em + Cr%che vivante



                // Janvier 2026

                '18-1-2026': true, // Sortie Mus%e de la Marine + galettes



                // F%vrier 2026

                '8-2-2026': true, // Sortie Montmartre



                // Mars 2026

                '14-3-2026': true, // Weekend de mars (Jour 1)

                '15-3-2026': true, // Weekend de mars (Jour 2)



                // Avril 2026

                '5-4-2026': true, // Sortie ch%teau



                // Mai 2026

                '15-5-2026': true, // Mini-camp Mont Saint-Michel (Jour 1)

                '16-5-2026': true, // Mini-camp Mont Saint-Michel (Jour 2)

                '17-5-2026': true, // Mini-camp Mont Saint-Michel (Jour 3)



                // Juin 2026

                '12-6-2026': true, // R%union pr%sentation camp

                '13-6-2026': true, // Weekend de juin (Jour 1)

                '14-6-2026': true, // Weekend de juin (Jour 2)



                // Juillet 2026

                '5-7-2026': true, // Camp d'%t% (d%but)

                '6-7-2026': true, // Camp d'%t%

                '7-7-2026': true, // Camp d'%t%

                '8-7-2026': true, // Camp d'%t%

                '9-7-2026': true, // Camp d'%t%

                '10-7-2026': true, // Camp d'%t%

                '11-7-2026': true, // Camp d'%t%

                '12-7-2026': true, // Camp d'%t%

                '13-7-2026': true, // Camp d'%t%

                '14-7-2026': true, // Camp d'%t%

                '15-7-2026': true, // Camp d'%t%

                '16-7-2026': true, // Camp d'%t%

                '17-7-2026': true, // Camp d'%t%

                '18-7-2026': true, // Camp d'%t%

                '19-7-2026': true  // Camp d'%t% (fin)

            };



            const dateKey = `${day}-${month}-${year}`;

            return events[dateKey] || false;

        }



        // Fonction pour afficher les d%tails d'un %v%nement

        function showEventDetails(day, month, year) {

            const events = {

                // D%cembre 2024

                '15-12-2024': {

                    title: ' Lumi%re de Bethl%em 2024',

                    time: 'Dimanche',

                    description: 'Lumi%re de Bethl%em + Cr%che vivante'

                },

                '21-12-2024': {

                    title: ' R%union de Fin d\'Ann%e',

                    time: 'Samedi',

                    description: 'R%union de cl%$%ture de l\'ann%e 2024'

                },

                '22-12-2024': {

                    title: ' R%union de Fin d\'Ann%e',

                    time: 'Dimanche',

                    description: 'R%union de cl%$%ture de l\'ann%e 2024'

                },



                // Janvier 2025

                '12-1-2025': {

                    title: ' R%union de Rentr%e',

                    time: 'Dimanche',

                    description: 'R%union de rentr%e pour l\'ann%e 2025'

                },

                '19-1-2025': {

                    title: ' Sortie Mus%e de la Marine',

                    time: 'Dimanche',

                    description: 'Sortie Mus%e de la Marine + galettes'

                },

                '26-1-2025': {

                    title: ' Weekend de Janvier',

                    time: 'Samedi - D%part',

                    description: 'Weekend d\'hiver avec activit%s scoutes'

                },



                // F%vrier 2025

                '2-2-2025': {

                    title: ' Weekend de F%vrier',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'hiver avec activit%s scoutes'

                },

                '9-2-2025': {

                    title: ']% Sortie Montmartre',

                    time: 'Dimanche',

                    description: 'D%couverte de Montmartre'

                },

                '16-2-2025': {

                    title: ' Weekend de F%vrier',

                    time: 'Samedi - D%part',

                    description: 'Weekend d\'hiver avec activit%s scoutes'

                },

                '23-2-2025': {

                    title: '% Sortie Ch%teau',

                    time: 'Dimanche',

                    description: 'Visite d\'un ch%teau historique'

                },



                // Mars 2025

                '2-3-2025': {

                    title: ' Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },

                '9-3-2025': {

                    title: '% Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie d%couverte de la nature'

                },

                '16-3-2025': {

                    title: ' Weekend de Mars',

                    time: 'Samedi - D%part',

                    description: 'Weekend de printemps'

                },

                '23-3-2025': {

                    title: ' Sortie Culturelle',

                    time: 'Dimanche',

                    description: 'Sortie culturelle et artistique'

                },

                '30-3-2025': {

                    title: ' Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },



                // Avril 2025

                '6-4-2025': {

                    title: '% Weekend de P%ques',

                    time: 'Samedi - D%part',

                    description: 'Weekend de P%ques avec activit%s sp%ciales'

                },

                '13-4-2025': {

                    title: '% Weekend de P%ques',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de P%ques avec activit%s sp%ciales'

                },

                '20-4-2025': {

                    title: '% Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie d%couverte de la nature printani%re'

                },

                '27-4-2025': {

                    title: ' Weekend d\'Avril',

                    time: 'Samedi - D%part',

                    description: 'Weekend de printemps'

                },



                // Mai 2025

                '4-5-2025': {

                    title: ' Weekend de Mai',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },

                '11-5-2025': {

                    title: ' Sortie Voile',

                    time: 'Dimanche',

                    description: 'Sortie voile % Verneuil sur Seine'

                },

                '18-5-2025': {

                    title: ' Weekend de Mai',

                    time: 'Samedi - D%part',

                    description: 'Weekend de printemps'

                },

                '25-5-2025': {

                    title: ' Sortie Culturelle',

                    time: 'Dimanche',

                    description: 'Sortie culturelle et artistique'

                },



                // Juin 2025

                '1-6-2025': {

                    title: ' Weekend de Juin',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'%t%'

                },

                '8-6-2025': {

                    title: '% Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie d%couverte de la nature estivale'

                },

                '15-6-2025': {

                    title: ' Weekend de Juin',

                    time: 'Samedi - D%part',

                    description: 'Weekend d\'%t%'

                },

                '22-6-2025': {

                    title: ' Sortie Finale',

                    time: 'Dimanche',

                    description: 'Sortie de cl%$%ture de l\'ann%e scolaire'

                },

                '29-6-2025': {

                    title: ' R%union de Fin d\'Ann%e',

                    time: 'Dimanche',

                    description: 'R%union de cl%$%ture de l\'ann%e scolaire'

                },



                // Juillet 2025 - Camp d'%t%

                '6-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'D%but du camp',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '7-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 2',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '8-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 3',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '9-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 4',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '10-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 5',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '11-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 6',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '12-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 7',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '13-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 8',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '14-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 9',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '15-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 10',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '16-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 11',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '17-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 12',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '18-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Jour 13',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '19-7-2025': {

                    title: ' Camp d\'%t% 2025',

                    time: 'Fin du camp',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },



                // Septembre 2025

                '28-9-2025': {

                    title: ' R%union Parents',

                    time: 'Dimanche',

                    description: 'R%union d\'information pour les parents'

                },



                // Octobre 2025

                '3-10-2025': {

                    title: ' Weekend de Groupe',

                    time: 'Samedi - D%part',

                    description: 'Weekend de groupe avec activit%s scoutes'

                },

                '4-10-2025': {

                    title: ' Weekend de Groupe',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de groupe avec activit%s scoutes'

                },

                '12-10-2025': {

                    title: ' Sortie Voile',

                    time: 'Dimanche',

                    description: 'Sortie voile % Verneuil sur Seine'

                },



                // Novembre 2025

                '15-11-2025': {

                    title: '% Weekend Abbaye d\'Epernon',

                    time: 'Samedi - D%part',

                    description: 'Weekend au Prieur% Saint Thomas'

                },

                '16-11-2025': {

                    title: '% Weekend Abbaye d\'Epernon',

                    time: 'Dimanche - Retour',

                    description: 'Weekend au Prieur% Saint Thomas'

                },



                // D%cembre 2025

                '14-12-2025': {

                    title: ' Lumi%re de Bethl%em',

                    time: 'Dimanche',

                    description: 'Lumi%re de Bethl%em + Cr%che vivante'

                },



                // Janvier 2026

                '18-1-2026': {

                    title: ' Sortie Mus%e de la Marine',

                    time: 'Dimanche',

                    description: 'Sortie Mus%e de la Marine + galettes'

                },



                // F%vrier 2026

                '8-2-2026': {

                    title: ']% Sortie Montmartre',

                    time: 'Dimanche',

                    description: 'D%couverte de Montmartre'

                },



                // Mars 2026

                '14-3-2026': {

                    title: ' Weekend de Mars',

                    time: 'Samedi - D%part',

                    description: 'Weekend de printemps'

                },

                '15-3-2026': {

                    title: ' Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },



                // Avril 2026

                '5-4-2026': {

                    title: '% Sortie Ch%teau',

                    time: 'Dimanche',

                    description: 'Visite d\'un ch%teau historique'

                },



                // Mai 2026

                '15-5-2026': {

                    title: '% Mini-camp Mont Saint-Michel',

                    time: 'Vendredi - D%part',

                    description: 'Mini-camp de 3 jours au Mont Saint-Michel'

                },

                '16-5-2026': {

                    title: '% Mini-camp Mont Saint-Michel',

                    time: 'Samedi',

                    description: 'Mini-camp de 3 jours au Mont Saint-Michel'

                },

                '17-5-2026': {

                    title: '% Mini-camp Mont Saint-Michel',

                    time: 'Dimanche - Retour',

                    description: 'Mini-camp de 3 jours au Mont Saint-Michel'

                },



                // Juin 2026

                '12-6-2026': {

                    title: ' R%union Pr%sentation Camp',

                    time: 'Vendredi 18h-20h',

                    description: 'R%union de pr%sentation du camp d\'%t%'

                },

                '13-6-2026': {

                    title: ' Weekend de Juin',

                    time: 'Samedi - D%part',

                    description: 'Weekend d\'%t%'

                },

                '14-6-2026': {

                    title: ' Weekend de Juin',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'%t%'

                },



                // Juillet 2026 - Camp d'%t%

                '5-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'D%but du camp',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '6-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 2',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '7-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 3',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '8-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 4',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '9-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 5',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '10-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 6',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '11-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 7',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '12-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 8',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '13-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 9',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '14-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 10',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '15-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 11',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '16-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 12',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '17-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 13',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '18-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Jour 14',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                },

                '19-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Fin du camp',

                    description: 'Camp d\'%t% - Premi%re quinzaine des vacances Zone C'

                }

            };



            const dateKey = `${day}-${month}-${year}`;

            const event = events[dateKey];



            if (event) {

                alert(` ${event.title}\n% ${event.time}\n ${event.description}`);

            } else {

                alert(` ${day}/${month}/${year}\nAucun %v%nement pr%vu ce jour.`);

            }

        }



        // Gestion des formulaires de covoiturage

        document.addEventListener('DOMContentLoaded', function() {

            // Charger les notes admin

            loadAdminNotes();

            updateMainPageNotes();

            

            // G%rer tous les formulaires de covoiturage

            const carpoolForms = document.querySelectorAll('.carpool-form');

            carpoolForms.forEach(form => {

                form.addEventListener('submit', function(e) {

                    e.preventDefault();



                    const formData = new FormData(form);

                    const sectionId = form.id.replace('carpoolForm-', '');



                    const carpoolData = {

                        parentName: formData.get('parentName'),

                        parentPhone: formData.get('parentPhone'),

                        childName: formData.get('childName'),

                        childSeats: formData.get('childSeats'),

                        adultSeats: formData.get('adultSeats'),

                        departurePoint: formData.get('departurePoint'),

                        roundTrip: formData.get('roundTrip'),

                        timePreference: formData.get('timePreference'),

                        comments: formData.get('comments'),

                        id: Date.now(),

                        date: new Date().toISOString()

                    };



                    // Sauvegarder en localStorage pour cette section

                    const existingCarpools = JSON.parse(localStorage.getItem(`carpools-${sectionId}`) || '[]');

                    existingCarpools.push(carpoolData);

                    localStorage.setItem(`carpools-${sectionId}`, JSON.stringify(existingCarpools));



                    // Afficher confirmation

                    const sectionNames = {

                        'weekend-groupe': 'Weekend Groupe',

                        'sortie-voile': 'Sortie Voile',

                        'jambville': 'Jambville',

                        'autres': 'Autres Sorties'

                    };



                    alert(` Inscription au covoiturage ${sectionNames[sectionId]} enregistr%e !\n\nMerci de votre participation %cologique ! %`);



                    // R%initialiser le formulaire

                    form.reset();



                    // Recharger la liste des covoiturages pour cette section

                    loadCarpoolListForSection(sectionId);

                });

            });



            // Charger la liste des covoiturages pour la section par d%faut

            loadCarpoolListForSection('weekend-groupe');

        });



        // Liste des enfants scouts

        const scoutChildren = [

            { nom: 'DESCAMPS', prenom: 'JEANNE' },

            { nom: 'LAURENT BILLET', prenom: 'CLAIRE' },

            { nom: 'PICHEREAU', prenom: 'JULES' },

            { nom: 'POTTER', prenom: 'FELIX' },

            { nom: 'ROUSSEAU', prenom: 'LEOPOLD' },

            { nom: 'JEANJEAN', prenom: 'MADELEINE' },

            { nom: 'LALIGAND', prenom: 'LEA' },

            { nom: 'MILLART', prenom: 'CONSTANCE' },

            { nom: 'REYNAL DE SAINT MICHEL', prenom: 'ALEXIA' },

            { nom: 'D\'ANDREA', prenom: 'DANTE' },

            { nom: 'JANDARD', prenom: 'LEV' },

            { nom: 'ROIG', prenom: 'OCTAVE' },

            { nom: 'RUEF', prenom: 'ALFRED' },

            { nom: 'MATHIEN', prenom: 'AMBRE' },

            { nom: 'FAUGERE', prenom: 'LEA' },

            { nom: 'GENTIL', prenom: 'CONSTANCE' },

            { nom: 'HUCHEZ', prenom: 'SIBYLLE' },

            { nom: 'LANASPRE', prenom: 'ROMANE' },

            { nom: 'NIERAT', prenom: 'ZOE' },

            { nom: 'SERVONNAT', prenom: 'LOUISON' },

            { nom: 'WARGNIER', prenom: 'GABRIELLE' },

            { nom: 'POTTER', prenom: 'OSCAR' },

            { nom: 'ROIG', prenom: 'JULES' },

            { nom: 'TALPAERT', prenom: 'GABRIEL' }

        ];



        // Fonction pour afficher les sous-onglets de covoiturage

        function showCarpoolTab(tabId) {

            // Masquer toutes les sections

            document.querySelectorAll('.carpool-section').forEach(section => {

                section.style.display = 'none';

            });



            // D%sactiver tous les onglets

            document.querySelectorAll('.carpool-tab').forEach(tab => {

                tab.classList.remove('active');

            });



            // Afficher la section s%lectionn%e

            document.getElementById(tabId).style.display = 'block';



            // Activer l'onglet s%lectionn%

            document.querySelector(`[onclick="showCarpoolTab('${tabId}')"]`).classList.add('active');



            // Charger les donn%es pour cette section

            loadCarpoolListForSection(tabId);

        }



        // Fonction pour charger la liste des covoiturages pour une section sp%cifique

        function loadCarpoolListForSection(sectionId) {

            const carpoolList = document.getElementById(`carpoolList-${sectionId}`);

            if (!carpoolList) return;



            const carpoolData = JSON.parse(localStorage.getItem(`carpools-${sectionId}`) || '[]');



            if (carpoolData.length === 0) {

                carpoolList.innerHTML = `

                    <div class="fey-item" style="text-align: center; color: var(--c-forest-700);">

                        <strong> Aucun covoiturage enregistr% pour le moment</strong><br>

                        <span style="font-size: 0.9rem;">Soyez le premier % proposer un covoiturage !</span>

                    </div>

                `;

                return;

            }



            let html = '';

            carpoolData.forEach(carpool => {

                const colors = [

                    'linear-gradient(135deg, #E3F2FD, #BBDEFB)',

                    'linear-gradient(135deg, #FFF3E0, #FFE0B2)',

                    'linear-gradient(135deg, #E8F5E8, #C8E6C9)',

                    'linear-gradient(135deg, #F3E5F5, #E1BEE7)'

                ];

                const borders = ['#2196F3', '#FF9800', '#4CAF50', '#9C27B0'];

                const randomIndex = Math.floor(Math.random() * colors.length);



                const roundTripText = {

                    'aller-seulement': 'Aller seulement',

                    'retour-seulement': 'Retour seulement',

                    'aller-retour': 'Aller et Retour'

                };



                html += `

                    <div class="fey-item" style="background: ${colors[randomIndex]}; border-left: 4px solid ${borders[randomIndex]};">

                        <strong> ${carpool.parentName}</strong> - <span style="color: var(--c-forest-700);">${carpool.childSeats} enfant${carpool.childSeats > 1 ? 's' : ''} / ${carpool.adultSeats} adulte${carpool.adultSeats > 1 ? 's' : ''}</span><br>

                        <span style="font-size: 0.9rem;"> D%part: ${carpool.departurePoint} - % ${carpool.parentPhone}</span><br>

                        <span style="font-size: 0.9rem; color: var(--c-ink-900);"> ${roundTripText[carpool.roundTrip]} - % ${carpool.timePreference || 'Aucune pr%f%rence'}</span><br>

                        <span style="font-size: 0.9rem; color: var(--c-ink-900);"> "${carpool.comments || 'Aucun commentaire'}"</span>

                    </div>

                `;

            });



            carpoolList.innerHTML = html;

        }



        // Fonction pour charger la liste des covoiturages (ancienne version pour compatibilit%)

        function loadCarpoolList() {

            loadCarpoolListForSection('weekend');

        }



        // Fonction pour cr%er une voiture

        function createCar(sectionId) {

            const form = document.getElementById(`carForm-${sectionId}`);

            const formData = new FormData(form);



            const carData = {

                parentName: formData.get('parentName'),

                parentPhone: formData.get('parentPhone'),

                departurePoint: 'Place de la Mairie', // Fix% par admin

                arrivalPoint: 'Jambville', // Fix% par admin

                childSeats: formData.get('childSeats'),

                adultSeats: formData.get('adultSeats'),

                comments: formData.get('comments'),

                id: Date.now(),

                date: new Date().toISOString(),

                children: [], // Liste des enfants ajout%s par les parents

                status: 'available' // available, full

            };



            // Sauvegarder la voiture comme disponible

            const existingCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');

            existingCars.push(carData);

            localStorage.setItem(`available-cars-${sectionId}`, JSON.stringify(existingCars));



            // Afficher confirmation

            alert(' Voiture cr%%e et disponible !\n\nLes parents peuvent maintenant ajouter leurs enfants.');



            // Recharger les listes

            loadAvailableCars(sectionId);

            loadChildrenWithoutCar(sectionId, 'aller');

            loadChildrenWithoutCar(sectionId, 'retour');



            // R%initialiser le formulaire

            form.reset();

        }



        // Fonction pour afficher la s%lection des enfants

        function showChildrenSelection(sectionId, carData) {

            // Masquer le formulaire de voiture

            document.getElementById(`carForm-${sectionId}`).parentElement.style.display = 'none';



            // Afficher la s%lection des enfants

            const childrenSelection = document.getElementById(`children-selection-${sectionId}`);

            childrenSelection.style.display = 'block';



            // Afficher les informations de la voiture

            const carInfo = document.getElementById(`selected-car-info-${sectionId}`);

            carInfo.innerHTML = `

                <strong> Votre voiture :</strong><br>

                <strong> ${carData.parentName}</strong> - % ${carData.parentPhone}<br>

                <strong> ${carData.departurePoint}  ${carData.arrivalPoint}</strong><br>

                <strong> ${carData.childSeats} enfant${carData.childSeats > 1 ? 's' : ''} /  ${carData.adultSeats} adulte${carData.adultSeats > 1 ? 's' : ''}</strong><br>

                <strong> ${carData.roundTrip}</strong> - % ${carData.timePreference || 'Aucune pr%f%rence'}

            `;



            // Charger la liste des enfants disponibles

            loadChildrenCheckboxes(sectionId);

        }



        // Fonction pour charger les cases % cocher des enfants

        function loadChildrenCheckboxes(sectionId) {

            const container = document.getElementById(`children-checkboxes-${sectionId}`);

            let html = '';



            scoutChildren.forEach(child => {

                const fullName = `${child.nom} ${child.prenom}`;

                html += `

                    <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; border: 1px solid var(--c-ink-900); border-radius: var(--r-sm); background: rgba(255, 255, 255, 0.7);">

                        <input type="checkbox" id="child-${child.nom}-${child.prenom}-${sectionId}" value="${fullName}" style="transform: scale(1.2);">

                        <label for="child-${child.nom}-${child.prenom}-${sectionId}" style="cursor: pointer; font-weight: bold;">${fullName}</label>

                    </div>

                `;

            });



            container.innerHTML = html;

        }



        // Fonction pour confirmer la s%lection des enfants

        function confirmChildrenSelection(sectionId) {

            const checkboxes = document.querySelectorAll(`#children-checkboxes-${sectionId} input[type="checkbox"]:checked`);

            const selectedChildren = Array.from(checkboxes).map(cb => cb.value);



            if (selectedChildren.length === 0) {

                alert(' Veuillez s%lectionner au moins un enfant !');

                return;

            }



            // R%cup%rer les donn%es de la voiture

            const carData = JSON.parse(localStorage.getItem(`car-${sectionId}`) || '{}');



            // Cr%er les covoiturages pour chaque enfant s%lectionn%

            selectedChildren.forEach(childName => {

                const carpoolData = {

                    ...carData,

                    childName: childName,

                    id: Date.now() + Math.random()

                };



                // Sauvegarder le covoiturage

                const existingCarpools = JSON.parse(localStorage.getItem(`carpools-${sectionId}`) || '[]');

                existingCarpools.push(carpoolData);

                localStorage.setItem(`carpools-${sectionId}`, JSON.stringify(existingCarpools));

            });



            // Afficher confirmation

            alert(` Covoiturage cr%% pour ${selectedChildren.length} enfant${selectedChildren.length > 1 ? 's' : ''} !\n\nMerci de votre participation %cologique ! %`);



            // Recharger les listes

            loadCarpoolListForSection(sectionId);

            loadChildrenWithoutCar(sectionId);



            // R%initialiser le formulaire

            document.getElementById(`carForm-${sectionId}`).reset();

            document.getElementById(`children-selection-${sectionId}`).style.display = 'none';

            document.getElementById(`carForm-${sectionId}`).parentElement.style.display = 'block';

        }



        // Fonction pour charger les voitures disponibles

        function loadAvailableCars(sectionId) {

            const allerContainer = document.getElementById(`carpoolList-${sectionId}-aller`);

            const retourContainer = document.getElementById(`carpoolList-${sectionId}-retour`);



            if (!allerContainer || !retourContainer) return;



            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');



            // Afficher les voitures pour l'aller

            let allerHtml = '';

            availableCars.forEach(car => {

                const remainingChildSeats = car.childSeats - car.children.length;

                const remainingAdultSeats = car.adultSeats;

                const status = remainingChildSeats <= 0 ? 'COMPLET' : 'DISPONIBLE';

                const statusColor = remainingChildSeats <= 0 ? '#F44336' : '#4CAF50';



                allerHtml += `

                    <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">

                            <strong> ${car.parentName}</strong>

                            <span style="background: ${statusColor}; color: white; padding: 0.25rem 0.5rem; border-radius: var(--r-sm); font-size: 0.8rem; font-weight: bold;">

                                ${status}

                            </span>

                        </div>

                        <div style="font-size: 0.9rem; color: var(--c-forest-700); margin-bottom: 0.5rem;">

                            % ${car.parentPhone}

                        </div>

                        <div style="font-size: 0.9rem; color: var(--c-forest-700); margin-bottom: 0.5rem;">

                             Places enfants: ${remainingChildSeats}/${car.childSeats} |  Places adultes: ${remainingAdultSeats}/${car.adultSeats}

                        </div>

                        <div style="font-size: 0.9rem; color: var(--c-forest-700); margin-bottom: 0.5rem;">

                             ${car.departurePoint}  ${car.arrivalPoint}

                        </div>

                        ${car.comments ? `<div style="font-size: 0.8rem; color: var(--c-ink-700); font-style: italic;"> ${car.comments}</div>` : ''}

                        <div style="margin-top: 0.5rem;">

                            <button class="fey-btn" onclick="addChildToCar('${sectionId}', '${car.id}', 'aller')" style="background: #4CAF50; font-size: 0.8rem; padding: 0.25rem 0.5rem;" ${remainingChildSeats <= 0 ? 'disabled' : ''}>

                                 Ajouter Enfant

                            </button>

                        </div>

                    </div>

                `;

            });



            allerContainer.innerHTML = allerHtml;

            retourContainer.innerHTML = allerHtml; // M%me affichage pour le retour

        }



        // Fonction pour charger la liste des enfants sans voiture

        function loadChildrenWithoutCar(sectionId, direction) {

            const container = document.getElementById(`children-list-${sectionId}-${direction}`);

            if (!container) return;



            // R%cup%rer toutes les voitures disponibles

            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');

            const childrenWithCar = [];



            availableCars.forEach(car => {

                car.children.forEach(child => {

                    childrenWithCar.push(child);

                });

            });



            // Filtrer les enfants sans voiture

            const childrenWithoutCar = scoutChildren.filter(child => {

                const fullName = `${child.nom} ${child.prenom}`;

                return !childrenWithCar.includes(fullName);

            });



            if (childrenWithoutCar.length === 0) {

                container.innerHTML = `

                    <div style="text-align: center; color: #4CAF50; font-weight: bold; padding: 1rem;">

                         Tous les enfants ont un covoiturage !

                    </div>

                `;

                return;

            }



            let html = '';

            childrenWithoutCar.forEach(child => {

                const fullName = `${child.nom} ${child.prenom}`;

                html += `

                    <div style="background: linear-gradient(135deg, #FFE0E0, #FFB3B3); border: 2px solid #F44336; border-radius: var(--r-sm); padding: 0.5rem; text-align: center; font-weight: bold; color: #D32F2F;">

                         ${fullName}

                    </div>

                `;

            });



            container.innerHTML = html;

        }



        // Fonction pour afficher les onglets du dashboard

        function showDashboardTab(sectionId, direction) {

            // Masquer toutes les sections

            document.querySelectorAll(`#children-without-car-${sectionId}-aller, #children-without-car-${sectionId}-retour`).forEach(section => {

                section.style.display = 'none';

            });



            // Afficher la section s%lectionn%e

            document.getElementById(`children-without-car-${sectionId}-${direction}`).style.display = 'block';



            // Mettre % jour les onglets actifs

            document.querySelectorAll(`.dashboard-tab`).forEach(tab => {

                tab.classList.remove('active');

            });

            event.target.classList.add('active');

        }



        // Fonction pour ajouter un enfant % une voiture

        function addChildToCar(sectionId, carId, direction) {

            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');

            const car = availableCars.find(c => c.id == carId);



            if (!car) return;



            if (car.children.length >= car.childSeats) {

                alert(' Cette voiture est compl%te !');

                return;

            }



            // Cr%er une liste des enfants disponibles

            const availableChildren = scoutChildren.filter(child => {

                const fullName = `${child.nom} ${child.prenom}`;

                return !car.children.includes(fullName);

            });



            if (availableChildren.length === 0) {

                alert(' Aucun enfant disponible !');

                return;

            }



            // Cr%er une modal pour la s%lection

            showChildSelectionModal(sectionId, carId, direction, availableChildren, car);

        }



        // Fonction pour afficher la modal de s%lection d'enfants

        function showChildSelectionModal(sectionId, carId, direction, availableChildren, car) {

            // Cr%er la modal

            const modal = document.createElement('div');

            modal.id = 'childSelectionModal';

            modal.style.cssText = `

                position: fixed;

                top: 0;

                left: 0;

                width: 100%;

                height: 100%;

                background: rgba(0, 0, 0, 0.5);

                z-index: 1000;

                display: flex;

                justify-content: center;

                align-items: center;

            `;



            modal.innerHTML = `

                <div style="

                    background: white;

                    border-radius: var(--r-md);

                    padding: 2rem;

                    max-width: 500px;

                    width: 90%;

                    max-height: 80vh;

                    overflow-y: auto;

                    border: 3px solid var(--c-ink-900);

                ">

                    <div style="text-align: center; margin-bottom: 1.5rem;">

                        <h3 style="color: var(--c-forest-700); margin: 0;"> Ajouter des Enfants</h3>

                        <p style="color: var(--c-ink-700); margin: 0.5rem 0;">Voiture de <strong>${car.parentName}</strong></p>

                        <p style="color: var(--c-ink-700); margin: 0; font-size: 0.9rem;">Places disponibles: ${car.childSeats - car.children.length}/${car.childSeats}</p>

                    </div>



                    <div id="childrenCheckboxes" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem; margin-bottom: 1.5rem;">

                        ${availableChildren.map(child => {

                            const fullName = `${child.nom} ${child.prenom}`;

                            return `

                                <div style="

                                    display: flex;

                                    align-items: center;

                                    gap: 0.5rem;

                                    padding: 0.75rem;

                                    border: 2px solid var(--c-ink-900);

                                    border-radius: var(--r-sm);

                                    background: rgba(255, 255, 255, 0.8);

                                    cursor: pointer;

                                    transition: all 0.2s;

                                " onclick="toggleChildCheckbox('${fullName}')">

                                    <input type="checkbox" id="child-${fullName.replace(/\s+/g, '-')}" value="${fullName}" style="transform: scale(1.3);">

                                    <label for="child-${fullName.replace(/\s+/g, '-')}" style="cursor: pointer; font-weight: bold; color: var(--c-forest-700);">

                                        ${fullName}

                                    </label>

                                </div>

                            `;

                        }).join('')}

                    </div>



                    <div style="display: flex; gap: 1rem; justify-content: center;">

                        <button onclick="confirmChildSelection('${sectionId}', '${carId}', '${direction}')" class="fey-btn" style="background: #4CAF50; padding: 0.75rem 1.5rem;">

                             Confirmer

                        </button>

                        <button onclick="closeChildSelectionModal()" class="fey-btn" style="background: #F44336; padding: 0.75rem 1.5rem;">

                             Annuler

                        </button>

                    </div>

                </div>

            `;



            document.body.appendChild(modal);

        }



        // Fonction pour basculer la case % cocher

        function toggleChildCheckbox(childName) {

            const checkbox = document.getElementById(`child-${childName.replace(/\s+/g, '-')}`);

            checkbox.checked = !checkbox.checked;

        }



        // Fonction pour confirmer la s%lection

        function confirmChildSelection(sectionId, carId, direction) {

            const checkboxes = document.querySelectorAll('#childSelectionModal input[type="checkbox"]:checked');

            const selectedChildren = Array.from(checkboxes).map(cb => cb.value);



            if (selectedChildren.length === 0) {

                alert(' Veuillez s%lectionner au moins un enfant !');

                return;

            }



            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');

            const car = availableCars.find(c => c.id == carId);



            if (car.children.length + selectedChildren.length > car.childSeats) {

                alert(' Trop d\'enfants s%lectionn%s ! V%rifiez les places disponibles.');

                return;

            }



            // Ajouter les enfants s%lectionn%s

            selectedChildren.forEach(childName => {

                car.children.push(childName);

            });



            localStorage.setItem(`available-cars-${sectionId}`, JSON.stringify(availableCars));



            alert(` ${selectedChildren.length} enfant${selectedChildren.length > 1 ? 's' : ''} ajout%${selectedChildren.length > 1 ? 's' : ''} % la voiture de ${car.parentName} !`);



            // Fermer la modal

            closeChildSelectionModal();



            // Recharger les listes

            loadAvailableCars(sectionId);

            loadChildrenWithoutCar(sectionId, 'aller');

            loadChildrenWithoutCar(sectionId, 'retour');

        }



        // Fonction pour fermer la modal

        function closeChildSelectionModal() {

            const modal = document.getElementById('childSelectionModal');

            if (modal) {

                modal.remove();

            }

        }



        // Fonctions pour la gestion des sorties en mode admin

        function showCreateTripModal() {

            document.getElementById('createTripModal').style.display = 'block';

        }



        function hideCreateTripModal() {

            document.getElementById('createTripModal').style.display = 'none';

        }



        // Gestion du formulaire de cr%ation de sortie

        document.addEventListener('DOMContentLoaded', function() {

            const createTripForm = document.getElementById('createTripForm');

            if (createTripForm) {

                createTripForm.addEventListener('submit', function(e) {

                    e.preventDefault();



                    const formData = new FormData(createTripForm);

                    const tripData = {

                        name: formData.get('tripName'),

                        startDate: formData.get('startDate'),

                        endDate: formData.get('endDate'),

                        departurePoint: formData.get('departurePoint'),

                        arrivalPoint: formData.get('arrivalPoint'),

                        departureTime: formData.get('departureTime'),

                        returnTime: formData.get('returnTime'),

                        description: formData.get('description'),

                        id: Date.now()

                    };



                    // Sauvegarder la sortie

                    const existingTrips = JSON.parse(localStorage.getItem('admin-trips') || '[]');

                    existingTrips.push(tripData);

                    localStorage.setItem('admin-trips', JSON.stringify(existingTrips));



                    alert(' Sortie cr%%e avec succ%s !');

                    hideCreateTripModal();

                    createTripForm.reset();

                });

            }



            // G%rer les formulaires de voiture

            const carForms = document.querySelectorAll('[id^="carForm-"]');

            carForms.forEach(form => {

                form.addEventListener('submit', function(e) {

                    e.preventDefault();

                    const sectionId = form.id.replace('carForm-', '');

                    createCar(sectionId);

                });

            });



            // Charger les enfants sans voiture pour toutes les sections

            loadChildrenWithoutCar('weekend-groupe');

        });



        // Fonction pour activer le mode admin - sera red%finie plus tard



        // V%rifier si l'utilisateur est admin (mot de passe sp%cial)

        function checkAdminAccess() {

            const password = document.getElementById('passwordInput').value;

            if (password === 'Scout2025!') {

                if (typeof enableAdminMode === 'function') {

                    enableAdminMode();

                }

                return true;

            }

            return false;

        }



        // Fonctions pour g%rer les notes admin

        function saveAdminNotes() {

            const notes = document.getElementById('adminNotes').value;

            if (notes.trim()) {

                localStorage.setItem('adminNotes', notes);

                showNotification('Notes sauvegard%es avec succ%s !', 'success');

                updateMainPageNotes();

            } else {

                showNotification('Veuillez saisir des notes avant de sauvegarder.', 'warning');

            }

        }



        function clearAdminNotes() {

            if (confirm('%tes-vous s%W%r de vouloir effacer toutes les notes ?')) {

                document.getElementById('adminNotes').value = '';

                localStorage.removeItem('adminNotes');

                showNotification('Notes effac%es !', 'info');

                updateMainPageNotes();

            }

        }



        function previewAdminNotes() {

            const notes = document.getElementById('adminNotes').value;

            const preview = document.getElementById('adminNotesPreview');

            const content = document.getElementById('previewContent');

            

            if (notes.trim()) {

                content.innerHTML = notes.replace(/\n/g, '<br>');

                preview.style.display = 'block';

            } else {

                preview.style.display = 'none';

            }

        }



        function loadAdminNotes() {

            const notes = localStorage.getItem('adminNotes');

            if (notes) {

                document.getElementById('adminNotes').value = notes;

            }

        }



        function updateMainPageNotes() {

            const notes = localStorage.getItem('adminNotes');

            const notesContainer = document.getElementById('adminNotesDisplay');

            

            if (notes && notes.trim()) {

                if (!notesContainer) {

                    // Cr%er le conteneur de notes s'il n'existe pas

                    const messageCard = document.querySelector('.fey-card:has(.fey-card-header:contains("Message pour les Parents"))');

                    if (messageCard) {

                        const notesContainer = document.createElement('div');

                        notesContainer.id = 'adminNotesDisplay';

                        notesContainer.className = 'fey-card';

                        notesContainer.style.cssText = 'background: linear-gradient(135deg, #FFF8E1, #FFECB3); border-left: 6px solid #FFC107; margin-bottom: 2rem;';

                        notesContainer.innerHTML = `

                            <div class="fey-card-header"> Message de l'Administrateur</div>

                            <div class="fey-note" style="background: transparent; border: none; margin: 0;">

                                <div id="adminNotesContent"></div>

                            </div>

                        `;

                        messageCard.parentNode.insertBefore(notesContainer, messageCard.nextSibling);

                    }

                }

                

                const content = document.getElementById('adminNotesContent');

                if (content) {

                    content.innerHTML = notes.replace(/\n/g, '<br>');

                }

            } else if (notesContainer) {

                notesContainer.remove();

            }

        }



        function showNotification(message, type = 'info') {

            // Cr%er une notification temporaire

            const notification = document.createElement('div');

            notification.style.cssText = `

                position: fixed;

                top: 20px;

                right: 20px;

                padding: 1rem 2rem;

                border-radius: var(--r-sm);

                color: white;

                font-weight: bold;

                z-index: 10000;

                animation: slideIn 0.3s ease-out;

                max-width: 300px;

            `;

            

            const colors = {

                success: '#4CAF50',

                warning: '#FF9800',

                error: '#f44336',

                info: '#2196F3'

            };

            

            notification.style.backgroundColor = colors[type] || colors.info;

            notification.textContent = message;

            

            document.body.appendChild(notification);

            

            setTimeout(() => {

                notification.style.animation = 'slideOut 0.3s ease-in';

                setTimeout(() => notification.remove(), 300);

            }, 3000);

        }



        // Gestionnaire d'%v%nement supprim% - la fonction authenticate() g%re maintenant tout



        // Fonctions de personnalisation

        function applyCustomization() {

            // R%cup%rer les nouvelles couleurs

            const orangeColor = document.getElementById('colorOrange').value;

            const forestColor = document.getElementById('colorForest').value;

            const goldColor = document.getElementById('colorGold').value;

            const marineColor = document.getElementById('colorMarine').value;

            

            // R%cup%rer les nouveaux textes

            const mainTitle = document.getElementById('mainTitle').value;

            const subtitle = document.getElementById('subtitle').value;

            

            // Appliquer les couleurs via CSS custom properties

            document.documentElement.style.setProperty('--c-orange-600', orangeColor);

            document.documentElement.style.setProperty('--c-forest-700', forestColor);

            document.documentElement.style.setProperty('--c-gold-400', goldColor);

            document.documentElement.style.setProperty('--c-marine-900', marineColor);

            

            // Appliquer les textes

            const titleElement = document.querySelector('.fey-title');

            const subtitleElement = document.querySelector('.fey-subtitle');

            

            if (titleElement) titleElement.textContent = mainTitle;

            if (subtitleElement) subtitleElement.textContent = subtitle;

            

            // Sauvegarder les pr%f%rences

            const customization = {

                colors: {

                    orange: orangeColor,

                    forest: forestColor,

                    gold: goldColor,

                    marine: marineColor

                },

                texts: {

                    mainTitle: mainTitle,

                    subtitle: subtitle

                }

            };

            

            localStorage.setItem('admin-customization', JSON.stringify(customization));

            

            alert(' Personnalisation appliqu%e avec succ%s !');

        }

        

        function resetCustomization() {

            // R%initialiser aux valeurs par d%faut

            document.getElementById('colorOrange').value = '#F77F00';

            document.getElementById('colorForest').value = '#2E7D32';

            document.getElementById('colorGold').value = '#FFD166';

            document.getElementById('colorMarine').value = '#1B1F3B';

            document.getElementById('mainTitle').value = 'Mon carnet d\'aventure';

            document.getElementById('subtitle').value = 'Prochaine sortie % Jambville ,% Octobre 2025';

            

            // Supprimer la personnalisation sauvegard%e

            localStorage.removeItem('admin-customization');

            

            // R%appliquer les valeurs par d%faut

            document.documentElement.style.setProperty('--c-orange-600', '#F77F00');

            document.documentElement.style.setProperty('--c-forest-700', '#2E7D32');

            document.documentElement.style.setProperty('--c-gold-400', '#FFD166');

            document.documentElement.style.setProperty('--c-marine-900', '#1B1F3B');

            

            const titleElement = document.querySelector('.fey-title');

            const subtitleElement = document.querySelector('.fey-subtitle');

            

            if (titleElement) titleElement.textContent = 'Mon carnet d\'aventure';

            if (subtitleElement) subtitleElement.textContent = 'Prochaine sortie % Jambville ,% Octobre 2025';

            

            alert(' Personnalisation r%initialis%e !');

        }

        

        // Charger la personnalisation au d%marrage

        function loadCustomization() {

            const customization = JSON.parse(localStorage.getItem('admin-customization') || '{}');

            

            if (customization.colors) {

                document.documentElement.style.setProperty('--c-orange-600', customization.colors.orange);

                document.documentElement.style.setProperty('--c-forest-700', customization.colors.forest);

                document.documentElement.style.setProperty('--c-gold-400', customization.colors.gold);

                document.documentElement.style.setProperty('--c-marine-900', customization.colors.marine);

            }

            

            if (customization.texts) {

                const titleElement = document.querySelector('.fey-title');

                const subtitleElement = document.querySelector('.fey-subtitle');

                

                if (titleElement) titleElement.textContent = customization.texts.mainTitle;

                if (subtitleElement) subtitleElement.textContent = customization.texts.subtitle;

            }

        }

        

        // Appeler la fonction au chargement

        document.addEventListener('DOMContentLoaded', loadCustomization);

        

        // Fonctions pour les listes d%roulantes

        function toggleCategory(categoryId) {

            const content = document.getElementById(categoryId + '-content');

            const arrow = document.getElementById(categoryId + '-arrow');

            

            if (content.style.display === 'none') {

                content.style.display = 'block';

                arrow.textContent = ']%';

            } else {

                content.style.display = 'none';

                arrow.textContent = '';

            }

        }

        

        // Fonction pour d%marrer le jeu de sac scout

        function startScoutBagGame() {

            // Cr%er une modal pour le jeu

            const modal = document.createElement('div');

            modal.id = 'scoutBagGameModal';

            modal.style.cssText = `

                position: fixed;

                top: 0;

                left: 0;

                width: 100%;

                height: 100%;

                background: rgba(0, 0, 0, 0.8);

                z-index: 1000;

                display: flex;

                justify-content: center;

                align-items: center;

                overflow-y: auto;

            `;



            modal.innerHTML = `

                <div style="

                    background: var(--parchment);

                    border-radius: 24px;

                    padding: 2rem;

                    max-width: 1200px;

                    width: 95%;

                    max-height: 90vh;

                    overflow-y: auto;

                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);

                    border: 4px solid var(--wood);

                    position: relative;

                ">

                    <button onclick="closeScoutBagGame()" style="

                        position: absolute;

                        top: 1rem;

                        right: 1rem;

                        background: #F44336;

                        color: white;

                        border: none;

                        border-radius: 50%;

                        width: 40px;

                        height: 40px;

                        font-size: 1.2rem;

                        cursor: pointer;

                        z-index: 10;

                    "></button>

                    

                    <div class="scout-bag-game" id="scoutBagGameContent">

                        <!-- Le contenu du jeu sera charg% ici -->

                    </div>

                </div>

            `;



            document.body.appendChild(modal);

            

            // Charger le contenu du jeu

            loadScoutBagGameContent();

        }

        

        function closeScoutBagGame() {

            const modal = document.getElementById('scoutBagGameModal');

            if (modal) {

                modal.remove();

            }

        }

        

        function loadScoutBagGameContent() {

            const gameContent = document.getElementById('scoutBagGameContent');

            

            gameContent.innerHTML = `

                <div style="text-align: center; margin-bottom: 2rem;">

                    <h1 style="font-family: 'Patrick Hand', cursive; color: var(--forest); font-size: 2.5rem; margin-bottom: 1rem;">

                         Pr%pare ton Sac de Scout ! 

                    </h1>

                    <p style="color: var(--ink); font-size: 1.2rem; margin-bottom: 2rem;">

                        Glisse les objets dans le sac dans le bon ordre pour %tre pr%t pour l'aventure !

                    </p>

                </div>



                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">

                    <!-- Zone des objets % ranger -->

                    <div style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-radius: 16px; padding: 1.5rem; border: 3px solid var(--forest);">

                        <h3 style="color: var(--forest); margin-bottom: 1rem; text-align: center;"> Objets % Ranger</h3>

                        <div id="items-to-pack" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem;">

                            <!-- Les objets seront g%n%r%s dynamiquement -->

                        </div>

                    </div>



                    <!-- Zone du sac -->

                    <div style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-radius: 16px; padding: 1.5rem; border: 3px solid var(--orange);">

                        <h3 style="color: var(--orange); margin-bottom: 1rem; text-align: center;"> Ton Sac</h3>

                        <div id="scout-bag" style="

                            min-height: 300px;

                            border: 3px dashed var(--orange);

                            border-radius: 12px;

                            padding: 1rem;

                            background: rgba(255, 255, 255, 0.5);

                        ">

                            <p style="text-align: center; color: var(--orange); font-style: italic;">

                                Glisse les objets ici dans le bon ordre !

                            </p>

                        </div>

                    </div>

                </div>



                <div style="text-align: center; margin-bottom: 2rem;">

                    <div style="background: linear-gradient(135deg, var(--forest), #4CAF50); color: white; padding: 1rem; border-radius: 12px; display: inline-block;">

                        <strong>Score: </strong><span id="game-score">0</span> / <span id="max-score">0</span>

                    </div>

                </div>



                <div style="text-align: center;">

                    <button onclick="resetScoutBagGame()" class="fey-btn" style="background: #FF9800; margin-right: 1rem;">

                         Recommencer

                    </button>

                    <button onclick="checkScoutBagGame()" class="fey-btn" style="background: #4CAF50;">

                         V%rifier

                    </button>

                </div>

            `;

            

            // Initialiser le jeu

            initScoutBagGame();

        }

        

        // Variables du jeu

        let gameItems = [];

        let bagItems = [];

        let gameScore = 0;

        let maxScore = 0;

        

        function initScoutBagGame() {

            // D%finir les objets du jeu avec leur ordre correct

            gameItems = [

                { id: 1, name: ' Chaussettes', emoji: '', order: 1 },

                { id: 2, name: ' T-shirt', emoji: '', order: 2 },

                { id: 3, name: ' Pantalon', emoji: '', order: 3 },

                { id: 4, name: ' Pull', emoji: '', order: 4 },

                { id: 5, name: ' Gants', emoji: '', order: 5 },

                { id: 6, name: ' Casquette', emoji: '', order: 6 },

                { id: 7, name: ' Chaussures', emoji: '', order: 7 },

                { id: 8, name: ' Sac % dos', emoji: '', order: 8 }

            ];

            

            maxScore = gameItems.length;

            bagItems = [];

            gameScore = 0;

            

            // M%langer les objets

            const shuffledItems = [...gameItems].sort(() => Math.random() - 0.5);

            

            // Afficher les objets

            const itemsContainer = document.getElementById('items-to-pack');

            itemsContainer.innerHTML = '';

            

            shuffledItems.forEach(item => {

                const itemElement = document.createElement('div');

                itemElement.className = 'game-item';

                itemElement.draggable = true;

                itemElement.dataset.itemId = item.id;

                itemElement.style.cssText = `

                    background: linear-gradient(135deg, var(--orange), var(--gold));

                    color: white;

                    padding: 1rem;

                    border-radius: 12px;

                    text-align: center;

                    cursor: move;

                    border: 3px solid var(--ink);

                    font-weight: bold;

                    transition: all 0.3s ease;

                    user-select: none;

                `;

                itemElement.innerHTML = `

                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">${item.emoji}</div>

                    <div style="font-size: 0.9rem;">${item.name}</div>

                `;

                

                // %v%nements de drag

                itemElement.addEventListener('dragstart', handleDragStart);

                itemElement.addEventListener('dragend', handleDragEnd);

                

                itemsContainer.appendChild(itemElement);

            });

            

            // Configurer la zone de d%p%$%t

            const bagContainer = document.getElementById('scout-bag');

            bagContainer.addEventListener('dragover', handleDragOver);

            bagContainer.addEventListener('drop', handleDrop);

            bagContainer.addEventListener('dragenter', handleDragEnter);

            bagContainer.addEventListener('dragleave', handleDragLeave);

            

            updateGameScore();

        }

        

        function handleDragStart(e) {

            e.dataTransfer.setData('text/plain', e.target.dataset.itemId);

            e.target.style.opacity = '0.5';

        }

        

        function handleDragEnd(e) {

            e.target.style.opacity = '1';

        }

        

        function handleDragOver(e) {

            e.preventDefault();

        }

        

        function handleDragEnter(e) {

            e.preventDefault();

            e.target.style.background = 'rgba(76, 175, 80, 0.3)';

        }

        

        function handleDragLeave(e) {

            e.target.style.background = 'rgba(255, 255, 255, 0.5)';

        }

        

        function handleDrop(e) {

            e.preventDefault();

            e.target.style.background = 'rgba(255, 255, 255, 0.5)';

            

            const itemId = parseInt(e.dataTransfer.getData('text/plain'));

            const item = gameItems.find(i => i.id === itemId);

            

            if (item && !bagItems.find(bi => bi.id === itemId)) {

                bagItems.push(item);

                

                // Cr%er l'%l%ment dans le sac

                const bagElement = document.createElement('div');

                bagElement.className = 'bag-item';

                bagElement.dataset.itemId = itemId;

                bagElement.style.cssText = `

                    background: linear-gradient(135deg, #4CAF50, #66BB6A);

                    color: white;

                    padding: 0.75rem;

                    border-radius: 8px;

                    text-align: center;

                    margin: 0.5rem;

                    display: inline-block;

                    border: 2px solid var(--ink);

                    font-weight: bold;

                    transition: all 0.3s ease;

                `;

                bagElement.innerHTML = `

                    <div style="font-size: 1.5rem;">${item.emoji}</div>

                    <div style="font-size: 0.8rem;">${item.name}</div>

                `;

                

                e.target.appendChild(bagElement);

                

                // Retirer l'objet de la zone source

                const sourceElement = document.querySelector(`[data-item-id="${itemId}"]`);

                if (sourceElement && sourceElement.parentElement.id === 'items-to-pack') {

                    sourceElement.remove();

                }

                

                updateGameScore();

            }

        }

        

        function updateGameScore() {

            document.getElementById('game-score').textContent = bagItems.length;

            document.getElementById('max-score').textContent = maxScore;

        }

        

        function checkScoutBagGame() {

            // V%rifier l'ordre

            let correctOrder = true;

            for (let i = 0; i < bagItems.length; i++) {

                if (bagItems[i].order !== i + 1) {

                    correctOrder = false;

                    break;

                }

            }

            

            if (correctOrder && bagItems.length === maxScore) {

                alert(' Bravo ! Tu as parfaitement rang% ton sac ! Tu es pr%t pour l\'aventure ! ');

            } else if (bagItems.length === maxScore) {

                alert(' Presque ! L\'ordre n\'est pas tout % fait correct. Essaie de nouveau !');

            } else {

                alert(' Il manque encore des objets dans ton sac !');

            }

        }

        

        function resetScoutBagGame() {

            // Vider le sac

            bagItems = [];

            document.getElementById('scout-bag').innerHTML = '<p style="text-align: center; color: var(--orange); font-style: italic;">Glisse les objets ici dans le bon ordre !</p>';

            

            // R%initialiser le jeu

            initScoutBagGame();

        }

        

        // Fonctions de gestion des sorties

        function showCreateOutingModal() {

            const modal = document.createElement('div');

            modal.id = 'createOutingModal';

            modal.style.cssText = `

                position: fixed;

                top: 0;

                left: 0;

                width: 100%;

                height: 100%;

                background: rgba(0, 0, 0, 0.5);

                z-index: 1000;

                display: flex;

                justify-content: center;

                align-items: center;

            `;



            modal.innerHTML = `

                <div style="

                    background: white;

                    border-radius: var(--r-md);

                    padding: 2rem;

                    max-width: 600px;

                    width: 90%;

                    max-height: 80vh;

                    overflow-y: auto;

                    border: 3px solid var(--c-ink-900);

                ">

                    <div class="fey-card-header"> Cr%er une Nouvelle Sortie</div>

                    <form id="createOutingForm" style="display: flex; flex-direction: column; gap: 1rem;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom de la Sortie</label>

                                <input type="text" name="outingName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Date</label>

                                <input type="date" name="outingDate" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Lieu</label>

                                <input type="text" name="outingLocation" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure D%part</label>

                                <input type="time" name="departureTime" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure Retour</label>

                            <input type="time" name="returnTime" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Description</label>

                            <textarea name="description" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 80px; resize: vertical;"></textarea>

                        </div>



                        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">

                            <button type="submit" class="fey-btn" style="background: #4CAF50; padding: 0.75rem 1.5rem;">

                                 Cr%er la Sortie

                            </button>

                            <button type="button" onclick="closeCreateOutingModal()" class="fey-btn" style="background: #F44336; padding: 0.75rem 1.5rem;">

                                 Annuler

                            </button>

                        </div>

                    </form>

                </div>

            `;



            document.body.appendChild(modal);



            // G%rer la soumission du formulaire

            document.getElementById('createOutingForm').addEventListener('submit', function(e) {

                e.preventDefault();

                

                const formData = new FormData(this);

                const outingData = {

                    name: formData.get('outingName'),

                    date: formData.get('outingDate'),

                    location: formData.get('outingLocation'),

                    departureTime: formData.get('departureTime'),

                    returnTime: formData.get('returnTime'),

                    description: formData.get('description'),

                    id: Date.now()

                };



                // Sauvegarder la sortie

                const existingOutings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

                existingOutings.push(outingData);

                localStorage.setItem('admin-outings', JSON.stringify(existingOutings));



                alert(' Sortie cr%%e avec succ%s !');

                closeCreateOutingModal();

                loadOutings(); // Recharger la liste

            });

        }

        

        function closeCreateOutingModal() {

            const modal = document.getElementById('createOutingModal');

            if (modal) {

                modal.remove();

            }

        }

        

        function loadOutings() {

            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            const container = document.getElementById('outings-list');

            

            if (outings.length === 0) {

                container.innerHTML = '<p style="text-align: center; color: #666;">Aucune sortie programm%e</p>';

                return;

            }

            

            let html = '<h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;"> Sorties Programm%es</h3>';

            

            outings.forEach(outing => {

                html += `

                    <div class="fey-item" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50; margin-bottom: 1rem;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; align-items: center;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom de la Sortie</label>

                                <input type="text" value="${outing.name}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Date</label>

                                <input type="date" value="${outing.date}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Lieu</label>

                                <input type="text" value="${outing.location}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure D%part</label>

                                <input type="time" value="${outing.departureTime}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure Retour</label>

                                <input type="time" value="${outing.returnTime}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="margin-top: 1rem;">

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Description</label>

                            <textarea style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 60px; resize: vertical;">${outing.description}</textarea>

                        </div>

                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">

                            <button class="fey-btn" onclick="saveOuting(${outing.id})" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;"> Sauvegarder</button>

                            <button class="fey-btn" onclick="deleteOuting(${outing.id})" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;"> Supprimer</button>

                        </div>

                    </div>

                `;

            });

            

            container.innerHTML = html;

        }

        

        function saveOuting(outingId) {

            // Logique pour sauvegarder les modifications

            alert(' Sortie sauvegard%e !');

        }

        

        function deleteOuting(outingId) {

            if (confirm('%tes-vous s%W%r de vouloir supprimer cette sortie ?')) {

                const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

                const updatedOutings = outings.filter(outing => outing.id !== outingId);

                localStorage.setItem('admin-outings', JSON.stringify(updatedOutings));

                loadOutings();

                alert(' Sortie supprim%e !');

            }

            

            console.log(' %v%nements r%cup%r%s:', Object.keys(events).length);

            console.log(' D%tails des %v%nements:', events);

            

            return events;

        }



        // Fonction pour obtenir les %v%nements par d%faut du programme 2025-2026

        function getDefaultCalendarEvents() {

            return {

                // Septembre 2025

                '28-9-2025': {

                    title: ' R%union parents',

                    time: 'Dimanche',

                    description: 'R%union d\'information pour les parents'

                },



                // Octobre 2025

                '3-10-2025': {

                    title: ' Weekend de Groupe',

                    time: 'Vendredi - D%part',

                    description: 'Weekend de groupe avec activit%s scoutes'

                },

                '4-10-2025': {

                    title: ' Weekend de Groupe',

                    time: 'Samedi - Retour',

                    description: 'Weekend de groupe avec activit%s scoutes'

                },

                '12-10-2025': {

                    title: ' Sortie voile',

                    time: 'Dimanche',

                    description: 'Sortie voile % Verneuil sur Seine'

                },



                // Novembre 2025

                '15-11-2025': {

                    title: ' Weekend Abbaye d\'Epernon',

                    time: 'Samedi - D%part',

                    description: 'Weekend au Prieur% Saint Thomas'

                },

                '16-11-2025': {

                    title: ' Weekend Abbaye d\'Epernon',

                    time: 'Dimanche - Retour',

                    description: 'Weekend au Prieur% Saint Thomas'

                },



                // D%cembre 2025

                '14-12-2025': {

                    title: ' Lumi%re de Bethl%em',

                    time: 'Dimanche',

                    description: 'Lumi%re de Bethl%em + Cr%che vivante'

                },



                // Janvier 2026

                '18-1-2026': {

                    title: ' Sortie Mus%e de la Marine',

                    time: 'Dimanche',

                    description: 'Sortie Mus%e de la Marine + galettes'

                },



                // F%vrier 2026

                '8-2-2026': {

                    title: ']% Sortie Montmartre',

                    time: 'Dimanche',

                    description: 'D%couverte de Montmartre et du Sacr%-C<%ur'

                },



                // Mars 2026

                '14-3-2026': {

                    title: ' Weekend de mars',

                    time: 'Samedi - D%part',

                    description: 'Weekend de printemps avec activit%s nature'

                },

                '15-3-2026': {

                    title: ' Weekend de mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps avec activit%s nature'

                },



                // Avril 2026

                '12-4-2026': {

                    title: '% Sortie ch%teau',

                    time: 'Dimanche',

                    description: 'Visite d\'un ch%teau historique'

                },



                // Mai 2026

                '15-5-2026': {

                    title: '% Mini-camp Mont Saint-Michel',

                    time: 'Vendredi - D%part',

                    description: 'Mini-camp au Mont Saint-Michel'

                },

                '16-5-2026': {

                    title: '% Mini-camp Mont Saint-Michel',

                    time: 'Samedi',

                    description: 'Mini-camp au Mont Saint-Michel'

                },

                '17-5-2026': {

                    title: '% Mini-camp Mont Saint-Michel',

                    time: 'Dimanche - Retour',

                    description: 'Mini-camp au Mont Saint-Michel'

                },



                // Juin 2026

                '12-6-2026': {

                    title: ' R%union pr%sentation camp',

                    time: 'Vendredi 18h-20h',

                    description: 'R%union de pr%sentation du camp d\'%t%'

                },

                '13-6-2026': {

                    title: ' Weekend de juin',

                    time: 'Samedi - D%part',

                    description: 'Weekend de fin d\'ann%e'

                },

                '14-6-2026': {

                    title: ' Weekend de juin',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de fin d\'ann%e'

                },



                // Juillet 2026

                '5-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'D%part',

                    description: 'Camp d\'%t% (premi%re quinzaine des vacances Zone C)'

                },

                '19-7-2026': {

                    title: ' Camp d\'%t%',

                    time: 'Retour',

                    description: 'Fin du camp d\'%t% (dates exactes % confirmer)'

                }

            };

        }

        

        // Charger les sorties au d%marrage

        document.addEventListener('DOMContentLoaded', function() {

            if (document.getElementById('outings-list')) {

                loadOutings();

            }

            // Charger les sorties pour le registre d'appel

            loadOutingsForAttendance();

        });



        // ===============================

        // FONCTIONS REGISTRE D'APPEL

        // ===============================



        // Charger les sorties dans le s%lecteur du registre d'appel

        function loadOutingsForAttendance() {

            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            const select = document.getElementById('selectedOuting');

            

            if (!select) return;

            

            // Vider le s%lecteur

            select.innerHTML = '<option value="">-- S%lectionnez une sortie --</option>';

            

            // Ajouter chaque sortie

            outings.forEach(outing => {

                const option = document.createElement('option');

                option.value = outing.id;

                option.textContent = `${outing.name} - ${new Date(outing.startDate).toLocaleDateString('fr-FR')}`;

                select.appendChild(option);

            });

        }



        // Charger le registre d'appel pour une sortie s%lectionn%e

        function loadAttendanceForOuting(tripId) {

            if (!tripId) {

                document.getElementById('outingInfo').style.display = 'none';

                document.getElementById('participantsList').style.display = 'none';

                return;

            }



            // R%cup%rer les d%tails de la sortie depuis le calendrier

            const events = getCalendarEvents();

            const dateKey = tripId.replace(/_/g, '-');

            const event = events[dateKey];

            

            if (!event) {

                console.error('Sortie non trouv%e:', tripId);

                return;

            }



            // Afficher les informations de la sortie

displayOutingInfo(event, dateKey);

            

            // Cr%er la liste d'appel

            createAttendanceList(tripId, event);

            document.getElementById('outingInfo').style.display = 'block';

            document.getElementById('participantsList').style.display = 'block';

        }



        // Afficher les informations de la sortie

        function displayOutingInfo(event, dateKey) {

            const detailsContainer = document.getElementById('outingDetails');

            if (detailsContainer) {

            detailsContainer.innerHTML = `

                <div style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <strong> ${event.title}</strong><br>

                        <small>${dateKey}</small>

                </div>

                <div style="background: linear-gradient(135deg, #F3E5F5, #E1BEE7); padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <strong>% Heure</strong><br>

                        <small>${event.time || 'Non sp%cifi%e'}</small>

                </div>

                <div style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                    <strong> Description</strong><br>

                        <small>${event.description || 'Aucune description'}</small>

                </div>

            `;

            }

        }

        

        // Cr%er la liste d'appel avec les enfants

        function createAttendanceList(tripId, event) {

            const participantsList = document.getElementById('participantsList');

            if (!participantsList) return;

            

            // Liste des enfants scouts (copie directe pour %viter les probl%mes de port%e)

            const children = [

                'DESCAMPS JEANNE',

                'LAURENT BILLET CLAIRE', 

                'PICHEREAU JULES',

                'POTTER FELIX',

                'ROUSSEAU LEOPOLD',

                'JEANJEAN MADELEINE',

                'LALIGAND LEA',

                'MILLART CONSTANCE',

                'REYNAL DE SAINT MICHEL ALEXIA',

                'D\'ANDREA DANTE',

                'JANDARD LEV',

                'ROIG OCTAVE',

                'RUEF ALFRED',

                'MATHIEN AMBRE',

                'FAUGERE LEA',

                'GENTIL CONSTANCE',

                'HUCHEZ SIBYLLE',

                'LANASPRE ROMANE',

                'NIERAT ZOE',

                'SERVONNAT LOUISON',

                'WARGNIER GABRIELLE',

                'POTTER OSCAR',

                'ROIG JULES',

                'TALPAERT GABRIEL'

            ];

            

            console.log(' Enfants charg%s:', children);

            

            // R%cup%rer les pr%sences sauvegard%es

            const savedAttendance = JSON.parse(localStorage.getItem(`attendance_${tripId}`) || '{}');

            

            let attendanceHTML = `

                <div class="fey-card">

                    <div class="fey-card-header"> Liste d'Appel - ${event.title}</div>

                    <div style="margin-bottom: 1rem;">

                        <p><strong> Date :</strong> ${tripId.replace(/_/g, '-')}</p>

                        <p><strong> Nombre d'enfants :</strong> ${children.length}</p>

                    </div>

                    <div style="max-height: 400px; overflow-y: auto; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1rem;">

            `;

            

            children.forEach((child, index) => {

                const isPresent = savedAttendance[child] || false;

                attendanceHTML += `

                    <div style="display: flex; align-items: center; padding: 0.75rem; border-bottom: 1px solid #eee; background: ${isPresent ? '#e8f5e8' : '#fff'};">

                        <input type="checkbox" 

                               id="attendance_${tripId}_${index}" 

                               ${isPresent ? 'checked' : ''} 

                               onchange="updateAttendance('${tripId}', '${child}', this.checked)"

                               style="margin-right: 1rem; transform: scale(1.3);">

                        <label for="attendance_${tripId}_${index}" style="flex: 1; cursor: pointer; font-size: 1.1rem;">

                            <strong>${child}</strong>

                            <span id="status_${tripId}_${index}" style="color: ${isPresent ? '#2e7d32' : '#666'}; margin-left: 0.5rem;">

                                ${isPresent ? ' Pr%sent' : ' Absent'}

                            </span>

                        </label>

                    </div>

                `;

            });

            

            attendanceHTML += `

                    </div>

                    <div style="margin-top: 1rem; text-align: center;">

                        <button onclick="saveAttendance('${tripId}')" class="fey-btn" style="background: #4CAF50; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                             Sauvegarder l'Appel

                        </button>

                        <button onclick="exportAttendance('${tripId}')" class="fey-btn" style="background: #2196F3; padding: 0.75rem 1.5rem;">

                             Exporter

                        </button>

                    </div>

                </div>

            `;

            

            participantsList.innerHTML = attendanceHTML;

        }

        

        // Mettre % jour la pr%sence d'un enfant

        function updateAttendance(tripId, childName, isPresent) {

            const savedAttendance = JSON.parse(localStorage.getItem(`attendance_${tripId}`) || '{}');

            savedAttendance[childName] = isPresent;

            localStorage.setItem(`attendance_${tripId}`, JSON.stringify(savedAttendance));

            

            // Mettre % jour l'affichage en trouvant l'%l%ment par l'index

            const children = [

                'DESCAMPS JEANNE',

                'LAURENT BILLET CLAIRE', 

                'PICHEREAU JULES',

                'POTTER FELIX',

                'ROUSSEAU LEOPOLD',

                'JEANJEAN MADELEINE',

                'LALIGAND LEA',

                'MILLART CONSTANCE',

                'REYNAL DE SAINT MICHEL ALEXIA',

                'D\'ANDREA DANTE',

                'JANDARD LEV',

                'ROIG OCTAVE',

                'RUEF ALFRED',

                'MATHIEN AMBRE',

                'FAUGERE LEA',

                'GENTIL CONSTANCE',

                'HUCHEZ SIBYLLE',

                'LANASPRE ROMANE',

                'NIERAT ZOE',

                'SERVONNAT LOUISON',

                'WARGNIER GABRIELLE',

                'POTTER OSCAR',

                'ROIG JULES',

                'TALPAERT GABRIEL'

            ];

            const childIndex = children.indexOf(childName);

            

            if (childIndex !== -1) {

                const statusSpan = document.getElementById(`status_${tripId}_${childIndex}`);

                if (statusSpan) {

                    statusSpan.textContent = isPresent ? ' Pr%sent' : ' Absent';

                    statusSpan.style.color = isPresent ? '#2e7d32' : '#666';

                }

                

                // Changer la couleur de fond

                const container = document.getElementById(`attendance_${tripId}_${childIndex}`).closest('div');

                if (container) {

                    container.style.background = isPresent ? '#e8f5e8' : '#fff';

                }

            }

        }

        

        // Sauvegarder l'appel

        function saveAttendance(tripId) {

            const savedAttendance = JSON.parse(localStorage.getItem(`attendance_${tripId}`) || '{}');

            const presentCount = Object.values(savedAttendance).filter(present => present).length;

            const totalCount = Object.keys(savedAttendance).length;

            

            // Sauvegarder dans l'historique

            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const event = getCalendarEvents()[tripId.replace(/_/g, '-')];

            

            const record = {

                id: tripId,

                title: event.title,

                date: tripId.replace(/_/g, '-'),

                attendance: savedAttendance,

                presentCount: presentCount,

                totalCount: totalCount,

                timestamp: new Date().toISOString()

            };

            

            // Supprimer l'ancien enregistrement s'il existe

            const existingIndex = history.findIndex(h => h.id === tripId);

            if (existingIndex !== -1) {

                history[existingIndex] = record;

            } else {

                history.push(record);

            }

            

            localStorage.setItem('attendance-history', JSON.stringify(history));

            

            // Recharger l'historique pour l'afficher

            loadAttendanceHistory();

            

            alert(` Appel sauvegard% !\n Pr%sents: ${presentCount}/${totalCount}`);

        }

        

        // Exporter l'appel

        function exportAttendance(tripId) {

            const savedAttendance = JSON.parse(localStorage.getItem(`attendance_${tripId}`) || '{}');

            const event = getCalendarEvents()[tripId.replace(/_/g, '-')];

            

            let csvContent = `Appel - ${event.title} (${tripId.replace(/_/g, '-')})\n`;

            csvContent += `Nom,Pr%sent\n`;

            

            Object.entries(savedAttendance).forEach(([child, isPresent]) => {

                csvContent += `${child},${isPresent ? 'Oui' : 'Non'}\n`;

            });

            

            // Cr%er et t%l%charger le fichier

            const blob = new Blob([csvContent], { type: 'text/csv' });

            const url = window.URL.createObjectURL(blob);

            const a = document.createElement('a');

            a.href = url;

            a.download = `appel_${tripId.replace(/_/g, '-')}.csv`;

            a.click();

            window.URL.revokeObjectURL(url);

        }

        

        // Nettoyer l'historique des entr%es invalides

        function cleanAttendanceHistory() {

            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const events = getCalendarEvents();

            

            // Filtrer les entr%es valides

            const validHistory = history.filter(record => {

                const event = events[record.date];

                return event && event.title !== undefined;

            });

            

            // Mettre % jour les titres des entr%es existantes

            validHistory.forEach(record => {

                const event = events[record.date];

                if (event) {

                    record.title = event.title;

                }

            });

            

            localStorage.setItem('attendance-history', JSON.stringify(validHistory));

            loadAttendanceHistory();

            

            alert(`c% Historique nettoy% ! ${history.length - validHistory.length} entr%es invalides supprim%es.`);

        }

        

        // Supprimer tout l'historique

        function clearAllAttendanceHistory() {

            if (confirm(' %tes-vous s%W%r de vouloir supprimer TOUT l\'historique des appels ? Cette action est irr%versible.')) {

                localStorage.removeItem('attendance-history');

                loadAttendanceHistory();

                alert(' Historique compl%tement supprim% !');

            }

        }



        // Charger la liste des participants pour le registre d'appel

        function loadParticipantsForAttendance(outing) {

            // R%cup%rer les %quipes

            const lifeTeams = JSON.parse(localStorage.getItem('life-teams') || '[]');

            const nightTeams = JSON.parse(localStorage.getItem('night-teams') || '[]');



            // R%cup%rer le registre d'appel existant pour cette sortie

            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            const currentAttendance = attendanceRecords[outing.id] || {};



            let participants = [];

            

            // Ajouter les membres des %quipes de vie

            lifeTeams.forEach(team => {

                team.members.forEach(member => {

                    participants.push({

                        id: `life_${team.name}_${member}`,

                        name: member,

                        team: team.name,

                        teamType: 'life',

                        attendance: currentAttendance[`life_${team.name}_${member}`] || 'unknown'

                    });

                });

            });



            // Ajouter les membres des %quipes de nuit

            nightTeams.forEach(team => {

                team.members.forEach(member => {

                    participants.push({

                        id: `night_${team.name}_${member}`,

                        name: member,

                        team: team.name,

                        teamType: 'night',

                        attendance: currentAttendance[`night_${team.name}_${member}`] || 'unknown'

                    });

                });

            });



            // G%n%rer le tableau des participants

            generateParticipantsTable(participants);

            updateAttendanceStats(participants);

        }



        // G%n%rer le tableau des participants

        function generateParticipantsTable(participants) {

            const tableContainer = document.getElementById('participantsTable');

            

            if (participants.length === 0) {

                tableContainer.innerHTML = `

                    <div class="fey-note" style="text-align: center; padding: 2rem;">

                        <strong> Aucun participant trouv%</strong><br>

                        <small>Assurez-vous que les %quipes sont configur%es dans le panneau admin.</small>

                    </div>

                `;

                return;

            }



            let html = `

                <div style="overflow-x: auto;">

                    <table style="width: 100%; border-collapse: collapse; border: 2px solid var(--c-ink-900);">

                        <thead>

                            <tr style="background: linear-gradient(135deg, #FF5722, #FF7043); color: white;">

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: left;"> Participant</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: left;"> %quipe</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: center;"> Pr%sent</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: center;"> Absent</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: center;"> Justifi%</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: left;"> Commentaire</th>

                            </tr>

                        </thead>

                        <tbody>

            `;



            participants.forEach(participant => {

                const presentChecked = participant.attendance === 'present' ? 'checked' : '';

                const absentChecked = participant.attendance === 'absent' ? 'checked' : '';

                const justifiedChecked = participant.attendance === 'justified' ? 'checked' : '';

                

                html += `

                    <tr style="border-bottom: 1px solid var(--c-ink-900);">

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900);">

                            <strong>${participant.name}</strong><br>

                            <small style="color: #666;">${participant.teamType === 'life' ? ' Vie' : ' Nuit'}</small>

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900);">

                            ${participant.team}

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900); text-align: center;">

                            <input type="radio" name="attendance_${participant.id}" value="present" ${presentChecked} 

                                   onchange="updateParticipantAttendance('${participant.id}', 'present')" 

                                   style="transform: scale(1.2);">

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900); text-align: center;">

                            <input type="radio" name="attendance_${participant.id}" value="absent" ${absentChecked}

                                   onchange="updateParticipantAttendance('${participant.id}', 'absent')"

                                   style="transform: scale(1.2);">

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900); text-align: center;">

                            <input type="radio" name="attendance_${participant.id}" value="justified" ${justifiedChecked}

                                   onchange="updateParticipantAttendance('${participant.id}', 'justified')"

                                   style="transform: scale(1.2);">

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900);">

                            <input type="text" id="comment_${participant.id}" placeholder="Commentaire..." 

                                   value="${participant.comment || ''}" 

                                   onchange="updateParticipantComment('${participant.id}', this.value)"

                                   style="width: 100%; padding: 0.25rem; border: 1px solid #ccc; border-radius: 4px;">

                        </td>

                    </tr>

                `;

            });



            html += `

                        </tbody>

                    </table>

                </div>

            `;



            tableContainer.innerHTML = html;

        }



        // Mettre % jour l'attendance d'un participant

        function updateParticipantAttendance(participantId, status) {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            if (!attendanceRecords[outingId]) {

                attendanceRecords[outingId] = {};

            }

            

            attendanceRecords[outingId][participantId] = status;

            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));

            

            // Mettre % jour les statistiques

            updateAttendanceStatsFromCurrent();

        }



        // Mettre % jour le commentaire d'un participant

        function updateParticipantComment(participantId, comment) {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            if (!attendanceRecords[outingId]) {

                attendanceRecords[outingId] = {};

            }

            

            if (!attendanceRecords[outingId][participantId]) {

                attendanceRecords[outingId][participantId] = 'unknown';

            }

            

            // Stocker le commentaire s%par%ment

            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            if (!comments[outingId]) {

                comments[outingId] = {};

            }

            comments[outingId][participantId] = comment;

            localStorage.setItem('attendance-comments', JSON.stringify(comments));

        }



        // Mettre % jour les statistiques d'attendance

        function updateAttendanceStats(participants) {

            let present = 0, absent = 0, justified = 0, total = participants.length;

            

            participants.forEach(participant => {

                switch(participant.attendance) {

                    case 'present': present++; break;

                    case 'absent': absent++; break;

                    case 'justified': justified++; break;

                }

            });



            document.getElementById('presentCount').textContent = present;

            document.getElementById('absentCount').textContent = absent;

            document.getElementById('justifiedCount').textContent = justified;

            document.getElementById('totalCount').textContent = total;

        }



        // Mettre % jour les statistiques depuis les donn%es actuelles

        function updateAttendanceStatsFromCurrent() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            const currentAttendance = attendanceRecords[outingId] || {};

            

            let present = 0, absent = 0, justified = 0, total = 0;

            

            Object.values(currentAttendance).forEach(status => {

                total++;

                switch(status) {

                    case 'present': present++; break;

                    case 'absent': absent++; break;

                    case 'justified': justified++; break;

                }

            });



            document.getElementById('presentCount').textContent = present;

            document.getElementById('absentCount').textContent = absent;

            document.getElementById('justifiedCount').textContent = justified;

            document.getElementById('totalCount').textContent = total;

        }



        // Marquer tous les participants comme pr%sents

        function markAllPresent() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            if (!attendanceRecords[outingId]) {

                attendanceRecords[outingId] = {};

            }



            // Marquer tous les participants comme pr%sents

            document.querySelectorAll('input[type="radio"][value="present"]').forEach(radio => {

                radio.checked = true;

                const participantId = radio.name.replace('attendance_', '');

                attendanceRecords[outingId][participantId] = 'present';

            });



            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));

            updateAttendanceStatsFromCurrent();

            

            alert(' Tous les participants ont %t% marqu%s comme pr%sents !');

        }



        // Marquer tous les participants comme absents

        function markAllAbsent() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            if (!attendanceRecords[outingId]) {

                attendanceRecords[outingId] = {};

            }



            // Marquer tous les participants comme absents

            document.querySelectorAll('input[type="radio"][value="absent"]').forEach(radio => {

                radio.checked = true;

                const participantId = radio.name.replace('attendance_', '');

                attendanceRecords[outingId][participantId] = 'absent';

            });



            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));

            updateAttendanceStatsFromCurrent();

            

            alert(' Tous les participants ont %t% marqu%s comme absents !');

        }



        // Effacer toutes les donn%es d'attendance

        function clearAttendance() {

            if (!confirm(' %tes-vous s%W%r de vouloir effacer toutes les donn%es d\'attendance pour cette sortie ?')) {

                return;

            }



            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            // D%cocher tous les boutons radio

            document.querySelectorAll('input[type="radio"]').forEach(radio => {

                radio.checked = false;

            });



            // Effacer les commentaires

            document.querySelectorAll('input[type="text"]').forEach(input => {

                if (input.placeholder === 'Commentaire...') {

                    input.value = '';

                }

            });



            // Supprimer les donn%es du localStorage

            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            delete attendanceRecords[outingId];

            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));



            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            delete comments[outingId];

            localStorage.setItem('attendance-comments', JSON.stringify(comments));



            updateAttendanceStatsFromCurrent();

            alert(' Toutes les donn%es d\'attendance ont %t% effac%es !');

        }



        // Filtrer par %quipe

        function filterByTeam() {

            const filter = document.getElementById('teamFilter').value;

            const rows = document.querySelectorAll('#participantsTable tbody tr');

            

            rows.forEach(row => {

                const teamType = row.querySelector('td:first-child small').textContent.includes('Vie') ? 'life' : 'night';

                if (filter === '' || teamType === filter) {

                    row.style.display = '';

                } else {

                    row.style.display = 'none';

                }

            });

        }



        // Sauvegarder le registre d'attendance

        function saveAttendanceRecord() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            

            const record = {

                outingId: outingId,

                timestamp: new Date().toISOString(),

                attendance: attendanceRecords[outingId] || {},

                comments: comments[outingId] || {}

            };



            // Sauvegarder dans l'historique

            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const existingIndex = history.findIndex(h => h.outingId === outingId);

            

            if (existingIndex >= 0) {

                history[existingIndex] = record;

            } else {

                history.push(record);

            }

            

            localStorage.setItem('attendance-history', JSON.stringify(history));

            

            alert(' Registre d\'appel sauvegard% avec succ%s !');

            loadAttendanceHistory();

        }



        // Exporter les donn%es d'attendance

        function exportAttendanceData() {

            const attendanceHistory = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            

            if (attendanceHistory.length === 0) {

                alert(' Aucune donn%e d\'attendance % exporter.');

                return;

            }



            let csvContent = "Sortie,Date,Participant,%quipe,Pr%sence,Commentaire\n";

            

            attendanceHistory.forEach(record => {

                const outing = outings.find(o => o.id === record.outingId);

                const outingName = outing ? outing.name : 'Sortie inconnue';

                const date = new Date(record.timestamp).toLocaleDateString('fr-FR');

                

                Object.entries(record.attendance).forEach(([participantId, status]) => {

                    const [teamType, teamName, participantName] = participantId.split('_');

                    const comment = record.comments[participantId] || '';

                    const statusText = status === 'present' ? 'Pr%sent' : status === 'absent' ? 'Absent' : 'Justifi%';

                    

                    csvContent += `"${outingName}","${date}","${participantName}","${teamName}","${statusText}","${comment}"\n`;

                });

            });



            // T%l%charger le fichier CSV

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });

            const link = document.createElement('a');

            const url = URL.createObjectURL(blob);

            link.setAttribute('href', url);

            link.setAttribute('download', `registre_appel_${new Date().toISOString().split('T')[0]}.csv`);

            link.style.visibility = 'hidden';

            document.body.appendChild(link);

            link.click();

            document.body.removeChild(link);

            

            alert(' Donn%es export%es avec succ%s !');

        }



        // Cr%er un nouveau registre d'attendance

        function createNewAttendanceRecord() {

            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            

            if (outings.length === 0) {

                alert(' Aucune sortie disponible. Cr%ez d\'abord une sortie dans le panneau admin.');

                return;

            }



            // Cr%er un modal pour s%lectionner la sortie

            const modal = document.createElement('div');

            modal.style.cssText = `

                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 

                background: rgba(0,0,0,0.5); z-index: 1000; display: flex; 

                align-items: center; justify-content: center;

            `;

            

            modal.innerHTML = `

                <div class="fey-card" style="max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">

                    <div class="fey-card-header"> Cr%er un Nouveau Registre d'Appel</div>

                    <div style="padding: 1rem;">

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> S%lectionner la sortie :</label>

                        <select id="newOutingSelect" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); margin-bottom: 1rem;">

                            <option value="">-- Choisir une sortie --</option>

                        </select>

                        <div style="text-align: center; margin-top: 1rem;">

                            <button class="fey-btn" onclick="createAttendanceForSelectedOuting()" style="background: #4CAF50; margin-right: 1rem;">

                                 Cr%er

                            </button>

                            <button class="fey-btn" onclick="closeAttendanceModal()" style="background: #F44336;">

                                 Annuler

                            </button>

                        </div>

                    </div>

                </div>

            `;



            document.body.appendChild(modal);



            // Remplir le s%lecteur

            const select = modal.querySelector('#newOutingSelect');

            outings.forEach(outing => {

                const option = document.createElement('option');

                option.value = outing.id;

                option.textContent = `${outing.name} - ${new Date(outing.startDate).toLocaleDateString('fr-FR')}`;

                select.appendChild(option);

            });



            // Fonctions pour le modal

            window.createAttendanceForSelectedOuting = function() {

                const selectedOutingId = select.value;

                if (!selectedOutingId) {

                    alert(' Veuillez s%lectionner une sortie.');

                    return;

                }



                // S%lectionner la sortie dans le s%lecteur principal

                document.getElementById('selectedOuting').value = selectedOutingId;

                loadAttendanceForOuting();

                closeAttendanceModal();

            };



            window.closeAttendanceModal = function() {

                document.body.removeChild(modal);

                delete window.createAttendanceForSelectedOuting;

                delete window.closeAttendanceModal;

            };

        }



        // Charger l'historique des registres

        function loadAttendanceHistory() {

            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            const historyContainer = document.getElementById('attendanceHistory');

            

            if (history.length === 0) {

                historyContainer.innerHTML = `

                    <div class="fey-note" style="text-align: center; padding: 2rem;">

                        <strong> Aucun registre d'appel enregistr%</strong><br>

                        <small>Les registres d'appel appara%tront ici une fois sauvegard%s.</small>

                    </div>

                `;

                return;

            }



            let html = '';

            history.forEach(record => {

                const outing = outings.find(o => o.id === record.outingId);

                const outingName = outing ? outing.name : 'Sortie inconnue';

                const date = new Date(record.timestamp).toLocaleDateString('fr-FR');

                const time = new Date(record.timestamp).toLocaleTimeString('fr-FR');

                

                const stats = {

                    present: 0,

                    absent: 0,

                    justified: 0,

                    total: Object.keys(record.attendance).length

                };

                

                Object.values(record.attendance).forEach(status => {

                    switch(status) {

                        case 'present': stats.present++; break;

                        case 'absent': stats.absent++; break;

                        case 'justified': stats.justified++; break;

                    }

                });



                html += `

                    <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3; margin-bottom: 1rem;">

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">

                            <h4 style="margin: 0; color: var(--c-marine-700);"> ${outingName}</h4>

                            <small style="color: #666;">${date} % ${time}</small>

                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 0.5rem; margin-bottom: 1rem;">

                            <div style="text-align: center; background: white; padding: 0.5rem; border-radius: 4px; border: 1px solid var(--c-ink-900);">

                                <strong style="color: #4CAF50;">${stats.present}</strong><br>

                                <small> Pr%sents</small>

                            </div>

                            <div style="text-align: center; background: white; padding: 0.5rem; border-radius: 4px; border: 1px solid var(--c-ink-900);">

                                <strong style="color: #F44336;">${stats.absent}</strong><br>

                                <small> Absents</small>

                            </div>

                            <div style="text-align: center; background: white; padding: 0.5rem; border-radius: 4px; border: 1px solid var(--c-ink-900);">

                                <strong style="color: #FF9800;">${stats.justified}</strong><br>

                                <small> Justifi%s</small>

                            </div>

                            <div style="text-align: center; background: white; padding: 0.5rem; border-radius: 4px; border: 1px solid var(--c-ink-900);">

                                <strong style="color: #2196F3;">${stats.total}</strong><br>

                                <small> Total</small>

                            </div>

                        </div>

                        <div style="text-align: center;">

                            <button class="fey-btn" onclick="viewAttendanceRecord('${record.outingId}')" style="background: #2196F3; font-size: 0.9rem; padding: 0.5rem 1rem; margin-right: 0.5rem;">

                                 Consulter

                            </button>

                            <button class="fey-btn" onclick="deleteAttendanceRecord('${record.outingId}')" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;">

                                 Supprimer

                            </button>

                        </div>

                    </div>

                `;

            });



            historyContainer.innerHTML = html;

        }



        // Consulter un registre d'attendance

        function viewAttendanceRecord(outingId) {

            document.getElementById('selectedOuting').value = outingId;

            loadAttendanceForOuting();

            showPage('registre');

        }



        // Supprimer un registre d'attendance

        function deleteAttendanceRecord(outingId) {

            if (!confirm(' %tes-vous s%W%r de vouloir supprimer ce registre d\'appel ? Cette action est irr%versible.')) {

                return;

            }



            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const updatedHistory = history.filter(record => record.outingId !== outingId);

            localStorage.setItem('attendance-history', JSON.stringify(updatedHistory));

            

            // Supprimer aussi les donn%es actuelles

            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            delete attendanceRecords[outingId];

            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));

            

            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            delete comments[outingId];

            localStorage.setItem('attendance-comments', JSON.stringify(comments));

            

            loadAttendanceHistory();

            alert(' Registre d\'appel supprim% avec succ%s !');

        }



        // Imprimer le registre d'attendance

        function printAttendanceRecord() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            const outing = outings.find(o => o.id === outingId);

            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            

            const currentAttendance = attendanceRecords[outingId] || {};

            const currentComments = comments[outingId] || {};



            if (!outing) {

                alert(' Sortie non trouv%e.');

                return;

            }



            // Cr%er une fen%tre d'impression

            const printWindow = window.open('', '_blank');

            printWindow.document.write(`

                <html>

                    <head>

                        <title>Registre d'Appel - ${outing.name}</title>

                        <style>

                            body { font-family: Arial, sans-serif; margin: 20px; }

                            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }

                            .outing-info { margin-bottom: 30px; }

                            .info-row { margin-bottom: 10px; }

                            table { width: 100%; border-collapse: collapse; margin-top: 20px; }

                            th, td { border: 1px solid #333; padding: 8px; text-align: left; }

                            th { background-color: #f0f0f0; font-weight: bold; }

                            .stats { display: flex; justify-content: space-around; margin-top: 30px; }

                            .stat-box { text-align: center; padding: 10px; border: 1px solid #333; }

                            .footer { margin-top: 50px; text-align: center; font-size: 12px; color: #666; }

                        </style>

                    </head>

                    <body>

                        <div class="header">

                            <h1> REGISTRE D'APPEL</h1>

                            <h2>${outing.name}</h2>

                        </div>

                        

                        <div class="outing-info">

                            <div class="info-row"><strong>Date :</strong> ${new Date(outing.startDate).toLocaleDateString('fr-FR')}</div>

                            <div class="info-row"><strong>Lieu :</strong> ${outing.location || 'Non sp%cifi%'}</div>

                            <div class="info-row"><strong>Heure de d%part :</strong> ${outing.departureTime || 'Non sp%cifi%'}</div>

                            <div class="info-row"><strong>Description :</strong> ${outing.description || 'Aucune description'}</div>

                        </div>

                        

                        <table>

                            <thead>

                                <tr>

                                    <th>Participant</th>

                                    <th>%quipe</th>

                                    <th>Pr%sent</th>

                                    <th>Absent</th>

                                    <th>Justifi%</th>

                                    <th>Commentaire</th>

                                    <th>Signature</th>

                                </tr>

                            </thead>

                            <tbody>

            `);



            // Ajouter les participants

            const lifeTeams = JSON.parse(localStorage.getItem('life-teams') || '[]');

            const nightTeams = JSON.parse(localStorage.getItem('night-teams') || '[]');

            

            [...lifeTeams, ...nightTeams].forEach(team => {

                team.members.forEach(member => {

                    const participantId = `${team.name.includes('Vie') ? 'life' : 'night'}_${team.name}_${member}`;

                    const attendance = currentAttendance[participantId] || 'unknown';

                    const comment = currentComments[participantId] || '';

                    

                    printWindow.document.write(`

                        <tr>

                            <td>${member}</td>

                            <td>${team.name}</td>

                            <td>${attendance === 'present' ? '' : ''}</td>

                            <td>${attendance === 'absent' ? '' : ''}</td>

                            <td>${attendance === 'justified' ? '' : ''}</td>

                            <td>${comment}</td>

                            <td></td>

                        </tr>

                    `);

                });

            });



            // Calculer les statistiques

            const stats = { present: 0, absent: 0, justified: 0, total: 0 };

            Object.values(currentAttendance).forEach(status => {

                stats.total++;

                switch(status) {

                    case 'present': stats.present++; break;

                    case 'absent': stats.absent++; break;

                    case 'justified': stats.justified++; break;

                }

            });



            printWindow.document.write(`

                            </tbody>

                        </table>

                        

                        <div class="stats">

                            <div class="stat-box">

                                <strong>${stats.present}</strong><br>

                                Pr%sents

                            </div>

                            <div class="stat-box">

                                <strong>${stats.absent}</strong><br>

                                Absents

                            </div>

                            <div class="stat-box">

                                <strong>${stats.justified}</strong><br>

                                Justifi%s

                            </div>

                            <div class="stat-box">

                                <strong>${stats.total}</strong><br>

                                Total

                            </div>

                        </div>

                        

                        <div class="footer">

                            <p>Registre g%n%r% le ${new Date().toLocaleDateString('fr-FR')} % ${new Date().toLocaleTimeString('fr-FR')}</p>

                        </div>

                    </body>

                </html>

            `);

            

            printWindow.document.close();

            printWindow.print();

        }



        // Activer l'onglet registre d'appel pour les admins

        function enableRegistreTab() {

            const registreTab = document.getElementById('registreTab');

            if (registreTab) {

                registreTab.style.display = 'inline-block';

            }

        }



        // Fonction enableAdminMode compl%te

        function enableAdminMode() {

            // Utiliser notre nouveau syst%me d'onglets admin

            if (typeof showAdminTabs === 'function') {

                showAdminTabs();

            }

            

            // Activer aussi le registre d'appel

            if (typeof enableRegistreTab === 'function') {

                enableRegistreTab();

            }

            

            // Charger les %l%ments de la checklist

            setTimeout(() => {

                if (typeof loadChecklistItems === 'function') {

                    loadChecklistItems();

                }

                if (typeof loadCalendarTrips === 'function') {

                    loadCalendarTrips();

                }

            }, 100);

        }



        // Fonction pour charger les sorties du calendrier dans l'admin

        function loadCalendarTrips() {

            const calendarTripsList = document.getElementById('calendar-trips-list');

            if (!calendarTripsList) return;



            const events = getCalendarEvents();

            const trips = [];



            // Parcourir TOUS les %v%nements du calendrier (pas de filtre)

            Object.entries(events).forEach(([dateKey, event]) => {

                const tripDate = new Date(dateKey.split('-').reverse().join('-'));

                const formattedDate = tripDate.toLocaleDateString('fr-FR', {

                    weekday: 'long',

                    day: 'numeric',

                    month: 'long',

                    year: 'numeric'

                });



                trips.push({

                    id: dateKey.replace(/-/g, '_'),

                    title: event.title,

                    date: formattedDate,

                    description: event.description || '',

                    rawDate: dateKey

                });

            });



            // Trier les sorties par date

            trips.sort((a, b) => new Date(a.rawDate) - new Date(b.rawDate));



            // Charger les s%lections sauvegard%es (seulement pour le covoiturage)

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');



            // Cr%er l'interface

            let html = '';

            trips.forEach(trip => {

                const hasCarpool = savedCarpoolSelections[trip.id] || false;

                html += `

                    <div class="fey-item" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50; margin-bottom: 1rem;">

                        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 1rem; align-items: center;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Sortie</label>

                                <div style="font-weight: bold; color: var(--c-forest-700);">${trip.title}</div>

                                <div style="font-size: 0.9rem; color: var(--c-forest-600);">${trip.date}</div>

                                ${trip.description ? `<div style="font-size: 0.8rem; color: var(--c-ink-600); margin-top: 0.25rem;">${trip.description}</div>` : ''}

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Registre d'Appel</label>

                                <div style="font-size: 0.9rem; color: var(--c-forest-700); font-weight: bold;">

                                     Automatique

                                </div>

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Covoiturage</label>

                                <div style="display: flex; align-items: center; gap: 0.5rem;">

                                    <input type="checkbox" id="carpool-${trip.id}" ${hasCarpool ? 'checked' : ''} onchange="updateCarpoolSelection('${trip.id}', this.checked)">

                                    <label for="carpool-${trip.id}" style="font-size: 0.9rem;">Activer le covoiturage</label>

                                </div>

                            </div>

                        </div>

                    </div>

                `;

            });



            calendarTripsList.innerHTML = html;

            console.log(` ${trips.length} sorties charg%es dans l'admin`);

            

            // Charger aussi les sorties avec covoiturage dans la section d%di%e

            loadCarpoolTripsInAdmin();

        }



        // Fonction pour charger les sorties avec covoiturage dans la section admin

        function loadCarpoolTripsInAdmin() {

            console.log(' Chargement des sorties covoiturage dans l\'admin...');

            

            const tripsManagement = document.getElementById('trips-management');

            if (!tripsManagement) return;

            

            // R%cup%rer les s%lections de covoiturage sauvegard%es

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

            const events = getCalendarEvents();

            

            // Filtrer les sorties qui ont le covoiturage activ%

            const carpoolTrips = [];

            Object.entries(events).forEach(([dateKey, event]) => {

                const tripId = dateKey.replace(/-/g, '_');

                if (savedCarpoolSelections[tripId]) {

                    const tripDate = new Date(dateKey.split('-').reverse().join('-'));

                    const formattedDate = tripDate.toISOString().split('T')[0]; // Format YYYY-MM-DD pour input date

                    

                    carpoolTrips.push({

                        id: tripId,

                        title: event.title,

                        date: formattedDate,

                        description: event.description || '',

                        rawDate: dateKey

                    });

                }

            });

            

            // Trier par date

            carpoolTrips.sort((a, b) => new Date(a.rawDate) - new Date(b.rawDate));

            

            console.log(` ${carpoolTrips.length} sorties avec covoiturage trouv%es pour l'admin`);

            

            // Charger les donn%es sauvegard%es

            const carpoolTripsData = JSON.parse(localStorage.getItem('carpool-trips-data') || '{}');

            

            // Cr%er l'interface pour chaque sortie avec covoiturage

            let html = '';

            if (carpoolTrips.length === 0) {

                html = `

                    <div class="fey-note" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800;">

                        <strong> Aucune sortie avec covoiturage :</strong> Activez le covoiturage pour des sorties dans la section ci-dessus.

                    </div>

                `;

            } else {

                carpoolTrips.forEach(trip => {

                    // R%cup%rer les donn%es sauvegard%es pour cette sortie

                    const savedData = carpoolTripsData[trip.id] || {};

                    const title = savedData.title || trip.title;

                    const date = savedData.date || trip.date;

                    const departureTime = savedData.departureTime || '08:00';

                    const returnTime = savedData.returnTime || '17:00';

                    

                    html += `

                        <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3; margin-bottom: 1rem;">

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; align-items: center;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom de la Sortie</label>

                                    <input type="text" value="${title}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);" data-trip-id="${trip.id}" disabled>

                                </div>

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Date</label>

                                    <input type="date" value="${date}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);" data-trip-id="${trip.id}" disabled>

                                </div>

                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Point de D%part (FIX%)</label>

                                    <input type="text" value="Place de la Mairie" readonly style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); background: #f5f5f5;">

                                </div>

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Point d'Arriv%e (FIX%)</label>

                                    <input type="text" value="Jambville" readonly style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); background: #f5f5f5;">

                                </div>

                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure D%part</label>

                                    <input type="time" value="${departureTime}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);" data-trip-id="${trip.id}" disabled>

                                </div>

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% Heure Retour</label>

                                    <input type="time" value="${returnTime}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);" data-trip-id="${trip.id}" disabled>

                                </div>

                            </div>

                            <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">

                                <button class="fey-btn" onclick="saveCarpoolTrip('${trip.id}')" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;"> Sauvegarder</button>

                                <button class="fey-btn" onclick="editCarpoolTrip('${trip.id}')" style="background: #FF9800; font-size: 0.9rem; padding: 0.5rem 1rem;"> Modifier</button>

                                <button class="fey-btn" onclick="removeCarpoolTrip('${trip.id}')" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;"> Supprimer</button>

                            </div>

                        </div>

                    `;

                });

            }

            

            tripsManagement.innerHTML = html;

            

            // Ajouter un bouton de rechargement si il y a des sorties

            if (carpoolTrips.length > 0) {

                const refreshButton = `

                    <div style="margin-top: 1rem; text-align: center;">

                        <button onclick="loadCarpoolTripsInAdmin()" class="fey-btn" style="background: #2196F3;">

                             Recharger les sorties covoiturage

                        </button>

                    </div>

                `;

                tripsManagement.insertAdjacentHTML('beforeend', refreshButton);

            }

        }



        // Fonction pour mettre % jour la s%lection de covoiturage d'une sortie

        function updateCarpoolSelection(tripId, hasCarpool) {

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

            savedCarpoolSelections[tripId] = hasCarpool;

            localStorage.setItem('carpool-selections', JSON.stringify(savedCarpoolSelections));

            

            console.log(` Covoiturage ${hasCarpool ? 'activ%' : 'd%sactiv%'} pour ${tripId}`);

            

            // Recharger la section covoiturage si elle est visible

            const covoituragePage = document.getElementById('covoiturage');

            if (covoituragePage && covoituragePage.classList.contains('active')) {

                loadCarpoolTripsFromCalendar();

            }

            

            // Recharger la section admin des sorties covoiturage

            loadCarpoolTripsInAdmin();

        }



        // Fonction pour sauvegarder toutes les s%lections

        function saveTripSelections() {

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

            const selectedCarpoolTrips = Object.keys(savedCarpoolSelections).filter(id => savedCarpoolSelections[id]);

            

            localStorage.setItem('carpool-selections', JSON.stringify(savedCarpoolSelections));

            alert(` ${selectedCarpoolTrips.length} sorties avec covoiturage sauvegard%es !`);

            

            // Recharger la liste du registre d'appel

            loadTripsFromCalendar();

            

            // Recharger la section covoiturage si elle est visible

            const covoituragePage = document.getElementById('covoiturage');

            if (covoituragePage && covoituragePage.classList.contains('active')) {

                loadCarpoolTripsFromCalendar();

            }

            

            // Recharger la section admin des sorties covoiturage

            loadCarpoolTripsInAdmin();

        }



        // Fonctions pour g%rer les sorties covoiturage dans l'admin

        function saveCarpoolTrip(tripId) {

            console.log(` Sauvegarde de la sortie covoiturage: ${tripId}`);

            // R%cup%rer les donn%es du formulaire

            const tripContainer = document.querySelector(`[data-trip-id="${tripId}"]`).closest('.fey-item');

            const title = tripContainer.querySelector('input[type="text"]').value;

            const date = tripContainer.querySelector('input[type="date"]').value;

            const departureTime = tripContainer.querySelector('input[type="time"]').value;

            const returnTime = tripContainer.querySelectorAll('input[type="time"]')[1].value;

            

            // Sauvegarder dans le localStorage

            const carpoolTripsData = JSON.parse(localStorage.getItem('carpool-trips-data') || '{}');

            carpoolTripsData[tripId] = {

                title: title,

                date: date,

                departureTime: departureTime,

                returnTime: returnTime,

                departurePoint: 'Place de la Mairie',

                arrivalPoint: 'Jambville'

            };

            localStorage.setItem('carpool-trips-data', JSON.stringify(carpoolTripsData));

            

            alert(` Sortie "${title}" sauvegard%e avec succ%s !`);

        }



        function editCarpoolTrip(tripId) {

            console.log(` Modification de la sortie covoiturage: ${tripId}`);

            const tripContainer = document.querySelector(`[data-trip-id="${tripId}"]`).closest('.fey-item');

            const inputs = tripContainer.querySelectorAll('input:not([readonly])');

            

            // Activer l'%dition

            inputs.forEach(input => {

                input.disabled = false;

                input.style.background = '#fff';

            });

            

            // Changer le bouton en "Confirmer"

            const editBtn = tripContainer.querySelector(`button[onclick="editCarpoolTrip('${tripId}')"]`);

            editBtn.innerHTML = ' Confirmer';

            editBtn.onclick = () => confirmCarpoolTripEdit(tripId);

        }



        function confirmCarpoolTripEdit(tripId) {

            console.log(` Confirmation de l'%dition: ${tripId}`);

            const tripContainer = document.querySelector(`[data-trip-id="${tripId}"]`).closest('.fey-item');

            const inputs = tripContainer.querySelectorAll('input:not([readonly])');

            

            // D%sactiver l'%dition

            inputs.forEach(input => {

                input.disabled = true;

                input.style.background = '#f5f5f5';

            });

            

            // Remettre le bouton en "Modifier"

            const editBtn = tripContainer.querySelector(`button[onclick="confirmCarpoolTripEdit('${tripId}')"]`);

            editBtn.innerHTML = ' Modifier';

            editBtn.onclick = () => editCarpoolTrip(tripId);

            

            // Sauvegarder automatiquement

            saveCarpoolTrip(tripId);

        }



        function removeCarpoolTrip(tripId) {

            if (confirm(` %tes-vous s%W%r de vouloir supprimer cette sortie covoiturage ?`)) {

                console.log(` Suppression de la sortie covoiturage: ${tripId}`);

                

                // D%sactiver le covoiturage pour cette sortie

                const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

                savedCarpoolSelections[tripId] = false;

                localStorage.setItem('carpool-selections', JSON.stringify(savedCarpoolSelections));

                

                // Supprimer les donn%es de covoiturage

                const carpoolTripsData = JSON.parse(localStorage.getItem('carpool-trips-data') || '{}');

                delete carpoolTripsData[tripId];

                localStorage.setItem('carpool-trips-data', JSON.stringify(carpoolTripsData));

                

                // Recharger les sections

                loadCarpoolTripsInAdmin();

                loadCalendarTrips();

                

                alert(` Sortie covoiturage supprim%e ! Le covoiturage a %t% d%sactiv% pour cette sortie.`);

            }

        }



        // Fonction pour charger les sorties avec covoiturage depuis le calendrier

        function loadCarpoolTripsFromCalendar() {

            console.log(' Chargement des sorties avec covoiturage...');

            

            // R%cup%rer les s%lections de covoiturage sauvegard%es

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

            const events = getCalendarEvents();

            

            // Filtrer les sorties qui ont le covoiturage activ%

            const carpoolTrips = [];

            Object.entries(events).forEach(([dateKey, event]) => {

                const tripId = dateKey.replace(/-/g, '_');

                if (savedCarpoolSelections[tripId]) {

                    const tripDate = new Date(dateKey.split('-').reverse().join('-'));

                    const formattedDate = tripDate.toLocaleDateString('fr-FR', {

                        weekday: 'long',

                        day: 'numeric',

                        month: 'long',

                        year: 'numeric'

                    });

                    

                    carpoolTrips.push({

                        id: tripId,

                        title: event.title,

                        date: formattedDate,

                        description: event.description || '',

                        rawDate: dateKey

                    });

                }

            });

            

            // Trier par date

            carpoolTrips.sort((a, b) => new Date(a.rawDate) - new Date(b.rawDate));

            

            console.log(` ${carpoolTrips.length} sorties avec covoiturage trouv%es`);

            

            // Mettre % jour l'interface covoiturage

            updateCarpoolInterface(carpoolTrips);

        }



        // Fonction pour mettre % jour l'interface covoiturage

        function updateCarpoolInterface(carpoolTrips) {

            // Trouver le conteneur des sorties covoiturage

            const carpoolContainer = document.querySelector('#covoiturage .fey-card:first-of-type');

            if (!carpoolContainer) return;

            

            // Nettoyer le contenu existant (garder seulement le header)

            const header = carpoolContainer.querySelector('.fey-card-header');

            if (header) {

                // Supprimer tous les %l%ments apr%s le header

                let nextElement = header.nextElementSibling;

                while (nextElement) {

                    const toRemove = nextElement;

                    nextElement = nextElement.nextElementSibling;

                    toRemove.remove();

                }

            }

            

            // Cr%er la liste des sorties avec covoiturage

            let html = '';

            if (carpoolTrips.length === 0) {

                html = `

                    <div class="fey-note" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800;">

                        <strong> Aucune sortie avec covoiturage :</strong> Activez le covoiturage pour des sorties dans la section Admin.

                    </div>

                `;

            } else {

                html = `

                    <div class="fey-note" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50;">

                        <strong> Sorties avec covoiturage activ% :</strong> ${carpoolTrips.length} sortie(s) n%cessitant du covoiturage.

                    </div>

                `;

                

                carpoolTrips.forEach(trip => {

                    html += `

                        <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3; margin-bottom: 1rem;">

                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem; align-items: center;">

                                <div>

                                    <div style="font-weight: bold; color: var(--c-forest-700); font-size: 1.1rem;">${trip.title}</div>

                                    <div style="font-size: 0.9rem; color: var(--c-forest-600); margin-top: 0.25rem;">${trip.date}</div>

                                    ${trip.description ? `<div style="font-size: 0.8rem; color: var(--c-ink-600); margin-top: 0.25rem;">${trip.description}</div>` : ''}

                                </div>

                                <div style="text-align: center;">

                                    <div style="font-size: 0.9rem; color: var(--c-forest-700); font-weight: bold; margin-bottom: 0.5rem;"> Covoiturage</div>

                                    <div style="background: #4CAF50; color: white; padding: 0.5rem; border-radius: var(--r-sm); font-weight: bold;">

                                         Activ%

                                    </div>

                                </div>

                            </div>

                        </div>

                    `;

                });

            }

            

            // Ajouter le contenu apr%s le header

            if (header) {

                header.insertAdjacentHTML('afterend', html);

                

                // Ajouter un bouton de rechargement

                const refreshButton = `

                    <div style="margin-top: 1rem; text-align: center;">

                        <button onclick="loadCarpoolTripsFromCalendar()" class="fey-btn" style="background: #2196F3; margin-right: 1rem;">

                             Recharger les sorties

                        </button>

                        <button onclick="showPage('admin')" class="fey-btn" style="background: #9C27B0;">

                             G%rer les sorties

                        </button>

                    </div>

                `;

                header.insertAdjacentHTML('afterend', refreshButton);

            }

        }



        // Fonction pour charger les %l%ments de la checklist

        function loadChecklistItems() {

            const container = document.getElementById('checklistItemsList');

            if (!container) return;



            const items = JSON.parse(localStorage.getItem('checklist-items') || '[]');

            

            if (items.length === 0) {

                container.innerHTML = '<p style="text-align: center; color: #666;">Aucun %l%ment personnalis% ajout%</p>';

                return;

            }



            let html = '<h4 style="color: var(--c-forest-700); margin-bottom: 1rem;"> %l%ments Personnalis%s</h4>';

            

            items.forEach(item => {

                html += `

                    <div style="display: flex; align-items: center; gap: 1rem; padding: 0.5rem; border: 1px solid var(--c-ink-900); border-radius: var(--r-sm); margin-bottom: 0.5rem; background: ${item.isOptional ? 'linear-gradient(135deg, #FFF3E0, #FFE0B2)' : 'linear-gradient(135deg, #E8F5E8, #C8E6C9)'};">

                        <div style="flex: 1;">

                            <div style="font-weight: bold;">${item.text}</div>

                            <div style="font-size: 0.9rem; color: #666;">

                                 ${item.category} ${item.isOptional ? ' (Facultatif)' : ' (Obligatoire)'}

                            </div>

                            ${item.tooltip ? `<div style="font-size: 0.8rem; color: #888; font-style: italic;"> ${item.tooltip}</div>` : ''}

                        </div>

                        <button class="fey-btn" onclick="deleteChecklistItem(${item.id})" style="background: #F44336; font-size: 0.8rem; padding: 0.25rem 0.5rem;">

                            

                        </button>

                    </div>

                `;

            });

            

            container.innerHTML = html;

        }



        // Fonction pour afficher le modal d'ajout d'%l%ment

        function showAddItemModal() {

            const modal = document.createElement('div');

            modal.id = 'addItemModal';

            modal.style.cssText = `

                position: fixed;

                top: 0;

                left: 0;

                width: 100%;

                height: 100%;

                background: rgba(0, 0, 0, 0.5);

                z-index: 1000;

                display: flex;

                justify-content: center;

                align-items: center;

            `;

            

            modal.innerHTML = `

                <div style="

                    background: var(--c-parchment);

                    border-radius: var(--r-md);

                    padding: 2rem;

                    max-width: 600px;

                    width: 90%;

                    max-height: 80vh;

                    overflow-y: auto;

                    border: 3px solid var(--c-ink-900);

                ">

                    <div class="fey-card-header"> Ajouter un %l%ment % la Liste</div>

                    <form id="addItemForm" style="display: flex; flex-direction: column; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Texte de l'%l%ment</label>

                            <input type="text" name="itemText" placeholder="Ex: T-shirt de rechange" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Cat%gorie</label>

                            <select name="category" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                <option value="sac-couchage"> Sac et couchage</option>

                                <option value="v%tements"> V%tements</option>

                                <option value="chaussures"> Chaussures</option>

                                <option value="hygi%ne">]% Hygi%ne</option>

                                <option value="mat%riel"> Mat%riel</option>

                                <option value="documents"> Documents</option>

                                <option value="nourriture"> Nourriture</option>

                                <option value="autre"> Autre</option>

                            </select>

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Lien exemple (optionnel)</label>

                            <input type="url" name="exampleLink" placeholder="https://exemple.com" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Info-bulle (optionnel)</label>

                            <textarea name="tooltip" placeholder="Conseil ou information suppl%mentaire..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 60px; resize: vertical;"></textarea>

                        </div>



                        <div style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                            <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: bold; cursor: pointer;">

                                <input type="checkbox" name="isOptional" style="transform: scale(1.2);">

                                 %l%ment facultatif

                            </label>

                            <small style="color: #666; margin-top: 0.5rem; display: block;">

                                Si coch%, l'%l%ment sera marqu% comme facultatif dans la liste

                            </small>

                        </div>



                        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">

                            <button type="submit" class="fey-btn" style="background: #4CAF50; padding: 0.75rem 1.5rem;">

                                 Ajouter l'%l%ment

                            </button>

                            <button type="button" onclick="closeAddItemModal()" class="fey-btn" style="background: #F44336; padding: 0.75rem 1.5rem;">

                                 Annuler

                            </button>

                        </div>

                    </form>

                </div>

            `;



            document.body.appendChild(modal);



            // G%rer la soumission du formulaire

            document.getElementById('addItemForm').addEventListener('submit', function(e) {

                e.preventDefault();

                

                const formData = new FormData(this);

                const itemData = {

                    id: Date.now(),

                    text: formData.get('itemText'),

                    category: formData.get('category'),

                    exampleLink: formData.get('exampleLink'),

                    tooltip: formData.get('tooltip'),

                    isOptional: formData.get('isOptional') === 'on',

                    isChecked: false

                };



                // Sauvegarder l'%l%ment

                const existingItems = JSON.parse(localStorage.getItem('checklist-items') || '[]');

                existingItems.push(itemData);

                localStorage.setItem('checklist-items', JSON.stringify(existingItems));



                alert(' %l%ment ajout% avec succ%s !');

                closeAddItemModal();

                loadChecklistItems();

            });

        }



        // Fonction pour fermer le modal d'ajout

        function closeAddItemModal() {

            const modal = document.getElementById('addItemModal');

            if (modal) {

                modal.remove();

            }

        }



        // Fonction pour afficher le modal de modification des %l%ments

        function showEditItemsModal() {

            const modal = document.createElement('div');

            modal.id = 'editItemsModal';

            modal.style.cssText = `

                position: fixed;

                top: 0;

                left: 0;

                width: 100%;

                height: 100%;

                background: rgba(0, 0, 0, 0.5);

                z-index: 1000;

                display: flex;

                justify-content: center;

                align-items: center;

            `;

            

            modal.innerHTML = `

                <div style="

                    background: var(--c-parchment);

                    border-radius: var(--r-md);

                    padding: 2rem;

                    max-width: 800px;

                    width: 90%;

                    max-height: 80vh;

                    overflow-y: auto;

                    border: 3px solid var(--c-ink-900);

                ">

                    <div class="fey-card-header"> Modifier les %l%ments de la Liste</div>

                    <div id="editItemsList" style="max-height: 400px; overflow-y: auto; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1rem; background: white; margin-bottom: 1rem;">

                        <!-- Les %l%ments seront charg%s ici -->

                    </div>

                    <div style="display: flex; gap: 1rem; justify-content: center;">

                        <button class="fey-btn" onclick="saveChecklistItems()" style="background: #4CAF50; padding: 0.75rem 1.5rem;">

                             Sauvegarder les Modifications

                        </button>

                        <button class="fey-btn" onclick="closeEditItemsModal()" style="background: #F44336; padding: 0.75rem 1.5rem;">

                             Fermer

                        </button>

                    </div>

                </div>

            `;



            document.body.appendChild(modal);

            loadEditItemsList();

        }



        // Fonction pour fermer le modal de modification

        function closeEditItemsModal() {

            const modal = document.getElementById('editItemsModal');

            if (modal) {

                modal.remove();

            }

        }



        // Fonction pour supprimer un %l%ment

        function deleteChecklistItem(itemId) {

            if (confirm('%tes-vous s%W%r de vouloir supprimer cet %l%ment ?')) {

                const items = JSON.parse(localStorage.getItem('checklist-items') || '[]');

                const updatedItems = items.filter(item => item.id !== itemId);

                localStorage.setItem('checklist-items', JSON.stringify(updatedItems));

                loadChecklistItems();

                alert(' %l%ment supprim% !');

            }

        }



        // Fonction pour r%initialiser la liste

        function resetChecklistItems() {

            if (confirm('%tes-vous s%W%r de vouloir r%initialiser tous les %l%ments personnalis%s ? Cette action est irr%versible.')) {

                localStorage.removeItem('checklist-items');

                loadChecklistItems();

                alert(' Liste r%initialis%e !');

            }

        }



        // Charger l'historique au d%marrage

        document.addEventListener('DOMContentLoaded', function() {

            if (document.getElementById('attendanceHistory')) {

                loadAttendanceHistory();

            }

            // Charger les informations de contact

            loadContactInfo();

        });



        // ===============================

        // FONCTIONS GESTION DES CONTACTS

        // ===============================



        // Charger les informations de contact depuis le localStorage

        function loadContactInfo() {

            const contactInfo = JSON.parse(localStorage.getItem('contact-info') || '{}');

            

            // Charger les informations g%n%rales

            if (contactInfo.campLocation) document.getElementById('campLocation').value = contactInfo.campLocation;

            if (contactInfo.driveLink) document.getElementById('driveLink').value = contactInfo.driveLink;



            // Charger les contacts

            const contacts = contactInfo.contacts || [

                { id: 1, name: 'Marie Dupont', phone: '06.12.34.56.78', email: 'marie.dupont@email.com', role: 'Responsable' },

                { id: 2, name: 'Jean Martin', phone: '06.98.76.54.32', email: 'jean.martin@email.com', role: 'Urgence' }

            ];

            

            loadContactsManagement(contacts);

            updateInfoPage(contactInfo, contacts);

        }



        // Charger la gestion des contacts dans le panneau admin

        function loadContactsManagement(contacts) {

            const container = document.getElementById('contacts-management');

            

            if (!container) return;

            

            container.innerHTML = '';

            

            contacts.forEach(contact => {

                const contactDiv = document.createElement('div');

                contactDiv.className = 'fey-item';

                contactDiv.style.cssText = 'background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50; margin-bottom: 1rem;';

                contactDiv.innerHTML = `

                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 1rem; align-items: center;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Nom du Responsable</label>

                            <input type="text" value="${contact.name}" data-field="name" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">% T%l%phone</label>

                            <input type="tel" value="${contact.phone}" data-field="phone" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> Email <span style="color: #666; font-size: 0.8rem;">(optionnel)</span></label>

                            <input type="email" value="${contact.email || ''}" data-field="email" placeholder="email@exemple.com" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;"> R%$%le <span style="color: #666; font-size: 0.8rem;">(optionnel)</span></label>

                            <input type="text" value="${contact.role || ''}" data-field="role" placeholder="ex: Responsable, Urgence, Transport..." style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>

                    <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">

                        <button class="fey-btn" onclick="saveContact(${contact.id})" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;"> Sauvegarder</button>

                        <button class="fey-btn" onclick="deleteContact(${contact.id})" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;"> Supprimer</button>

                    </div>

                `;

                container.appendChild(contactDiv);

            });

        }



        // Mettre % jour la page Infos avec les donn%es

        function updateInfoPage(contactInfo, contacts) {

            // Mettre % jour les informations g%n%rales

            if (contactInfo.campLocation) document.getElementById('info-camp-location').textContent = contactInfo.campLocation;



            // Mettre % jour la liste des contacts

            const contactsContainer = document.getElementById('info-contacts-list');

            if (contactsContainer) {

                contactsContainer.innerHTML = '';

                contacts.forEach(contact => {

                    const contactDiv = document.createElement('div');

                    contactDiv.style.cssText = 'margin-bottom: 0.5rem; padding: 0.5rem; background: #f8f9fa; border-radius: 4px;';

                    contactDiv.innerHTML = `

                        <p><strong>${contact.role ? contact.role + ' :' : ''}</strong> ${contact.name}</p>

                        <p><strong>T%l%phone :</strong> ${contact.phone}</p>

                        ${contact.email ? `<p><strong>Email :</strong> ${contact.email}</p>` : ''}

                    `;

                    contactsContainer.appendChild(contactDiv);

                });

            }

        }



        // Sauvegarder toutes les informations de contact

        function saveContactInfo() {

            const contactInfo = {

                campLocation: document.getElementById('campLocation').value,

                driveLink: document.getElementById('driveLink').value,

                contacts: getContactsFromForm()

            };



            localStorage.setItem('contact-info', JSON.stringify(contactInfo));

            

            // Mettre % jour la page Infos

            updateInfoPage(contactInfo, contactInfo.contacts);

            

            alert(' Informations de contact sauvegard%es avec succ%s !');

        }



        // R%cup%rer les contacts depuis le formulaire

        function getContactsFromForm() {

            const contacts = [];

            const contactElements = document.querySelectorAll('#contacts-management .fey-item');

            

            contactElements.forEach((element, index) => {

                const inputs = element.querySelectorAll('input, select');

                const contact = {

                    id: index + 1,

                    name: inputs[0].value,

                    phone: inputs[1].value,

                    email: inputs[2].value,

                    role: inputs[3].value

                };

                contacts.push(contact);

            });

            

            return contacts;

        }



        // Sauvegarder un contact individuel

        function saveContact(contactId) {

            const contactElement = document.querySelector(`button[onclick="saveContact(${contactId})"]`).closest('.fey-item');

            const inputs = contactElement.querySelectorAll('input');

            

            const contact = {

                id: contactId,

                name: inputs[0].value,

                phone: inputs[1].value,

                email: inputs[2].value || '', // Champ optionnel

                role: inputs[3].value || '' // Champ optionnel

            };



            const contactInfo = JSON.parse(localStorage.getItem('contact-info') || '{}');

            const contacts = contactInfo.contacts || [];

            const existingIndex = contacts.findIndex(c => c.id === contactId);

            

            if (existingIndex >= 0) {

                contacts[existingIndex] = contact;

            } else {

                contacts.push(contact);

            }

            

            contactInfo.contacts = contacts;

            localStorage.setItem('contact-info', JSON.stringify(contactInfo));

            

            // Mettre % jour la page Infos

            updateInfoPage(contactInfo, contacts);

            

            alert(' Contact sauvegard% avec succ%s !');

        }



        // Ajouter un nouveau contact

        function addContact() {

            const contactInfo = JSON.parse(localStorage.getItem('contact-info') || '{}');

            const contacts = contactInfo.contacts || [];

            

            const newContact = {

                id: Math.max(...contacts.map(c => c.id), 0) + 1,

                name: 'Nouveau Contact',

                phone: '06.00.00.00.00',

                email: '', // Champ optionnel

                role: '' // Champ optionnel

            };

            

            contacts.push(newContact);

            contactInfo.contacts = contacts;

            localStorage.setItem('contact-info', JSON.stringify(contactInfo));

            

            loadContactsManagement(contacts);

            alert(' Nouveau contact ajout% !');

        }



        // Supprimer un contact

        function deleteContact(contactId) {

            if (!confirm(' %tes-vous s%W%r de vouloir supprimer ce contact ?')) {

                return;

            }



            const contactInfo = JSON.parse(localStorage.getItem('contact-info') || '{}');

            const contacts = contactInfo.contacts || [];

            const updatedContacts = contacts.filter(c => c.id !== contactId);

            

            contactInfo.contacts = updatedContacts;

            localStorage.setItem('contact-info', JSON.stringify(contactInfo));

            

            loadContactsManagement(updatedContacts);

            updateInfoPage(contactInfo, updatedContacts);

            

            alert(' Contact supprim% avec succ%s !');

        }



        // R%initialiser les informations de contact

        function resetContactInfo() {

            if (!confirm(' %tes-vous s%W%r de vouloir r%initialiser toutes les informations de contact ?')) {

                return;

            }



            localStorage.removeItem('contact-info');

            loadContactInfo();

            alert(' Informations de contact r%initialis%es !');

        }



        // Ouvrir le drive des documents

        function ouvrirDrive() {

            const contactInfo = JSON.parse(localStorage.getItem('contact-info') || '{}');

            const driveLink = contactInfo.driveLink || 'https://drive.google.com/drive/folders/1BiH607P0bDlCc7g8thPl5V-uZQ71qA_a';

            

            if (driveLink) {

                window.open(driveLink, '_blank');

            } else {

                alert(' Veuillez d\'abord configurer le lien du drive dans le panneau admin.');

            }

        }



        // Fonctions existantes (% conserver)

        function ouvrirMaps() {

            window.open('https://maps.google.com/?q=Jambville+78440', '_blank');

        }



        function ouvrirWhatsApp() {

            const contactInfo = JSON.parse(localStorage.getItem('contact-info') || '{}');

            const contacts = contactInfo.contacts || [];

            const responsable = contacts.find(c => c.role === 'Responsable');

            

            if (responsable && responsable.phone) {

                const phoneNumber = responsable.phone.replace(/[^0-9]/g, '');

                window.open(`https://wa.me/33${phoneNumber}`, '_blank');

            } else {

                alert(' Aucun num%ro de responsable configur%. Veuillez configurer les contacts dans le panneau admin.');

            }

        }



        // === GESTION DES %QUIPES ===

        

        // Charger et afficher les %quipes de vie

        function loadVieTeams() {

            const container = document.getElementById('vieTeamsDisplay');

            if (!container) return;

            

            const vieTeams = getLifeTeams();

            let html = '';

            

            Object.values(vieTeams).forEach(team => {

                const rotation = Math.random() > 0.5 ? 'rotate(-1deg)' : 'rotate(1deg)';

                html += `

                    <div style="background: ${team.color}; color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900); transform: ${rotation};">

                        <h3 style="font-family: 'Patrick Hand', cursive; font-size: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid rgba(255, 255, 255, 0.3); padding-bottom: 0.5rem;">${team.name}</h3>

                        ${team.members.map(member => `<div style="padding: 0.5rem 0; font-size: 1rem;"> ${member}</div>`).join('')}

                    </div>

                `;

            });

            

            container.innerHTML = html;

        }

        

        // Charger et afficher les %quipes de nuit

        function loadNuitTeams() {

            const container = document.getElementById('nuitTeamsDisplay');

            if (!container) return;

            

            const nuitTeams = getNightTeams();

            let html = '';

            

            Object.values(nuitTeams).forEach(team => {

                html += `

                    <div style="background: ${team.color}; color: white; padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900); text-align: center;">

                        <h4 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem;">${team.name}</h4>

                        <div style="font-size: 0.9rem; text-align: left; padding: 0.5rem;">

                            ${team.members.map(member => ` ${member}<br>`).join('')}

                        </div>

                    </div>

                `;

            });

            

            container.innerHTML = html;

        }

        

        // Charger toutes les %quipes

        function loadAllTeams() {

            loadVieTeams();

            loadNuitTeams();

        }

        

        // Mettre % jour l'%diteur d'%quipes existant pour utiliser le syst%me centralis%

        function updateTeamEditorWithCentralizedData() {

            // Cette fonction met % jour l'%diteur existant dans la page %quipes

            const vieTeams = getLifeTeams();

            const nuitTeams = getNightTeams();

            

            // Mettre % jour les textareas existants si ils existent

            Object.entries(vieTeams).forEach(([teamId, team]) => {

                const textarea = document.getElementById(`team-${teamId}`);

                if (textarea) {

                    textarea.value = team.members.join('\n');

                }

            });

        }

        

        // Sauvegarder les changements d'%quipes depuis l'%diteur existant

        function saveTeamChangesFromEditor() {

            const vieTeams = getLifeTeams();

            const updatedTeams = { ...vieTeams };

            

            // Lire les textareas existants

            Object.keys(vieTeams).forEach(teamId => {

                const textarea = document.getElementById(`team-${teamId}`);

                if (textarea) {

                    const members = textarea.value.split('\n').filter(m => m.trim() !== '');

                    updatedTeams[teamId].members = members;

                }

            });

            

            // Sauvegarder

            const teams = loadTeams();

            teams.vie = updatedTeams;

            saveTeams(teams);

            

            // Recharger l'affichage

            loadAllTeams();

            

            alert(' %quipes sauvegard%es !');

        }

        

        // Charger les %quipes au d%marrage de la page %quipes

        document.addEventListener('DOMContentLoaded', function() {

            // Charger les %quipes quand la page %quipes est affich%e

            const originalShowPage = window.showPage;

            window.showPage = function(pageId) {

                originalShowPage(pageId);

                

                // V%rifier l'authentification admin sur changement de page

                checkAdminAuthOnPageChange();

                

                // Charger les %quipes si on affiche la page %quipes

                if (pageId === 'equipes') {

                    setTimeout(() => {

                        loadAllTeams();

                        updateTeamEditorWithCentralizedData();

                        // Ajouter les boutons d'%dition si admin connect%

                        addTeamEditingButtons();

                    }, 100);

                }

            };

        });



        // === GESTION ADMIN INFOS ===

        

        // Variables globales pour l'authentification

        let isAdminAuthenticated = false;

        

        // V%rifier l'authentification admin globale

        function checkGlobalAdminAuth() {

            const authStatus = localStorage.getItem('admin-authenticated');

            if (authStatus === 'true') {

                isAdminAuthenticated = true;

                showAdminTabs();

            } else {

                isAdminAuthenticated = false;

                hideAdminTabs();

            }

        }

        

        // Afficher les onglets admin

        function showAdminTabs() {

            document.getElementById('adminTab').style.display = 'inline-block';

            document.getElementById('registreTab').style.display = 'inline-block';

        }

        

        // Cacher les onglets admin

        function hideAdminTabs() {

            document.getElementById('adminTab').style.display = 'none';

            document.getElementById('registreTab').style.display = 'none';

        }

        

        // V%rifier l'authentification au chargement

        function checkAdminAuth() {

            // V%rifier si on est sur la page Infos

            const currentPage = document.querySelector('.fey-page.active') || document.getElementById('infos');

            if (!currentPage || currentPage.id !== 'infos') {

                document.getElementById('adminSection').style.display = 'none';

                return;

            }

            

            const authStatus = localStorage.getItem('admin-authenticated');

            if (authStatus === 'true') {

                showAdminSection();

                isAdminAuthenticated = true;

            } else {

                showAdminLogin();

            }

        }

        

        // Afficher la section admin avec authentification

        function showAdminSection() {

            document.getElementById('adminSection').style.display = 'block';

            document.getElementById('adminLoginSection').style.display = 'none';

            document.getElementById('adminAuthenticatedSection').style.display = 'block';

            loadInfoData();

            loadContacts();

        }

        

        // Afficher la section de connexion

        function showAdminLogin() {

            document.getElementById('adminSection').style.display = 'block';

            document.getElementById('adminLoginSection').style.display = 'block';

            document.getElementById('adminAuthenticatedSection').style.display = 'none';

        }

        

        // Connexion admin

        function loginAdmin() {

            const password = document.getElementById('adminPassword').value;

            

            if (password === 'Scout2025!') {

                localStorage.setItem('admin-authenticated', 'true');

                isAdminAuthenticated = true;

                showAdminSection();

                showAdminTabs();

                alert(' Connexion admin r%ussie !');

            } else {

                alert(' Mot de passe incorrect !');

                document.getElementById('adminPassword').value = '';

            }

        }

        

        // Fonction de d%connexion principale

        function logout() {

            // Nettoyer toutes les sessions

            sessionStorage.clear();

            localStorage.removeItem('admin-authenticated');

            

            // Retourner % la page de connexion

            document.getElementById('loginPage').style.display = 'block';

            document.getElementById('mainContent').style.display = 'none';

            

            // R%initialiser les champs

            const passwordInput = document.getElementById('passwordInput');

            if (passwordInput) {

                passwordInput.value = '';

            }

            

            // Masquer les onglets admin

            hideAdminTabs();

        }

        

        // D%connexion admin

        function logoutAdmin() {

            localStorage.removeItem('admin-authenticated');

            isAdminAuthenticated = false;

            showAdminLogin();

            hideAdminTabs();

            document.getElementById('adminPassword').value = '';

        }

        

        // Ajouter les boutons d'%dition des %quipes si admin connect%

        function addTeamEditingButtons() {

            const authStatus = localStorage.getItem('admin-authenticated');

            if (authStatus !== 'true') {

                removeTeamEditingButtons();

                return;

            }

            

            // Ajouter un bouton d'%dition global des %quipes

            const equipesHeader = document.querySelector('#equipes .fey-card-header');

            if (equipesHeader && !document.getElementById('editTeamsBtn')) {

                const editBtn = document.createElement('button');

                editBtn.id = 'editTeamsBtn';

                editBtn.innerHTML = ' %diter les %quipes';

                editBtn.className = 'fey-btn';

                editBtn.style.cssText = 'background: #FF9800; margin-left: 1rem; font-size: 0.9rem;';

                editBtn.onclick = showTeamEditorModal;

                

                equipesHeader.style.display = 'flex';

                equipesHeader.style.justifyContent = 'space-between';

                equipesHeader.style.alignItems = 'center';

                equipesHeader.appendChild(editBtn);

            }

            

            // Ajouter des boutons d'%dition sur chaque %quipe

            const teamCards = document.querySelectorAll('#equipes [style*="background:"]');

            teamCards.forEach(card => {

                if (!card.querySelector('.team-edit-btn')) {

                    const editBtn = document.createElement('button');

                    editBtn.className = 'team-edit-btn';

                    editBtn.innerHTML = '';

                    editBtn.style.cssText = 'position: absolute; top: 0.5rem; right: 0.5rem; background: rgba(255,255,255,0.9); border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer; z-index: 10;';

                    editBtn.onclick = (e) => {

                        e.stopPropagation();

                        editTeamFromCard(card);

                    };

                    card.style.position = 'relative';

                    card.appendChild(editBtn);

                }

            });

        }

        

        // Supprimer les boutons d'%dition des %quipes

        function removeTeamEditingButtons() {

            const editBtn = document.getElementById('editTeamsBtn');

            if (editBtn) {

                editBtn.remove();

            }

            

            const teamEditBtns = document.querySelectorAll('.team-edit-btn');

            teamEditBtns.forEach(btn => btn.remove());

        }

        

        // Afficher le modal d'%dition des %quipes

        function showTeamEditorModal() {

            // Rediriger vers la page admin pour l'%dition des %quipes

            window.open('admin.html', '_blank');

        }

        

        // %diter une %quipe depuis sa carte

        function editTeamFromCard(card) {

            const teamName = card.querySelector('h5, h4, h3')?.textContent || '%quipe';

            const teamMembers = card.querySelector('small, p')?.textContent || '';

            

            const newName = prompt('Nom de l\'%quipe:', teamName);

            if (newName === null) return;

            

            const newMembers = prompt('Membres (un par ligne):', teamMembers);

            if (newMembers === null) return;

            

            // Ici on pourrait impl%menter la sauvegarde directe

            // Pour l'instant, on affiche un message

            alert(' %quipe modifi%e ! (Modification d\'urgence - Pour une %dition compl%te, allez dans admin.html)');

        }

        

        // Charger les informations depuis localStorage

        function loadInfoData() {

            const data = JSON.parse(localStorage.getItem('scout-info-data') || '{}');

            

            // Donn%es par d%faut

            const defaultData = {

                nextOuting: {

                    title: 'Sortie en for%t',

                    date: '15 d%cembre 2024',

                    time: '09h00 - 17h00',

                    location: 'For%t de Compi%gne',

                    contact: 'Marie (06 12 34 56 78)'

                },

                meetingPlace: {

                    address: 'Local Scout, 123 Rue de la Paix, 60200 Compi%gne',

                    time: '08h30',

                    contact: 'Jean (06 98 76 54 32)'

                },

                general: {

                    responsable: 'Marie Dubois',

                    phone: '06 12 34 56 78',

                    email: 'marie.dubois@scouts.fr',

                    hours: 'Samedi 09h-17h'

                }

            };



            const infoData = { ...defaultData, ...data };

            

            // Afficher les donn%es

            document.getElementById('nextOutingTitle').textContent = infoData.nextOuting.title;

            document.getElementById('nextOutingDate').textContent = infoData.nextOuting.date;

            document.getElementById('nextOutingTime').textContent = infoData.nextOuting.time;

            document.getElementById('nextOutingLocation').textContent = infoData.nextOuting.location;

            document.getElementById('nextOutingContact').textContent = infoData.nextOuting.contact;



            document.getElementById('meetingPlaceAddress').textContent = infoData.meetingPlace.address;

            document.getElementById('meetingPlaceTime').textContent = infoData.meetingPlace.time;

            document.getElementById('meetingPlaceContact').textContent = infoData.meetingPlace.contact;



            document.getElementById('generalResponsable').textContent = infoData.general.responsable;

            document.getElementById('generalPhone').textContent = infoData.general.phone;

            document.getElementById('generalEmail').textContent = infoData.general.email;

            document.getElementById('generalHours').textContent = infoData.general.hours;

        }



        // === GESTION DES CONTACTS MULTIPLES ===

        

        // Charger les contacts

        function loadContacts() {

            const contacts = JSON.parse(localStorage.getItem('scout-contacts') || '[]');

            const container = document.getElementById('contactsList');

            

            if (contacts.length === 0) {

                // Contacts par d%faut

                const defaultContacts = [

                    {

                        id: 1,

                        name: 'Marie Dubois',

                        role: 'Cheftaine principale',

                        phone: '06 12 34 56 78',

                        email: 'marie.dubois@scouts.fr',

                        period: 'Toute l\'ann%e'

                    },

                    {

                        id: 2,

                        name: 'Jean Martin',

                        role: 'Assistant',

                        phone: '06 98 76 54 32',

                        email: 'jean.martin@scouts.fr',

                        period: 'Samedis'

                    }

                ];

                localStorage.setItem('scout-contacts', JSON.stringify(defaultContacts));

                displayContacts(defaultContacts);

            } else {

                displayContacts(contacts);

            }

        }

        

        // Afficher les contacts

        function displayContacts(contacts) {

            const container = document.getElementById('contactsList');

            

            if (contacts.length === 0) {

                container.innerHTML = '<p style="color: #666; text-align: center; font-style: italic;">Aucun contact configur%</p>';

                return;

            }

            

            const html = contacts.map(contact => `

                <div style="background: #f9f9f9; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1rem; margin-bottom: 1rem;">

                    <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 1rem;">

                        <div style="flex: 1;">

                            <h5 style="margin: 0 0 0.5rem 0; color: var(--c-orange-600);">${contact.name}</h5>

                            <p style="margin: 0.25rem 0; font-size: 0.9rem;"><strong>R%$%le:</strong> ${contact.role}</p>

                            <p style="margin: 0.25rem 0; font-size: 0.9rem;"><strong>T%l%phone:</strong> ${contact.phone}</p>

                            <p style="margin: 0.25rem 0; font-size: 0.9rem;"><strong>Email:</strong> ${contact.email}</p>

                            <p style="margin: 0.25rem 0; font-size: 0.9rem;"><strong>P%riode:</strong> ${contact.period}</p>

                        </div>

                        <div style="display: flex; gap: 0.5rem;">

                            <button onclick="editContact(${contact.id})" style="background: #2196F3; color: white; border: none; border-radius: 4px; padding: 0.5rem; font-size: 0.8rem; cursor: pointer;"></button>

                            <button onclick="deleteContact(${contact.id})" style="background: #f44336; color: white; border: none; border-radius: 4px; padding: 0.5rem; font-size: 0.8rem; cursor: pointer;"></button>

                        </div>

                    </div>

                </div>

            `).join('');

            

            container.innerHTML = html;

        }

        

        // Ajouter un nouveau contact

        function addNewContact() {

            const name = prompt('Nom du contact:');

            if (!name) return;

            

            const role = prompt('R%$%le (ex: Cheftaine, Assistant, etc.):');

            if (!role) return;

            

            const phone = prompt('T%l%phone:');

            if (!phone) return;

            

            const email = prompt('Email:');

            if (!email) return;

            

            const period = prompt('P%riode d\'activit% (ex: Toute l\'ann%e, Samedis, etc.):');

            if (!period) return;

            

            const contacts = JSON.parse(localStorage.getItem('scout-contacts') || '[]');

            const newContact = {

                id: Date.now(),

                name,

                role,

                phone,

                email,

                period

            };

            

            contacts.push(newContact);

            localStorage.setItem('scout-contacts', JSON.stringify(contacts));

            displayContacts(contacts);

        }

        

        // %diter un contact

        function editContact(contactId) {

            const contacts = JSON.parse(localStorage.getItem('scout-contacts') || '[]');

            const contact = contacts.find(c => c.id === contactId);

            if (!contact) return;

            

            const name = prompt('Nom du contact:', contact.name);

            if (name === null) return;

            

            const role = prompt('R%$%le:', contact.role);

            if (role === null) return;

            

            const phone = prompt('T%l%phone:', contact.phone);

            if (phone === null) return;

            

            const email = prompt('Email:', contact.email);

            if (email === null) return;

            

            const period = prompt('P%riode d\'activit%:', contact.period);

            if (period === null) return;

            

            // Mettre % jour le contact

            contact.name = name;

            contact.role = role;

            contact.phone = phone;

            contact.email = email;

            contact.period = period;

            

            localStorage.setItem('scout-contacts', JSON.stringify(contacts));

            displayContacts(contacts);

        }

        

        // Supprimer un contact

        function deleteContact(contactId) {

            if (confirm('%tes-vous s%W%r de vouloir supprimer ce contact ?')) {

                const contacts = JSON.parse(localStorage.getItem('scout-contacts') || '[]');

                const filtered = contacts.filter(c => c.id !== contactId);

                localStorage.setItem('scout-contacts', JSON.stringify(filtered));

                displayContacts(filtered);

            }

        }

        

        // %diter la prochaine sortie

        function editNextOuting() {

            const currentData = JSON.parse(localStorage.getItem('scout-info-data') || '{}').nextOuting || {};

            

            const title = prompt('Titre de la sortie:', currentData.title || 'Sortie en for%t');

            if (title === null) return;

            

            const date = prompt('Date:', currentData.date || '15 d%cembre 2024');

            if (date === null) return;

            

            const time = prompt('Heures (ex: 09h00 - 17h00):', currentData.time || '09h00 - 17h00');

            if (time === null) return;

            

            const location = prompt('Lieu:', currentData.location || 'For%t de Compi%gne');

            if (location === null) return;

            

            const contact = prompt('Contact:', currentData.contact || 'Marie (06 12 34 56 78)');

            if (contact === null) return;



            // Mettre % jour les donn%es

            const data = JSON.parse(localStorage.getItem('scout-info-data') || '{}');

            data.nextOuting = { title, date, time, location, contact };

            localStorage.setItem('scout-info-data', JSON.stringify(data));

            

            // Recharger l'affichage

            loadInfoData();

        }



        // %diter le lieu de rendez-vous

        function editMeetingPlace() {

            const currentData = JSON.parse(localStorage.getItem('scout-info-data') || '{}').meetingPlace || {};

            

            const address = prompt('Adresse du lieu de rendez-vous:', currentData.address || 'Local Scout, 123 Rue de la Paix, 60200 Compi%gne');

            if (address === null) return;

            

            const time = prompt('Heure habituelle:', currentData.time || '08h30');

            if (time === null) return;

            

            const contact = prompt('Contact local:', currentData.contact || 'Jean (06 98 76 54 32)');

            if (contact === null) return;



            // Mettre % jour les donn%es

            const data = JSON.parse(localStorage.getItem('scout-info-data') || '{}');

            data.meetingPlace = { address, time, contact };

            localStorage.setItem('scout-info-data', JSON.stringify(data));

            

            // Recharger l'affichage

            loadInfoData();

        }



        // %diter les informations g%n%rales

        function editGeneralInfo() {

            const currentData = JSON.parse(localStorage.getItem('scout-info-data') || '{}').general || {};

            

            const responsable = prompt('Responsable:', currentData.responsable || 'Marie Dubois');

            if (responsable === null) return;

            

            const phone = prompt('T%l%phone:', currentData.phone || '06 12 34 56 78');

            if (phone === null) return;

            

            const email = prompt('Email:', currentData.email || 'marie.dubois@scouts.fr');

            if (email === null) return;

            

            const hours = prompt('Horaires habituels:', currentData.hours || 'Samedi 09h-17h');

            if (hours === null) return;



            // Mettre % jour les donn%es

            const data = JSON.parse(localStorage.getItem('scout-info-data') || '{}');

            data.general = { responsable, phone, email, hours };

            localStorage.setItem('scout-info-data', JSON.stringify(data));

            

            // Recharger l'affichage

            loadInfoData();

        }



        // Sauvegarder toutes les informations

        function saveAllInfo() {

            alert(' Toutes les informations ont %t% sauvegard%es automatiquement !');

        }



        // R%initialiser toutes les informations

        function resetAllInfo() {

            if (confirm(' %tes-vous s%W%r de vouloir r%initialiser toutes les informations ?')) {

                localStorage.removeItem('scout-info-data');

                loadInfoData();

                alert(' Informations r%initialis%es !');

            }

        }



        // Fonction pour v%rifier l'authentification admin sur changement de page

        function checkAdminAuthOnPageChange() {

            setTimeout(() => {

                checkAdminAuth();

            }, 100);

        }

        

        // Charger les informations au d%marrage

        document.addEventListener('DOMContentLoaded', function() {

            loadInfoData();

            checkGlobalAdminAuth();

            checkAdminAuth();

        });

    </script>

</body>

</html>



