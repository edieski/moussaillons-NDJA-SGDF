<!DOCTYPE html>

<html lang="fr">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Mon Carnet d'Aventure Scout ğŸŒ²</title>

    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles/main.css">

    <style>

        @keyframes floatUp {

            0% {

                transform: translateY(0) scale(1);

                opacity: 1;

            }

            100% {

                transform: translateY(-50px) scale(0.5);

                opacity: 0;

            }

        }

        

        @keyframes shake {

            0%, 100% { transform: translateX(0); }

            25% { transform: translateX(-5px); }

            75% { transform: translateX(5px); }

        }

        

        @keyframes slideIn {

            from {

                transform: translateX(100%);

                opacity: 0;

            }

            to {

                transform: translateX(0);

                opacity: 1;

            }

        }

        

        @keyframes slideOut {

            from {

                transform: translateX(0);

                opacity: 1;

            }

            to {

                transform: translateX(100%);

                opacity: 0;

            }

        }

    </style>

</head>

<body>

    <!-- DÃ©cor forÃªt animÃ©e -->

    <div class="moonlight-rays"></div>

    <div class="magic-trees" id="trees"></div>

    <div class="fey-leaves" id="leaves"></div>

    <div class="fey-fireflies" id="fireflies"></div>

    <div class="fairy-sparkles" id="sparkles"></div>

    <div class="fairy-wings" id="wings"></div>

    <div class="magic-mushrooms" id="mushrooms"></div>

    <div class="starlight-twinkle" id="stars"></div>



    <!-- Page de connexion -->

    <div id="loginPage" class="fey-container" style="display: none;">

        <h1 class="fey-title">ğŸ” AccÃ¨s Scout ğŸ”</h1>

        <p class="fey-subtitle">Entrez le mot de passe pour accÃ©der au carnet d'aventure</p>



        <div class="fey-card" style="max-width: 400px; margin: 2rem auto;">

            <div class="fey-card-header">ğŸ›¡ï¸ Authentification</div>

            <div style="text-align: center;">

                <input type="password" id="passwordInput" placeholder="Mot de passe scout..."

                       style="width: 100%; padding: 1rem; font-size: 1.1rem; border: 3px solid var(--c-ink-900); border-radius: var(--r-sm); margin-bottom: 1rem; font-family: 'Patrick Hand', cursive;">

                <button id="loginBtn" class="fey-btn" style="width: 100%; font-size: 1.2rem;">

                    ğŸŒ² Entrer dans l'aventure ğŸŒ²

                </button>

                <div id="errorMessage" style="color: #d32f2f; margin-top: 1rem; font-weight: bold; display: none;">

                    âŒ Mot de passe incorrect !

                </div>

            </div>

        </div>



        <div class="fey-note" style="text-align: center; max-width: 500px; margin: 2rem auto;">

            <strong>ğŸ•ï¸ Carnet d'aventure scout</strong><br>

            Ce site contient des informations privÃ©es pour les scouts et leurs familles.

        </div>

    </div>



    <!-- Contenu principal -->

    <div id="mainContent" class="fey-container" style="display: block;">

        <h1 class="fey-title">ğŸŒ² Mon carnet d'aventure ğŸŒ²</h1>

        <p class="fey-subtitle">Prochaine sortie Ã  Jambville Â· Octobre 2025</p>



        <nav class="fey-nav">

            <button class="fey-tab" onclick="window.location.href='index.html'">ğŸ  Accueil</button>

            <button class="fey-tab active" onclick="window.location.href='liste.html'">ğŸ“‹ Ma Liste</button>

            <button class="fey-tab" onclick="window.showPage('tente')">â›º La Tente</button>

            <button class="fey-tab" onclick="window.showPage('infos')">ğŸ“± Infos</button>

            <button class="fey-tab" onclick="window.showPage('equipes')">ğŸ‘¥ Ã‰quipes</button>

            <button class="fey-tab" onclick="window.location.href='calendrier.html'">ğŸ“… Calendrier</button>

            <button class="fey-tab" onclick="window.location.href='planning_prochaine_sortie.html'">ğŸŒŠ Planning Sortie</button>

            <button class="fey-tab" onclick="window.location.href='carpool-link.html'">ğŸš— Covoiturage</button>

            <button class="fey-tab" onclick="window.location.href='presence.html'">ğŸ“‹ PrÃ©sence</button>

            <button class="fey-tab" onclick="window.showPage('chansons')">ğŸµ Chansons</button>

            <button class="fey-tab" onclick="window.showPage('marin')">âš“ Marin</button>

            <button class="fey-tab" onclick="window.showPage('loi')">ğŸ“œ Loi Scout</button>

            <button class="fey-tab" onclick="window.showPage('admin')" id="adminTab" style="display: none; background: #9C27B0; color: white;">âš™ï¸ Admin</button>

            <button class="fey-tab" onclick="window.showPage('registre')" id="registreTab" style="display: none; background: #FF5722; color: white;">ğŸ“‹ Registre d'Appel</button>

            <button class="fey-tab" onclick="logout()" style="background: #d32f2f; color: white;">ğŸšª DÃ©connexion</button>

        </nav>



        <!-- PAGE 2: TENTE -->

        <div id="tente" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                â›º Comment monter une tente canadienne ?

            </div>



            <div class="fey-card" style="margin-bottom: 2rem;">

                <div class="fey-card-header">ğŸ“¹ Tutoriel VidÃ©o</div>

                <div style="background: linear-gradient(135deg, #4CAF50, #45a049); color: white; padding: 2rem; border-radius: var(--r-md); text-align: center; border: 3px solid var(--c-ink-900);">

                    <div style="font-size: 4rem; margin-bottom: 1rem;">ğŸ¬</div>

                    <h3 style="font-family: 'Patrick Hand', cursive; font-size: 1.5rem; margin-bottom: 1rem;">

                        VidÃ©o de Montage de Tente

                    </h3>

                    <p style="margin-bottom: 1.5rem; font-size: 1.1rem;">

                        Regarde cette vidÃ©o pour apprendre Ã  monter ta tente Ã©tape par Ã©tape !

                    </p>

                    <button class="fey-btn" onclick="ouvrirVideoTutorial()" style="background: #FF6B35; font-size: 1.2rem; padding: 1rem 2rem;">

                        ğŸ“º Regarder la VidÃ©o

                    </button>

                    <div style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.9;">

                        ğŸ’¡ Ou joue au jeu interactif ci-dessous pour t'entraÃ®ner !

                    </div>

                </div>

            </div>





            <div class="fey-card">

                <div class="fey-card-header">ğŸ“‹ Technique Rapide - Guide Visuel</div>

                <div style="background: linear-gradient(135deg, #2E7D32, #4CAF50); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); margin-bottom: 1rem;">

                    <h3 style="font-family: 'Patrick Hand', cursive; font-size: 1.5rem; margin-bottom: 1rem; text-align: center; color: #FFD166;">ğŸ¯ Guide Visuel des Ã‰tapes</h3>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸŒ±</div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">1. Pose la bÃ¢che de sol</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Ã‰tale la bÃ¢che Ã  plat, sans plis.</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: linear-gradient(to bottom, #4CAF50 0%, #2E7D32 100%); border-radius: 6px; position: relative; border: 2px solid #1B5E20;">

                                <div style="position: absolute; top: 0; left: 0; right: 0; height: 15px; background: linear-gradient(90deg, #4CAF50, #66BB6A, #4CAF50); border-radius: 4px 4px 0 0;"></div>

                            </div>

                            <ul style="text-align: left; margin: 0.5rem 0 0; padding-left: 1.1rem; font-size: 0.9rem; line-height: 1.4;">
                                <li>âœ… Ã‰tale la bÃ¢che Ã  lâ€™endroit choisi.</li>
                                <li>âœ… Elle ne doit pas dÃ©passer de la tente.</li>
                                <li>âœ… Si le sol est humide, remonte un peu les bords.</li>
                            </ul>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ§º</div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">2. Piquette le toit (la toile)</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Ã€ cÃ´tÃ© de la bÃ¢che, dÃ©plie la toile et pique les 4 coins.</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 6px; left: 6px; right: 6px; top: 6px; border: 2px dashed #FFD166; border-radius: 4px;"></div>

                            </div>

                            <ul style="text-align: left; margin: 0.5rem 0 0; padding-left: 1.1rem; font-size: 0.9rem; line-height: 1.4;">
                                <li>âœ… DÃ©plie la toile Ã  cÃ´tÃ© de la bÃ¢che.</li>
                                <li>âœ… Tends-la et plante un piquet Ã  chaque coin.</li>
                                <li>âœ… VÃ©rifie le sens de la porte.</li>
                            </ul>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“</div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">3. Mets le toit sur la bÃ¢che</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Aligne les coins avec la bÃ¢che et replace les piquets si besoin.</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 6px; right: 6px; width: 6px; height: 6px; background: #FFD166; border-radius: 50%;"></div>

                                <div style="position: absolute; bottom: 6px; left: 6px; width: 6px; height: 6px; background: #FFD166; border-radius: 50%;"></div>

                                <div style="position: absolute; top: 6px; left: 6px; width: 6px; height: 6px; background: #FFD166; border-radius: 50%;"></div>

                                <div style="position: absolute; top: 6px; right: 6px; width: 6px; height: 6px; background: #FFD166; border-radius: 50%;"></div>

                            </div>

                            <ul style="text-align: left; margin: 0.5rem 0 0; padding-left: 1.1rem; font-size: 0.9rem; line-height: 1.4;">
                                <li>âœ… Retire 1â€“2 piquets du cÃ´tÃ© de la bÃ¢che.</li>
                                <li>âœ… DÃ©place la toile et poseâ€‘la sur la bÃ¢che.</li>
                                <li>âœ… Replace et serre les 4 coins bien droits.</li>
                            </ul>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ—ï¸</div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">4. Mets les mÃ¢ts et la barre</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Glisse la barre en haut et redresse les deux mÃ¢ts.</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 0; left: 20%; width: 3px; height: 35px; background: #8B4513;"></div>

                                <div style="position: absolute; bottom: 0; right: 20%; width: 3px; height: 35px; background: #8B4513;"></div>

                                <div style="position: absolute; top: 4px; left: 20%; right: 20%; height: 3px; background: #FFD166;"></div>

                            </div>

                            <ul style="text-align: left; margin: 0.5rem 0 0; padding-left: 1.1rem; font-size: 0.9rem; line-height: 1.4;">
                                <li>âœ… Assemble les deux mÃ¢ts et la barre du haut.</li>
                                <li>âœ… Place un mÃ¢t Ã  l'entrÃ©e et un au fond.</li>
                                <li>âœ… Redresse doucement sans tirer fort sur la toile.</li>
                            </ul>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ”—</div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">5. Tends les haubans (45Â°)</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Piquets Ã  45Â°; serre un peu Ã  gauche/droite en alternance.</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 2px; height: 30px; background: #8B4513;"></div>

                                <div style="position: absolute; top: 15px; left: 15px; right: 15px; height: 1px; background: #FFD166; transform: rotate(-15deg);"></div>

                                <div style="position: absolute; top: 8px; right: 5px; font-size: 8px; color: #FFD166; font-weight: bold;">45Â°</div>

                            </div>

                            <ul style="text-align: left; margin: 0.5rem 0 0; padding-left: 1.1rem; font-size: 0.9rem; line-height: 1.4;">
                                <li>âœ… Accroche les cordes aux points prÃ©vus.</li>
                                <li>âœ… Plante les piquets Ã  45Â° vers l'extÃ©rieur.</li>
                                <li>âœ… Tends un peu chaque corde en alternant les cÃ´tÃ©s.</li>
                            </ul>

                        </div>

                        <div style="background: rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1rem; border: 2px solid rgba(255, 255, 255, 0.2); text-align: center; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255, 255, 255, 0.2)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.transform='translateY(0)'">

                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸŒ§ï¸</div>

                            <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem; color: #FFD166;">6. Mets le doubleâ€‘toit</div>

                            <div style="font-size: 0.9rem; line-height: 1.4;">Pose centrÃ©, attache sans Ã©craser, laisse de lâ€™air pour ventiler.</div>

                            <div style="width: 60px; height: 40px; margin: 0.5rem auto; background: #2C3E50; border-radius: 6px; position: relative;">

                                <div style="position: absolute; bottom: 0; left: 8px; right: 8px; height: 20px; background: linear-gradient(135deg, #8B4513, #A0522D); border-radius: 3px;"></div>

                                <div style="position: absolute; top: 8px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 20px solid transparent; border-right: 20px solid transparent; border-bottom: 15px solid #FFD166;"></div>

                            </div>

                            <ul style="text-align: left; margin: 0.5rem 0 0; padding-left: 1.1rem; font-size: 0.9rem; line-height: 1.4;">
                                <li>âœ… Pose le doubleâ€‘toit bien centrÃ©.</li>
                                <li>âœ… Attache les sangles/Ã©lastiques sans Ã©craser la toile.</li>
                                <li>âœ… Laisse un espace d'air pour Ã©viter la condensation.</li>
                            </ul>

                        </div>

                    </div>

                </div>

            </div>



            <div class="fey-note">

                <strong>ğŸ’¡ Astuce :</strong> Creuse une petite rigole autour de la tente pour Ã©vacuer l'eau de pluie !

            </div>



            <div class="fey-card" style="margin-top: 2rem;">

                <div class="fey-card-header">ğŸ® Jeu Interactif</div>

                <div class="fey-note">

                    <strong>ğŸ¯ PrÃªt Ã  mettre en pratique ?</strong><br>

                    Teste tes connaissances avec notre jeu interactif de montage de tente !

                </div>

                <div style="text-align: center; margin-top: 1.5rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                    <button class="fey-btn" onclick="ouvrirJeuTente()" style="font-size: 1.1rem; padding: 1rem 1.5rem;">

                        ğŸ® Jeu de Tente 1 ğŸ®

                    </button>

                    <button class="fey-btn" onclick="ouvrirJeuTente2()" style="font-size: 1.1rem; padding: 1rem 1.5rem;">

                        ğŸ® Jeu de Tente 2 ğŸ®

                    </button>

                </div>

                <div class="fey-note" style="background: rgba(139, 90, 43, 0.1); border-left: 4px solid #8B5A2B; margin-top: 1rem;">

                    <strong>ğŸ† DÃ©fi :</strong> Monte ta tente en 6 Ã©tapes et gagne des points !<br>

                    <strong>ğŸ“‹ Bonus :</strong> Utilise le guide visuel ci-dessus pour t'aider !

                </div>

            </div>

        </div>
        <!-- PAGE 3: INFOS -->
        <div id="infos" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                ğŸ“± Informations & Contact

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 6px solid #4CAF50;">

                <div class="fey-card-header">ğŸ“… Dates & Horaires</div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ“…</div>

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 0.5rem;" id="info-outing-name">Week-end Scout</h3>

                        <p><strong id="info-outing-dates">Du 25 au 27 octobre 2025</strong></p>

                        <p style="font-size: 0.9rem; color: #666;">3 jours d'aventure !</p>

                    </div>

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸš—</div>

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 0.5rem;">DÃ©part</h3>

                        <p><strong id="info-departure-time">Vendredi 8h30</strong></p>

                        <p style="font-size: 0.9rem; color: #666;" id="info-departure-location">Ã‰cole Notre-Dame</p>

                    </div>

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900); text-align: center;">

                        <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ </div>

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 0.5rem;">Retour</h3>

                        <p><strong id="info-return-time">Dimanche 17h00</strong></p>

                        <p style="font-size: 0.9rem; color: #666;">MÃªme lieu</p>

                    </div>

                </div>

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 6px solid #FF9800;">

                <div class="fey-card-header">ğŸ“ Lieu & Contact</div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem;">

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900);">

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem;">ğŸ•ï¸ Lieu du Camp</h3>

                        <p><strong id="info-camp-location">Jambville (78440)</strong></p>

                        <p style="font-size: 0.9rem; color: #666;">Centre de formation scout</p>

                        <button class="fey-btn" onclick="ouvrirMaps()" style="margin-top: 1rem; width: 100%;">ğŸ—ºï¸ Voir sur la carte</button>

                    </div>

                    <div style="background: white; padding: 1.5rem; border-radius: 12px; border: 2px solid var(--c-ink-900);">

                        <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem;">ğŸ“ Contacts</h3>

                        <div id="info-contacts-list">

                            <!-- Les contacts seront chargÃ©s dynamiquement -->

                        </div>

                        <button class="fey-btn" onclick="ouvrirWhatsApp()" style="margin-top: 1rem; width: 100%; background: #25D366;">ğŸ’¬ WhatsApp</button>

                    </div>

                </div>

            </div>



            <!-- Section Documents Parents -->

            <div class="fey-card" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 6px solid #2196F3;">

                <div class="fey-card-header">ğŸ“ Documents pour les Parents</div>

                <div style="text-align: center; padding: 2rem;">

                    <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“š</div>

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-marine-700); margin-bottom: 1rem;">Drive des Documents</h3>

                    <p style="margin-bottom: 2rem; font-size: 1.1rem;">AccÃ©dez aux documents importants, autorisations, listes et informations pour les parents.</p>

                    <button class="fey-btn" onclick="ouvrirDrive()" style="background: #2196F3; font-size: 1.2rem; padding: 1rem 2rem;">

                        ğŸ“ AccÃ©der au Drive

                    </button>

                </div>

            </div>



            <div class="fey-qr-grid">

                <div class="fey-qr-card">

                    <h3>ğŸ’¬ Groupe WhatsApp Parents</h3>

                    <div class="fey-qr-code">

                        <img src="./images/frame.png" alt="QR Code WhatsApp Parents" style="max-width: 150px; height: auto; border-radius: 8px;">

                    </div>

                    <p>Scannez le QR code pour rejoindre le groupe WhatsApp des parents</p>

                    <button class="fey-btn" style="margin-top: 1rem; background: #25D366;" onclick="ouvrirWhatsApp()">âœ¨ Rejoindre le groupe</button>

                </div>



                <div class="fey-qr-card">

                    <h3>ğŸ“… Calendrier des Ã‰vÃ©nements Scouts</h3>

                    <div style="margin: 1rem 0; background: #f5f5f5; padding: 1rem; border-radius: 8px;">

                        <p style="text-align: center; color: #666; margin-bottom: 1rem;">Consultez tous les Ã©vÃ©nements et sorties prÃ©vus</p>

                        <div style="width: 100%; height: 400px; border-radius: 8px; overflow: hidden; border: 2px solid var(--c-ink-900);">

                            <iframe 

                                src="https://calendar.google.com/calendar/embed?height=400&wkst=1&ctz=Europe%2FParis&showPrint=0&src=ZWVmZmI4OGNlZTAyMWMzNDJjNjQwZmVmYTI1Y2FlMWNkMDcyYjlhMWY1Yjk1ZWFlODFiZDk5MTM0ZWVlM2ViYkBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&color=%23f09300" 

                                style="border: none; width: 100%; height: 100%;" 

                                frameborder="0" 

                                scrolling="no">

                            </iframe>

                        </div>

                        <p style="text-align: center; color: #666; margin-top: 0.5rem; font-size: 0.9rem;">

                            ğŸ“± Le calendrier se met Ã  jour automatiquement

                        </p>

                    </div>

                </div>

            </div>

        </div>



        <!-- SECTION ADMIN INFOS -->

        <div id="adminSection" class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 6px solid #FF9800; margin-top: 2rem; display: none;">

            <div class="fey-card-header">âš™ï¸ Administration - Informations Pratiques</div>

            <div style="padding: 1.5rem;">

                <!-- Bouton de connexion admin -->

                <div id="adminLoginSection" style="text-align: center; margin-bottom: 2rem; padding: 2rem; background: white; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                    <h3 style="color: var(--c-orange-600); margin-bottom: 1rem;">ğŸ” Connexion Administrateur</h3>

                    <p style="margin-bottom: 1.5rem; color: #666;">Entrez le mot de passe administrateur pour accÃ©der aux fonctions d'Ã©dition.</p>

                    <div style="display: flex; gap: 1rem; justify-content: center; align-items: center; flex-wrap: wrap;">

                        <input type="password" id="adminPassword" placeholder="Mot de passe admin" 

                               style="padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); font-size: 1rem; min-width: 200px;">

                        <button class="fey-btn" onclick="loginAdmin()" style="background: #FF9800;">ğŸ”“ Se connecter</button>

                    </div>

                    <p style="margin-top: 1rem; font-size: 0.8rem; color: #666;">

                        Mot de passe admin: <strong>Scout2025!</strong>

                    </p>

                </div>



                <!-- Section admin authentifiÃ©e -->

                <div id="adminAuthenticatedSection" style="display: none;">

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">

                        <p style="color: #666; margin: 0;">Modifiez les dates, horaires et lieux des sorties directement depuis cette page.</p>

                        <button class="fey-btn" onclick="logoutAdmin()" style="background: #f44336; font-size: 0.9rem;">ğŸšª DÃ©connexion</button>

                    </div>

                

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">

                    <!-- Prochaine Sortie -->

                    <div style="background: white; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem;">

                        <h4 style="color: var(--c-orange-600); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">

                            ğŸ“… Prochaine Sortie

                            <button onclick="editNextOuting()" style="background: #FF9800; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer;">âœï¸</button>

                        </h4>

                        <div id="nextOutingInfo">

                            <p><strong>Titre:</strong> <span id="nextOutingTitle">Sortie en forÃªt</span></p>

                            <p><strong>Date:</strong> <span id="nextOutingDate">15 dÃ©cembre 2024</span></p>

                            <p><strong>Heure:</strong> <span id="nextOutingTime">09h00 - 17h00</span></p>

                            <p><strong>Lieu:</strong> <span id="nextOutingLocation">ForÃªt de CompiÃ¨gne</span></p>

                            <p><strong>Contact:</strong> <span id="nextOutingContact">Marie (06 12 34 56 78)</span></p>

                        </div>

                    </div>



                    <!-- Lieu de Rendez-vous -->

                    <div style="background: white; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem;">

                        <h4 style="color: var(--c-orange-600); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">

                            ğŸ“ Lieu de Rendez-vous

                            <button onclick="editMeetingPlace()" style="background: #FF9800; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer;">âœï¸</button>

                        </h4>

                        <div id="meetingPlaceInfo">

                            <p><strong>Adresse:</strong> <span id="meetingPlaceAddress">Local Scout, 123 Rue de la Paix, 60200 CompiÃ¨gne</span></p>

                            <p><strong>Heure habituelle:</strong> <span id="meetingPlaceTime">08h30</span></p>

                            <p><strong>Contact local:</strong> <span id="meetingPlaceContact">Jean (06 98 76 54 32)</span></p>

                        </div>

                    </div>



                    <!-- Informations GÃ©nÃ©rales -->

                    <div style="background: white; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem;">

                        <h4 style="color: var(--c-orange-600); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">

                            â„¹ï¸ Informations GÃ©nÃ©rales

                            <button onclick="editGeneralInfo()" style="background: #FF9800; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer;">âœï¸</button>

                        </h4>

                        <div id="generalInfo">

                            <p><strong>Responsable:</strong> <span id="generalResponsable">Marie Dubois</span></p>

                            <p><strong>TÃ©lÃ©phone:</strong> <span id="generalPhone">06 12 34 56 78</span></p>

                            <p><strong>Email:</strong> <span id="generalEmail">marie.dubois@scouts.fr</span></p>

                            <p><strong>Horaires habituels:</strong> <span id="generalHours">Samedi 09h-17h</span></p>

                        </div>

                    </div>



                    <!-- Gestion des Contacts AnnÃ©e -->

                    <div style="background: white; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem; grid-column: 1 / -1;">

                        <h4 style="color: var(--c-orange-600); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">

                            ğŸ‘¥ Contacts de l'AnnÃ©e

                            <button onclick="addNewContact()" style="background: #4CAF50; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 0.8rem; cursor: pointer;">â•</button>

                        </h4>

                        <div id="contactsList">

                            <!-- Les contacts seront chargÃ©s ici -->

                        </div>

                    </div>

                </div>



                <div style="margin-top: 1.5rem; text-align: center;">

                    <button class="fey-btn" onclick="saveAllInfo()" style="background: #4CAF50; margin-right: 1rem;">

                        ğŸ’¾ Sauvegarder toutes les informations

                    </button>

                    <button class="fey-btn" onclick="resetAllInfo()" style="background: #f44336;">

                        ğŸ”„ RÃ©initialiser

                    </button>

                </div>

                </div>

            </div>

        </div>



        <!-- PAGE 4: Ã‰QUIPES -->

        <div id="equipes" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                ğŸ‘¥ Les Ã‰quipes de Vie

            </div>



            <div class="fey-note" style="margin-bottom: 2rem;">

                <strong>ğŸ•ï¸ C'est quoi une Ã©quipe de vie ?</strong><br>

                Pendant le week-end, tu feras partie d'une petite Ã©quipe. Ensemble, vous monterez votre tente, prÃ©parerez les repas et vivrez de super aventures !

            </div>



            <div id="vieTeamsDisplay" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem;">

                <!-- Les Ã©quipes de vie seront chargÃ©es dynamiquement -->

            </div>



            <div class="fey-note" style="margin-top: 2rem;">

                <strong>ğŸ’ª Missions d'Ã©quipe :</strong><br>

                â€¢ Monter et ranger la tente ensemble<br>

                â€¢ PrÃ©parer les repas<br>

                â€¢ Participer aux grands jeux<br>

                â€¢ S'entraider et faire vivre la bonne humeur !

            </div>



            <div class="fey-card" style="margin-top: 2rem;">

                <div class="fey-card-header">ğŸŒ™ Ã‰quipes de Nuit</div>

                <div class="fey-note">

                    <strong>ğŸŒ™ C'est quoi une Ã©quipe de nuit ?</strong><br>

                    Pendant la nuit, vous serez rÃ©partis en petites Ã©quipes pour dormir ensemble dans vos tentes. C'est l'occasion de partager des moments calmes et de crÃ©er des liens !

                </div>



                <div id="nuitTeamsDisplay" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">

                    <!-- Les Ã©quipes de nuit seront chargÃ©es dynamiquement -->

                </div>

            </div>



            <!-- Registres des Sorties -->

            <div class="fey-card" style="margin-top: 2rem; background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800;">

                <div class="fey-card-header">ğŸ“‹ Registres des Sorties</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong>ğŸ“ Gestion des registres</strong><br>

                    SÃ©lectionnez une sortie pour gÃ©rer les prÃ©sences et les Ã©quipes.<br>

                    <strong>ğŸ’¡ Si aucune sortie n'apparaÃ®t :</strong> Cliquez sur le bouton "ğŸ”„ Recharger" Ã  cÃ´tÃ© de la liste dÃ©roulante.

                </div>

                

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 1rem;">

                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… SÃ©lectionner une sortie</label>

                        <div style="display: flex; gap: 0.5rem; align-items: center;">

                            <select id="tripSelector" onchange="loadTripRegistry()" style="flex: 1; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            <option value="">-- Choisir une sortie --</option>

                            <!-- Les options seront chargÃ©es dynamiquement depuis le calendrier -->

                        </select>

                            <button onclick="loadTripsFromCalendar()" class="fey-btn" style="background: #2196F3; padding: 0.75rem; white-space: nowrap;">

                                ğŸ”„ Recharger

                            </button>

                        </div>

                    </div>

                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ‘¥ Gestion des Ã©quipes</label>

                        <button onclick="toggleTeamEdit()" class="fey-btn" style="background: #9C27B0; width: 100%;">

                            âœï¸ Modifier les Ã©quipes

                        </button>

                    </div>

                </div>



                <!-- Zone d'Ã©dition des Ã©quipes -->

                <div id="teamEditZone" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.1); border-radius: var(--r-sm);">

                    <h4 style="margin-bottom: 1rem;">âœï¸ Ã‰dition des Ã©quipes</h4>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ¦ Les Lions</label>

                            <textarea id="team-lions" rows="6" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">Oscar

Jules R

Dante

LÃ©opold

Lev

Alexia</textarea>

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ¦… Les Aigles</label>

                            <textarea id="team-aigles" rows="6" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">Alfred

Jules P
Felix
Gabriel
Octave
Constance</textarea>

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸº Les Loups</label>

                            <textarea id="team-loups" rows="6" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">Romane

Louison

Madeleine

Claire

LÃ©a Leal

Jeanne</textarea>

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ¦Š Les Renards</label>

                            <textarea id="team-renards" rows="6" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">Gabrielle Wargnier

LÃ©a F
Sybille
Ambre</textarea>

                        </div>

                    </div>

                    <div style="margin-top: 1rem; display: flex; gap: 1rem;">

                        <button onclick="saveTeamChangesFromEditor()" class="fey-btn" style="background: #4CAF50;">ğŸ’¾ Sauvegarder</button>

                        <button onclick="cancelTeamEdit()" class="fey-btn" style="background: #f44336;">âŒ Annuler</button>

                    </div>

                </div>



                <!-- Registre de prÃ©sence -->

                <div id="tripRegistry" style="display: none; margin-top: 1rem;">

                    <h4 style="margin-bottom: 1rem;">ğŸ“ Registre de prÃ©sence</h4>

                    <div id="registryContent">

                        <!-- Contenu chargÃ© dynamiquement -->

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE 7: CHANSONS -->

        <div id="chansons" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                ğŸµ Chansons & PriÃ¨res

            </div>



            <div class="fey-card">

                <div class="fey-card-header">ğŸŒ… PriÃ¨res du matin</div>

                <div class="fey-note">

                    <strong>ğŸ™ PriÃ¨re scoute du matin :</strong><br>

                    "Seigneur, aide-moi Ã  Ãªtre un bon scout aujourd'hui. Donne-moi la force d'aider les autres et de respecter la nature. Amen."

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header">ğŸŒ™ PriÃ¨re Scoute Officielle</div>

                <div class="fey-note" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                    <strong>ğŸµ Ã‰coute la priÃ¨re scoute :</strong><br>

                    <div style="margin: 1rem 0;">

                        <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/track/4I7UDLZJvbYkQQCRXVw9WL?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

                    </div>

                </div>



                <div class="fey-note" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800; margin-top: 1rem;">

                    <strong>ğŸ“œ Paroles de la PriÃ¨re Scoute :</strong><br>

                    <div style="font-family: 'Patrick Hand', cursive; font-size: 1.1rem; line-height: 1.6; color: var(--c-forest-700); margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm);">

                        <strong>Seigneur JÃ©sus,</strong><br>

                        Apprenez-nous Ã  Ãªtre gÃ©nÃ©reux,<br>

                        A Vous servir comme Vous le mÃ©ritez<br>

                        A donner sans compter,<br>

                        A combattre sans souci des blessures,<br>

                        A travailler sans chercher le repos,<br>

                        A nous dÃ©penser, sans attendre d'autre rÃ©compense,<br>

                        que celle de savoir que nous faisons Votre Sainte VolontÃ©.

                    </div>

                </div>

            </div>



            <div class="fey-card">

                <div class="fey-card-header">ğŸ¶ Chansons Scoutes Ã  ConnaÃ®tre</div>

                <div class="fey-note" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50;">

                    <strong>ğŸµ Playlist des chansons scoutes essentielles :</strong><br>

                    <div style="margin: 1rem 0;">

                        <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/0udNpspSVRNHFyFd3OhyqA?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

                    </div>

                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm);">

                        <strong>ğŸ“š Chansons incluses :</strong><br>

                        â€¢ <strong>Moins Sollanel</strong> - Chanson traditionnelle scout<br>

                        â€¢ Chansons de veillÃ©e et de marche<br>

                        â€¢ Chansons de camaraderie<br>

                        â€¢ Chansons de la nature et de l'aventure<br>

                        <em style="color: var(--c-forest-700); font-size: 0.9rem;">Ces chansons sont souvent chantÃ©es lors des activitÃ©s scoutes !</em>

                    </div>

                </div>

            </div>

        </div>



        <!-- PAGE 6: MARIN -->

        <div id="marin" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                âš“ Marin

            </div>



            <div class="fey-card">

                <div class="fey-card-header">ğŸš¢ Ã€ venir</div>

                <div class="fey-note" style="text-align: center; padding: 2rem;">

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; font-size: 1.5rem;">

                        ğŸ—ï¸ Section en construction

                    </h3>

                    <p>Cette section sera bientÃ´t disponible avec du contenu marin spÃ©cialement conÃ§u pour les scouts !</p>

                </div>

            </div>

        </div>



        <!-- PAGE 7: LOI SCOUT -->
        <div id="loi" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                ğŸ“œ Loi Scout - Loi des Sylphes

            </div>



            <div class="fey-card">

                <div class="fey-card-header">ğŸ§šâ€â™€ï¸ La Loi des Sylphes</div>

                <div class="fey-note">

                    <strong>ğŸŒ¿ Les Sylphes nous enseignent Ã  vivre en harmonie avec la nature et les autres.</strong><br>

                    Voici comment ils nous guideraient dans nos comportements quotidiens :

                </div>

            </div>



            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin: 2rem 0;">

                <div style="background: linear-gradient(135deg, #8e44ad, #9b59b6); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #8e44ad; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;">ğŸŒ±</div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">VRAI - YzÃ´</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Moral</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je donne mon avis et je fais ce que je dis."</p>

                </div>



                <div style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #27ae60; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;">â˜ï¸</div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">RESPECTUEUX - Kawane</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Affectif</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je prends soin de moi et des autres."</p>

                </div>



                <div style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #f39c12; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;">ğŸŒŠ</div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">DÃ‰BROUILLARD - ThÃ©la</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Intellectuel</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je dÃ©couvre le monde et je crÃ©e de mes mains. Je protÃ¨ge notre planÃ¨te."</p>

                </div>



                <div style="background: linear-gradient(135deg, #8e44ad, #9b59b6); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #8e44ad; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;">ğŸ”¥</div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">DYNAMIQUE - Laline</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Physique</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je suis actif et bon joueur."</p>

                </div>



                <div style="background: linear-gradient(135deg, #95a5a6, #bdc3c7); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #95a5a6; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;">â˜€ï¸</div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">CURIEUX DE DIEU - MaÃ¿ls</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Spirituel</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"J'apprends Ã  dire qui est JÃ©sus pour moi."</p>

                </div>



                <div style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900);">

                    <div style="display: flex; align-items: center; margin-bottom: 1rem;">

                        <div style="width: 50px; height: 50px; background: #e74c3c; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; font-size: 1.5rem;">ğŸŒº</div>

                        <div>

                            <h3 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem; font-size: 1.3rem;">SOLIDAIRE - Blogane</h3>

                            <p style="font-size: 0.9rem; opacity: 0.9;">Axe : Social</p>

                        </div>

                    </div>

                    <p style="font-size: 0.95rem; line-height: 1.6;">"Je suis copain avec tous, ici et ailleurs."</p>

                </div>

            </div>



            <div class="fey-note" style="margin-top: 2rem;">

                <strong>ğŸ’« Message des Sylphes :</strong><br>

                "Petits scouts, souvenez-vous : chaque jour est une nouvelle aventure. Soyez bons, soyez courageux, et la magie de la nature vous accompagnera dans tous vos dÃ©fis !"

            </div>



            <!-- Jeu de la Promesse -->

            <div class="fey-card" style="margin-top: 2rem;">

                <div class="fey-card-header">ğŸ® La QuÃªte des Sylphes</div>

                <div class="fey-note">

                    <strong>ğŸ§šâ€â™€ï¸ Apprends la loi et la priÃ¨re scoute en jouant !</strong><br>

                    Choisis un mode de jeu et relÃ¨ve les dÃ©fis pour devenir un vrai scout.

                </div>



                <!-- Section d'accueil du jeu -->

                <div id="jeu-accueil" style="text-align: center; margin: 2rem 0;">

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; font-size: 1.5rem;">

                        ğŸŒŸ Choisis ton Mode de Jeu ğŸŒŸ

                    </h3>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 2rem 0;">

                        <div class="sylphe-card" onclick="selectMode('association')" style="background: linear-gradient(135deg, #8e44ad, #9b59b6); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900); cursor: pointer; transition: transform 0.3s;">

                            <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ¯</div>

                            <h4 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem;">Mode Association</h4>

                            <p style="font-size: 0.9rem;">Relie les situations aux sylphes</p>

                        </div>

                        <div class="sylphe-card" onclick="selectMode('scenarios')" style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 1.5rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); box-shadow: 4px 4px 0 var(--c-ink-900); cursor: pointer; transition: transform 0.3s;">

                            <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ®</div>

                            <h4 style="font-family: 'Patrick Hand', cursive; margin-bottom: 0.5rem;">Mode ScÃ©narios</h4>

                            <p style="font-size: 0.9rem;">Vis des aventures scoutes</p>

                        </div>

                    </div>

                </div>



                <!-- Mode Association -->

                <div id="section-association" style="display: none;">

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; font-size: 1.5rem;">

                        ğŸ¯ Mode Association

                    </h3>



                    <div class="fey-note">

                        <strong>ğŸ“‹ Comment jouer ?</strong><br>

                        1. Lis chaque situation<br>

                        2. Glisse-la vers le Sylphe qui correspond le mieux<br>

                        3. Clique sur "VÃ©rifier" pour voir tes rÃ©sultats !

                    </div>



                    <div style="text-align: center; margin: 1rem 0; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <strong>Associations: <span id="association-count">0</span>/6</strong>

                    </div>



                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">

                        <div style="background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem;">

                            <h4 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; text-align: center;">ğŸ“– Situations</h4>

                            <div id="situations-list">

                                <!-- Situations ajoutÃ©es par JavaScript -->

                            </div>

                        </div>



                        <div style="background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem;">

                            <h4 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; text-align: center;">ğŸ§š Sylphes</h4>

                            <div id="sylphes-zones">

                                <!-- Zones de dÃ©pÃ´t ajoutÃ©es par JavaScript -->

                            </div>

                        </div>

                    </div>



                    <div id="feedback-association" style="display: none; background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem; margin: 1.5rem 0;"></div>



                    <div style="text-align: center; margin: 2rem 0;">

                        <button class="fey-btn" onclick="verifierAssociations()">âœ… VÃ©rifier les Associations</button>

                        <button class="fey-btn" onclick="recommencerAssociation()" style="background: var(--c-forest-700);">ğŸ”„ Recommencer</button>

                        <button class="fey-btn" onclick="retourMenu()" style="background: var(--c-forest-700);">ğŸ  Menu Principal</button>

                    </div>

                </div>



                <!-- Mode ScÃ©narios -->

                <div id="section-scenarios" style="display: none;">

                    <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; font-size: 1.5rem;">

                        ğŸ® Mode ScÃ©narios

                    </h3>

                    <p style="text-align: center; color: var(--c-forest-700); font-style: italic; margin-bottom: 2rem;">

                        Vis des aventures scoutes et prends les bonnes dÃ©cisions !

                    </p>



                    <div style="text-align: center; margin: 1rem 0; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <strong>Score: <span id="scenarios-score">0</span> points â­ | ScÃ©nario <span id="scenario-number">1</span>/<span id="total-scenarios">5</span></strong>

                    </div>



                    <div id="scenario-container">

                        <!-- Le scÃ©nario sera affichÃ© ici -->

                    </div>



                    <div id="scenario-feedback" style="display: none; background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem; margin: 1.5rem 0;"></div>



                    <!-- Ã‰cran final des scÃ©narios -->

                    <div id="scenarios-final" style="display: none;">

                        <div style="background: linear-gradient(135deg, #c8e6c9, #a5d6a7); border: 3px solid #2e7d32; border-radius: var(--r-lg); padding: 2rem; margin: 2rem 0; text-align: center;">

                            <h3 style="font-family: 'Patrick Hand', cursive; font-size: 2rem; color: #2e7d32; margin-bottom: 1rem;">

                                ğŸ‰ Aventure TerminÃ©e ! ğŸ‰

                            </h3>

                            <p style="font-size: 1.2rem; margin-bottom: 1rem;">

                                Score final : <span id="final-scenarios-score" style="font-weight: bold; color: var(--c-orange-600);">0</span> points

                            </p>

                            <p style="font-size: 1.1rem;">

                                Bonnes rÃ©ponses : <span id="final-correct-answers">0</span>/<span id="final-total-questions">0</span>

                            </p>

                        </div>



                        <div style="background: white; padding: 2rem; border-radius: var(--r-md); border: 3px solid var(--c-ink-900); margin: 2rem 0;">

                            <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 1rem; text-align: center;">

                                ğŸ’¬ Message des Sylphes

                            </h3>

                            <p id="final-sylphes-message" style="font-size: 1.1rem; line-height: 1.6; text-align: center;">

                            </p>

                        </div>



                        <div style="text-align: center; margin: 2rem 0;">

                            <button class="fey-btn" onclick="recommencerScenarios()">ğŸ”„ Rejouer</button>

                            <button class="fey-btn" onclick="retourMenu()" style="background: var(--c-forest-700);">ğŸ  Menu Principal</button>

                        </div>

                    </div>

                </div>

            </div>
        </div>
        <!-- PAGE ADMIN -->
        <div id="admin" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                âš™ï¸ Mode Administrateur

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #FFE0E6, #FFB3BA); border-left: 6px solid #E91E63;">

                <div class="fey-card-header">ğŸ” AccÃ¨s Administrateur</div>

                <div class="fey-note" style="background: transparent; border: none; margin: 0;">

                    <strong>âš ï¸ Zone rÃ©servÃ©e aux responsables</strong><br>

                    <strong>ğŸ“ Gestion :</strong> Modifiez les informations des Ã©quipes, contacts et Ã©vÃ©nements.<br>

                    <strong>ğŸ›¡ï¸ SÃ©curitÃ© :</strong> Toutes les modifications sont tracÃ©es.

                </div>

            </div>



            <!-- Notes Administrateur -->

            <div class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 6px solid #FF9800;">

                <div class="fey-card-header">ğŸ“ Notes Administrateur</div>

                <div class="fey-note" style="background: transparent; border: none; margin: 0 0 1rem 0;">

                    <strong>ğŸ“Œ Ajoutez des notes :</strong> Partagez des informations importantes avec les parents et scouts.<br>

                    <strong>ğŸ’¡ Astuce :</strong> Ces notes apparaÃ®tront en haut de la page principale.

                </div>

                

                <div style="margin-bottom: 1rem;">

                    <textarea id="adminNotes" placeholder="Tapez vos notes ici..." 

                              style="width: 100%; min-height: 100px; padding: 1rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); font-family: 'Nunito', sans-serif; font-size: 1rem; resize: vertical;"></textarea>

                </div>

                

                <div style="display: flex; gap: 1rem;">

                    <button class="fey-btn" onclick="saveAdminNotes()" style="background: #4CAF50;">

                        ğŸ’¾ Sauvegarder les Notes

                    </button>

                    <button class="fey-btn" onclick="clearAdminNotes()" style="background: #f44336;">

                        ğŸ—‘ï¸ Effacer les Notes

                    </button>

                    <button class="fey-btn" onclick="previewAdminNotes()" style="background: #2196F3;">

                        ğŸ‘ï¸ AperÃ§u

                    </button>

                </div>

                

                <div id="adminNotesPreview" style="margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.8); border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); display: none;">

                    <h4 style="color: var(--c-orange-600); margin-bottom: 0.5rem;">ğŸ“ AperÃ§u des Notes :</h4>

                    <div id="previewContent"></div>

                </div>

            </div>


            <!-- Gestion des Enfants (Import / Export) -->
            <div class="fey-card" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 6px solid #2196F3;">
                <div class="fey-card-header">ğŸ‘¶ Gestion des Enfants (AnnÃ©e)</div>
                <div class="fey-note" style="background: transparent; border: none; margin: 0 0 1rem 0;">
                    <strong>Importer la liste annuelle des enfants</strong> au format CSV ou JSON.<br>
                    - CSV attendu: colonnes Â« nom;prenom Â» ou Â« nom,prenom Â» (en-tÃªte optionnel).<br>
                    - JSON attendu: tableau d'objets { nom: "", prenom: "" }.
                </div>
                <div style="display: grid; gap: 0.75rem;">
                    <div>
                        <input type="file" id="childrenFile" accept=".csv,.json" style="margin-bottom: 0.5rem;" onchange="loadChildrenFile(event)">
                        <button class="fey-btn" onclick="exportChildren()" style="background: #1976D2;">ğŸ“¤ Exporter (JSON)</button>
                        <span id="childrenCount" style="margin-left: 0.75rem; color: #333;"></span>
                    </div>
                    <textarea id="childrenImport" rows="8" placeholder="Collez ici votre CSV (nom;prenom) ou JSON..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);"></textarea>
                    <div>
                        <button class="fey-btn" onclick="previewChildren()" style="background: #0288D1;">ğŸ‘€ PrÃ©visualiser</button>
                        <button class="fey-btn" onclick="saveImportedChildren()" style="background: #2E7D32;">ğŸ’¾ Importer et Enregistrer</button>
                    </div>
                    <div id="childrenPreview" class="fey-note" style="display: none;"></div>
                </div>
            </div>



            <!-- Gestion de la Liste de Checklist -->

            <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 6px solid #4CAF50;">

                <div class="fey-card-header">ğŸ“‹ Gestion de la Liste de Checklist</div>

                <div class="fey-note" style="background: transparent; border: none; margin: 0 0 1rem 0;">

                    <strong>ğŸ¯ Gestion des Ã©lÃ©ments :</strong> Ajoutez, modifiez ou supprimez des Ã©lÃ©ments de la liste.<br>

                    <strong>âš™ï¸ Options :</strong> Marquez des Ã©lÃ©ments comme facultatifs ou obligatoires.

                </div>

                

                <div style="margin-bottom: 1rem;">

                    <button class="fey-btn" onclick="showAddItemModal()" style="background: #4CAF50; margin-right: 1rem;">

                        â• Ajouter un Ã‰lÃ©ment

                    </button>

                    <button class="fey-btn" onclick="showEditItemsModal()" style="background: #2196F3; margin-right: 1rem;">

                        âœï¸ Modifier les Ã‰lÃ©ments

                    </button>

                    <button class="fey-btn" onclick="resetChecklistItems()" style="background: #FF9800;">

                        ğŸ”„ RÃ©initialiser la Liste

                    </button>

                </div>

                

                <div id="checklistItemsList" style="max-height: 400px; overflow-y: auto; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1rem; background: white;">

                    <!-- Les Ã©lÃ©ments de la liste seront chargÃ©s ici -->

                </div>

            </div>



            <!-- Personnalisation de l'Apparence -->

            <div class="fey-card">

                <div class="fey-card-header">ğŸ¨ Personnalisation de l'Apparence</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong>ğŸ¨ ThÃ¨me :</strong> Personnalisez les couleurs et l'apparence de l'application.

                </div>



                <!-- Couleurs principales -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;">ğŸŒˆ Couleurs Principales</h3>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸŸ  Couleur Orange</label>

                            <input type="color" value="#F77F00" id="colorOrange" style="width: 100%; height: 40px; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸŸ¢ Couleur ForÃªt</label>

                            <input type="color" value="#2E7D32" id="colorForest" style="width: 100%; height: 40px; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸŸ¡ Couleur Or</label>

                            <input type="color" value="#FFD166" id="colorGold" style="width: 100%; height: 40px; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ”µ Couleur Marine</label>

                            <input type="color" value="#1B1F3B" id="colorMarine" style="width: 100%; height: 40px; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>

                </div>



                <!-- Personnalisation des textes -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;">ğŸ“ Textes PersonnalisÃ©s</h3>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ•ï¸ Titre Principal</label>

                            <input type="text" value="Mon carnet d'aventure" id="mainTitle" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Sous-titre</label>

                            <input type="text" value="Prochaine sortie Ã  Jambville Â· Octobre 2025" id="subtitle" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>

                </div>



                <div style="text-align: center; margin-top: 2rem;">

                    <button class="fey-btn" onclick="applyCustomization()" style="background: #4CAF50; font-size: 1rem; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                        ğŸ¨ Appliquer les Changements

                    </button>

                    <button class="fey-btn" onclick="resetCustomization()" style="background: #FF9800; font-size: 1rem; padding: 0.75rem 1.5rem;">

                        ğŸ”„ RÃ©initialiser

                    </button>

                </div>

            </div>



            <!-- Gestion des Ã‰quipes de Vie et de Nuit -->

            <div class="fey-card">

                <div class="fey-card-header">ğŸ‘¥ Gestion des Ã‰quipes</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong>âœï¸ Ã‰dition des Ã©quipes :</strong> Modifiez les membres des Ã©quipes de vie et de nuit. Les modifications sont sauvegardÃ©es automatiquement.

                </div>



                <!-- Ã‰quipes de Vie -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;">ğŸ•ï¸ Ã‰quipes de Vie</h3>

                    <div id="life-teams-editor">

                        <!-- Les Ã©quipes seront gÃ©nÃ©rÃ©es dynamiquement -->

                    </div>

                </div>



                <!-- Ã‰quipes de Nuit -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-marine-700); margin-bottom: 1rem; font-size: 1.2rem;">ğŸŒ™ Ã‰quipes de Nuit</h3>

                    <div id="night-teams-editor">

                        <!-- Les Ã©quipes seront gÃ©nÃ©rÃ©es dynamiquement -->

                    </div>

                </div>



                <div style="text-align: center; margin-top: 2rem;">

                    <button class="fey-btn" onclick="saveTeams()" style="background: #4CAF50; font-size: 1rem; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                        ğŸ’¾ Sauvegarder toutes les Ã©quipes

                    </button>

                    <button class="fey-btn" onclick="resetTeams()" style="background: #FF9800; font-size: 1rem; padding: 0.75rem 1.5rem;">

                        ğŸ”„ RÃ©initialiser

                    </button>

                </div>

            </div>



            <!-- Gestion des Contacts -->

            <div class="fey-card">

                <div class="fey-card-header">ğŸ“± Gestion des Contacts</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong>âœï¸ Modification des contacts :</strong> Modifiez les informations de contact qui apparaissent dans la page "Infos". Les modifications sont sauvegardÃ©es automatiquement.

                </div>

                



                <!-- Contacts responsables -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;">ğŸ‘¥ Contacts Responsables</h3>

                    <div id="contacts-management">

                        <!-- Les contacts seront chargÃ©s dynamiquement -->

                    </div>

                </div>



                <!-- Lien vers le drive des parents -->

                <div style="margin-bottom: 2rem;">

                    <h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;">ğŸ“ Documents pour les Parents</h3>

                    <div style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); padding: 1.5rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <div style="display: grid; grid-template-columns: 1fr auto; gap: 1rem; align-items: center;">

                            <div>

                                <h4 style="margin: 0 0 0.5rem 0; color: var(--c-marine-700);">ğŸ“š Drive des Documents</h4>

                                <p style="margin: 0; font-size: 0.9rem; color: #666;">AccÃ©dez aux documents importants, autorisations, listes et informations pour les parents.</p>

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold; font-size: 0.9rem;">ğŸ”— URL du Drive</label>

                                <input type="url" id="driveLink" value="https://drive.google.com/drive/folders/1BiH607P0bDlCc7g8thPl5V-uZQ71qA_a" 

                                       style="width: 300px; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); font-size: 0.9rem;">

                            </div>

                        </div>

                    </div>

                </div>



                <!-- Actions -->

                <div style="text-align: center; margin-top: 2rem;">

                    <button class="fey-btn" onclick="saveContactInfo()" style="background: #4CAF50; font-size: 1rem; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                        ğŸ’¾ Sauvegarder toutes les informations

                    </button>

                    <button class="fey-btn" onclick="addContact()" style="background: #9C27B0; font-size: 1rem; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                        â• Ajouter un Contact

                    </button>

                    <button class="fey-btn" onclick="resetContactInfo()" style="background: #FF9800; font-size: 1rem; padding: 0.75rem 1.5rem;">

                        ğŸ”„ RÃ©initialiser

                    </button>

                </div>

            </div>



            <!-- Gestion des Sorties Covoiturage -->

            <div class="fey-card">

                <div class="fey-card-header">ğŸš— Gestion des Sorties Covoiturage</div>

                <div id="trips-management">

                    <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; align-items: center;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ¯ Nom de la Sortie</label>

                                <input type="text" value="Weekend Groupe" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Date</label>

                                <input type="date" value="2025-10-15" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Point de DÃ©part (FIXÃ‰)</label>

                                <input type="text" value="Place de la Mairie" readonly style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); background: #f5f5f5;">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Point d'ArrivÃ©e (FIXÃ‰)</label>

                                <input type="text" value="Jambville" readonly style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); background: #f5f5f5;">

                            </div>

                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure DÃ©part</label>

                                <input type="time" value="08:00" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure Retour</label>

                                <input type="time" value="17:00" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">

                            <button class="fey-btn" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;">ğŸ’¾ Sauvegarder</button>

                            <button class="fey-btn" style="background: #FF9800; font-size: 0.9rem; padding: 0.5rem 1rem;">âœï¸ Modifier</button>

                            <button class="fey-btn" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;">ğŸ—‘ï¸ Supprimer</button>

                        </div>

                    </div>

                </div>



                <div style="margin-top: 1rem; text-align: center;">

                    <button class="fey-btn" onclick="showCreateTripModal()" style="background: #9C27B0; font-size: 1rem; padding: 0.75rem 1.5rem;">

                        â• CrÃ©er une Nouvelle Sortie

                    </button>

                </div>

            </div>



            <!-- Modal CrÃ©ation Sortie -->

            <div id="createTripModal" class="fey-card" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; background: white; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto;">

                <div class="fey-card-header">â• CrÃ©er une Nouvelle Sortie</div>

                <form id="createTripForm" style="display: flex; flex-direction: column; gap: 1rem;">

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ¯ Nom de la Sortie</label>

                            <input type="text" name="tripName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Date DÃ©but</label>

                            <input type="date" name="startDate" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>



                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Date Fin</label>

                            <input type="date" name="endDate" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Point de DÃ©part</label>

                            <input type="text" name="departurePoint" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>



                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Point d'ArrivÃ©e</label>

                            <input type="text" name="arrivalPoint" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure DÃ©part</label>

                            <input type="time" name="departureTime" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                    </div>



                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure Retour</label>

                        <input type="time" name="returnTime" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                    </div>



                    <div>

                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Description</label>

                        <textarea name="description" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 80px; resize: vertical;"></textarea>

                    </div>



                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">

                        <button type="submit" class="fey-btn" style="background: #4CAF50; flex: 1;">

                            âœ… CrÃ©er la Sortie

                        </button>

                        <button type="button" class="fey-btn" onclick="hideCreateTripModal()" style="background: #F44336; flex: 1;">

                            âŒ Annuler

                        </button>

                    </div>

                </form>
            </div>





            <!-- Gestion des Sorties avec Supabase -->
            <div class="fey-card" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 6px solid #4CAF50;">
                <div class="fey-card-header">ğŸ•ï¸ Gestion des Sorties</div>

                <div class="fey-note" style="margin-bottom: 1.5rem;">
                    <strong>ğŸ“ Gestion des sorties :</strong> CrÃ©ez, modifiez et supprimez des sorties. Toutes les modifications sont automatiquement synchronisÃ©es avec Supabase.
                </div>

                <!-- Formulaire de crÃ©ation -->
                <form id="createOutingForm" style="display: flex; flex-direction: column; gap: 1rem; background: rgba(255,255,255,0.9); border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1.5rem; margin-bottom: 2rem;">
                    <h3 style="margin: 0; color: var(--c-forest-700);">â• CrÃ©er une nouvelle sortie</h3>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1rem;">
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ—“ï¸ Nom de la sortie *</label>
                            <input type="text" name="title" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Date/heure de dÃ©but *</label>
                            <input type="datetime-local" name="startAt" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Date/heure de fin</label>
                            <input type="datetime-local" name="endAt" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Lieu</label>
                            <input type="text" name="location" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Point de rendez-vous</label>
                            <input type="text" name="meetingPoint" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸš— DÃ©tails dÃ©part</label>
                            <input type="text" name="departureDetails" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸš— DÃ©tails retour</label>
                            <input type="text" name="returnDetails" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸš™ Auto-covoiturage</label>
                            <select name="autoCarpool" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                                <option value="false">Non</option>
                                <option value="true">Oui</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ”‘ Mot de passe chef *</label>
                            <input type="password" name="secret" required placeholder="********" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                        </div>
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Notes</label>
                        <textarea name="notes" rows="3" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); resize: vertical;"></textarea>
                    </div>

                    <button type="submit" class="fey-btn" style="background: #4CAF50; padding: 0.75rem;">
                        âœ… CrÃ©er la sortie
                    </button>
                </form>

                <!-- Liste des sorties avec bouton de rafraÃ®chissement -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h3 style="margin: 0; color: var(--c-forest-700);">ğŸ“‹ Sorties existantes</h3>
                    <button id="refreshOutingsButton" class="fey-btn" style="background: #2196F3;">
                        ğŸ”„ Actualiser
                    </button>
                </div>

                <div id="outingsListContainer">
                    <div class="fey-note" style="text-align: center; padding: 2rem;">
                        <strong>ğŸ”„ Chargement des sorties...</strong>
                    </div>
                </div>
            </div>



            <!-- Statistiques Admin -->

            <div class="fey-card">

                <div class="fey-card-header">ğŸ“Š Statistiques</div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">

                    <div style="background: linear-gradient(135deg, #4CAF50, #66BB6A); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;">12</div>

                        <div>ğŸ‘¥ Ã‰quipes</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #2196F3, #42A5F5); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;">45</div>

                        <div>ğŸ“± Contacts</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #FF9800, #FFB74D); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;">8</div>

                        <div>ğŸ“… Ã‰vÃ©nements</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #9C27B0, #BA68C8); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;">23</div>

                        <div>ğŸš— Covoiturages</div>

                    </div>

                </div>

            </div>
        </div>
        <!-- PAGE REGISTRE D'APPEL -->
        <div id="registre" class="fey-page">

            <div class="fey-card-header" style="text-align: center; margin-bottom: 2rem; font-size: 2rem;">

                ğŸ“‹ Registre d'Appel des Sorties

            </div>



            <div class="fey-card" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 6px solid #FF5722;">

                <div class="fey-card-header">ğŸ“‹ Gestion du Registre d'Appel</div>

                <div class="fey-note" style="background: transparent; border: none; margin: 0;">

                    <strong>ğŸ“ FonctionnalitÃ©s :</strong> GÃ©rez les prÃ©sences pour chaque sortie, consultez les statistiques et exportez les donnÃ©es.<br>

                    <strong>ğŸ›¡ï¸ SÃ©curitÃ© :</strong> Toutes les modifications sont tracÃ©es et sauvegardÃ©es.

                </div>

            </div>



            <!-- SÃ©lection de Sortie -->

            <div class="fey-card">

                <div class="fey-card-header">ğŸ•ï¸ SÃ©lection de la Sortie</div>

                <div style="margin-bottom: 1rem;">

                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Choisir une sortie :</label>

                    <div id="outingsList" style="max-height: 300px; overflow-y: auto; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1rem;">

                        <div style="text-align: center; color: #666; padding: 2rem;">

                            ğŸ”„ Cliquez sur "Recharger" pour charger les sorties

                </div>

                    </div>

                    <button onclick="loadTripsFromCalendar()" class="fey-btn" style="background: #2196F3; padding: 0.75rem; margin-top: 0.5rem; width: 100%;">

                        ğŸ”„ Recharger les Sorties

                    </button>

                </div>

                <div style="text-align: center; margin-top: 1rem;">

                    <button class="fey-btn" onclick="exportAttendanceData()" style="background: #2196F3; font-size: 1rem; padding: 0.75rem 1.5rem;">

                        ğŸ“Š Exporter les DonnÃ©es

                    </button>

                </div>

            </div>



            <!-- Informations de la Sortie SÃ©lectionnÃ©e -->

            <div id="outingInfo" class="fey-card" style="display: none;">

                <div class="fey-card-header">ğŸ“… Informations de la Sortie</div>

                <div id="outingDetails" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">

                    <!-- Les dÃ©tails seront chargÃ©s dynamiquement -->

                </div>

            </div>



            <!-- Liste des Participants -->

            <div id="participantsList" class="fey-card" style="display: none;">

                <div class="fey-card-header">ğŸ‘¥ Liste des Participants</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong>ğŸ“‹ Instructions :</strong> Marquez la prÃ©sence de chaque participant. Les absences peuvent Ãªtre justifiÃ©es ou non.

                </div>

                

                <!-- Filtres et Actions Rapides -->

                <div style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">

                    <button class="fey-btn" onclick="markAllPresent()" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;">

                        âœ… Tous PrÃ©sents

                    </button>

                    <button class="fey-btn" onclick="markAllAbsent()" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;">

                        âŒ Tous Absents

                    </button>

                    <button class="fey-btn" onclick="clearAttendance()" style="background: #FF9800; font-size: 0.9rem; padding: 0.5rem 1rem;">

                        ğŸ”„ Effacer Tout

                    </button>

                    <select id="teamFilter" onchange="filterByTeam()" style="padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        <option value="">Toutes les Ã©quipes</option>

                        <option value="life">Ã‰quipes de Vie</option>

                        <option value="night">Ã‰quipes de Nuit</option>

                    </select>

                </div>



                <!-- Liste des participants -->

                <div id="participantsTable">

                    <!-- Le contenu sera gÃ©nÃ©rÃ© dynamiquement -->

                </div>



                <!-- Statistiques en temps rÃ©el -->

                <div style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">

                    <div style="background: linear-gradient(135deg, #4CAF50, #66BB6A); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;" id="presentCount">0</div>

                        <div>âœ… PrÃ©sents</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #F44336, #EF5350); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;" id="absentCount">0</div>

                        <div>âŒ Absents</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #FF9800, #FFB74D); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;" id="justifiedCount">0</div>

                        <div>ğŸ“ JustifiÃ©s</div>

                    </div>

                    <div style="background: linear-gradient(135deg, #2196F3, #42A5F5); color: white; padding: 1rem; border-radius: var(--r-md); text-align: center; border: 2px solid var(--c-ink-900);">

                        <div style="font-size: 2rem; font-weight: bold;" id="totalCount">0</div>

                        <div>ğŸ‘¥ Total</div>

                    </div>

                </div>



                <!-- Actions finales -->

                <div style="text-align: center; margin-top: 2rem;">

                    <button class="fey-btn" onclick="saveAttendanceRecord()" style="background: #4CAF50; font-size: 1.2rem; padding: 1rem 2rem; margin-right: 1rem;">

                        ğŸ’¾ Sauvegarder le Registre

                    </button>

                    <button class="fey-btn" onclick="printAttendanceRecord()" style="background: #FF9800; font-size: 1.2rem; padding: 1rem 2rem;">

                        ğŸ–¨ï¸ Imprimer

                    </button>

                </div>

            </div>



            <!-- Historique des Registres -->

            <div class="fey-card">

                <div class="fey-card-header">ğŸ“š Historique des Registres</div>

                <div class="fey-note" style="margin-bottom: 1rem;">

                    <strong>ğŸ“Š Consultation :</strong> Consultez les registres d'appel des sorties prÃ©cÃ©dentes.

                </div>

                

                <div style="margin-bottom: 1rem; text-align: center;">

                    <button onclick="cleanAttendanceHistory()" class="fey-btn" style="background: #FF9800; padding: 0.5rem 1rem; margin-right: 0.5rem;">

                        ğŸ§¹ Nettoyer l'Historique

                    </button>

                    <button onclick="clearAllAttendanceHistory()" class="fey-btn" style="background: #F44336; padding: 0.5rem 1rem;">

                        ğŸ—‘ï¸ Tout Supprimer

                    </button>

                </div>

                

                <div id="attendanceHistory">

                    <!-- L'historique sera chargÃ© dynamiquement -->

                </div>

            </div>

        </div>

    </div>



    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/supabaseClient.js"></script>
    <script src="js/children-service.js"></script>

    <!-- Services -->
    <script src="js/scouts-roster.js"></script>
    <script src="js/outings-service.js"></script>
    <script src="js/attendance-service.js"></script>
    <script src="js/carpool-manager.js"></script>
    <script src="js/admin-outings.js"></script>
    <!-- carpool-ui.js retirÃ© - maintenant chargÃ© uniquement dans carpool-link.html -->

    <script src="js/common.js"></script>
    <script src="js/equipes.js"></script>
    <script src="js/calendar-data.js"></script>
    <script>

        // Override showPage function to add page-specific loading

        const originalShowPage = window.showPage;

        window.showPage = function(pageId) {

            // Call the original function

            originalShowPage(pageId);

            

            // Add page-specific functionality

            if (pageId === 'registre') {

                setTimeout(() => {

                    if (typeof loadTripsFromCalendar === 'function') {

                        loadTripsFromCalendar();

                    }

                }, 100);

            }

        };



        // Fonction de dÃ©connexion
        function logout() {
            // Nettoyer toutes les sessions
            sessionStorage.clear();
            localStorage.removeItem('admin-authenticated');

            // Cacher les onglets admin
            const adminTab = document.getElementById('adminTab');
            const registreTab = document.getElementById('registreTab');
            if (adminTab) adminTab.style.display = 'none';
            if (registreTab) registreTab.style.display = 'none';

            // Retour Ã  la page de connexion
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('loginPage').style.display = 'block';

            // RÃ©initialiser le champ de mot de passe
            const passwordInput = document.getElementById('passwordInput');
            if (passwordInput) passwordInput.value = '';
        }

        // Fonction d'authentification

        function authenticate() {

            const password = document.getElementById('passwordInput').value;

            const errorMessage = document.getElementById('errorMessage');

            

            if (password === 'Scout2025!') {

                // Connexion admin

                sessionStorage.setItem('scout_session', 'true');
                sessionStorage.setItem('admin_mode', 'true');
                localStorage.setItem('admin-authenticated', 'true');

                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';

                enableAdminMode();
                showPage('tente');

            } else if (password === 'Moussaillons!2025!2026!') {

                // Connexion utilisateur normale (parent)

                sessionStorage.setItem('scout_session', 'true');

                // Nettoyer les flags admin d'une session prÃ©cÃ©dente
                sessionStorage.removeItem('admin_mode');
                localStorage.removeItem('admin-authenticated');

                // Cacher explicitement les onglets admin
                const adminTab = document.getElementById('adminTab');
                const registreTab = document.getElementById('registreTab');
                if (adminTab) adminTab.style.display = 'none';
                if (registreTab) registreTab.style.display = 'none';

                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                showPage('tente');

            } else {

                // Mot de passe incorrect

                errorMessage.style.display = 'block';

                setTimeout(() => {

                    errorMessage.style.display = 'none';

                }, 3000);

            }

        }



        // Initialiser au chargement

        document.addEventListener('DOMContentLoaded', function() {

            // Ajouter l'event listener pour le bouton de connexion

            const loginBtn = document.getElementById('loginBtn');

            if (loginBtn) {

                loginBtn.addEventListener('click', authenticate);

            }

            

            // Ajouter l'event listener pour la touche EntrÃ©e

            const passwordInput = document.getElementById('passwordInput');

            if (passwordInput) {

                passwordInput.addEventListener('keypress', function(e) {

                    if (e.key === 'Enter') {

                        authenticate();

                    }

                });

            }

            

            // VÃ©rifier la session

            checkSession();

        });



        // CrÃ©er arbres magiques - RÃ©duit pour les performances

        const treesContainer = document.getElementById('trees');

        for (let i = 0; i < 5; i++) {

            const tree = document.createElement('div');

            tree.className = 'magic-tree';

            tree.textContent = ['ğŸŒ²', 'ğŸŒ³', 'ğŸŒ´'][Math.floor(Math.random() * 3)];

            tree.style.left = Math.random() * 100 + '%';

            tree.style.animationDelay = Math.random() * 6 + 's';

            treesContainer.appendChild(tree);

        }



        // CrÃ©er feuilles tombantes - RÃ©duit pour les performances

        const leavesContainer = document.getElementById('leaves');

        for (let i = 0; i < 6; i++) {

            const leaf = document.createElement('div');

            leaf.className = 'fey-leaf';

            leaf.textContent = ['ğŸ‚', 'ğŸƒ', 'ğŸŒ¿', 'ğŸ'][Math.floor(Math.random() * 4)];

            leaf.style.left = Math.random() * 100 + '%';

            leaf.style.animationDelay = Math.random() * 8 + 's';

            leaf.style.animationDuration = (8 + Math.random() * 4) + 's';

            leavesContainer.appendChild(leaf);

        }



        // CrÃ©er lucioles - RÃ©duit pour les performances

        const firefliesContainer = document.getElementById('fireflies');

        for (let i = 0; i < 8; i++) {

            const firefly = document.createElement('div');

            firefly.className = 'fey-firefly';

            firefly.style.left = Math.random() * 100 + '%';

            firefly.style.top = Math.random() * 100 + '%';

            firefly.style.animationDelay = Math.random() * 3 + 's';

            firefliesContainer.appendChild(firefly);

        }



        // CrÃ©er Ã©tincelles de fÃ©e - RÃ©duit pour les performances

        const sparklesContainer = document.getElementById('sparkles');

        for (let i = 0; i < 10; i++) {

            const sparkle = document.createElement('div');

            sparkle.className = 'fairy-sparkle';

            sparkle.style.left = Math.random() * 100 + '%';

            sparkle.style.top = Math.random() * 100 + '%';

            sparkle.style.animationDelay = Math.random() * 4 + 's';

            sparklesContainer.appendChild(sparkle);

        }



        // CrÃ©er ailes de fÃ©e - RÃ©duit pour les performances

        const wingsContainer = document.getElementById('wings');

        for (let i = 0; i < 3; i++) {

            const wing = document.createElement('div');

            wing.className = 'fairy-wing';

            wing.style.left = Math.random() * 100 + '%';

            wing.style.top = Math.random() * 80 + '%';

            wing.style.animationDelay = Math.random() * 5 + 's';

            wingsContainer.appendChild(wing);

        }



        // CrÃ©er champignons magiques - RÃ©duit pour les performances

        const mushroomsContainer = document.getElementById('mushrooms');

        for (let i = 0; i < 5; i++) {

            const mushroom = document.createElement('div');

            mushroom.className = 'magic-mushroom';

            mushroom.textContent = ['ğŸ„', 'ğŸŸ«'][Math.floor(Math.random() * 2)];

            mushroom.style.left = Math.random() * 100 + '%';

            mushroom.style.animationDelay = Math.random() * 4 + 's';

            mushroomsContainer.appendChild(mushroom);

        }



        // CrÃ©er Ã©toiles scintillantes - RÃ©duit pour les performances

        const starsContainer = document.getElementById('stars');

        for (let i = 0; i < 8; i++) {

            const star = document.createElement('div');

            star.className = 'twinkle-star';

            star.style.left = Math.random() * 100 + '%';

            star.style.top = Math.random() * 100 + '%';

            star.style.animationDelay = Math.random() * 3 + 's';

            starsContainer.appendChild(star);

        }



        // Jeu de la Promesse - La QuÃªte des Sylphes

        function commencerJeu(sylphe) {

            document.getElementById('jeu-accueil').style.display = 'none';

            document.getElementById('defi-loi').style.display = 'block';

            initialiserDefiLoi();

        }
        // Initialiser le dÃ©fi de la loi scoute

        function initialiserDefiLoi() {

            const loiScoute = [

                "Le louveteau Ã©coute les anciens.",

                "Le louveteau pense d'abord aux autres.",

                "Le louveteau dit toujours la vÃ©ritÃ©.",

                "Le louveteau est propre et ordonnÃ©.",

                "Le louveteau est toujours joyeux.",

                "Le louveteau est Ã©conome et soigneux.",

                "Le louveteau est courageux.",

                "Le louveteau est respectueux.",

                "Le louveteau est bon frÃ¨re et bon ami.",

                "Le louveteau est disciplinÃ©."

            ];



            const loiMelangee = [...loiScoute].sort(() => Math.random() - 0.5);

            const jeuLoi = document.getElementById("jeu-loi");

            jeuLoi.innerHTML = '';

            loiMelangee.forEach(article => {

                const div = document.createElement("div");

                div.style.cssText = "background: var(--c-orange-600); color: white; padding: 0.75rem; margin: 0.25rem; border-radius: var(--r-sm); cursor: move; display: inline-block; border: 2px solid var(--c-ink-900); font-size: 0.9rem;";

                div.textContent = article;

                div.draggable = true;

                div.ondragstart = (e) => {

                    e.dataTransfer.setData("text/plain", article);

                };

                jeuLoi.appendChild(div);

            });



            const zoneDepot = document.getElementById("zone-depot");

            zoneDepot.innerHTML = '<p style="text-align: center; color: var(--c-orange-600); font-weight: bold;">DÃ©pose les articles ici dans le bon ordre</p>';

            zoneDepot.ondragover = (e) => {

                e.preventDefault();

            };



            zoneDepot.ondrop = (e) => {

                e.preventDefault();

                const article = e.dataTransfer.getData("text/plain");

                const div = document.createElement("div");

                div.style.cssText = "background: var(--c-forest-700); color: white; padding: 0.75rem; margin: 0.25rem; border-radius: var(--r-sm); display: inline-block; border: 2px solid var(--c-ink-900); font-size: 0.9rem;";

                div.textContent = article;

                zoneDepot.appendChild(div);

            };

        }



        // VÃ©rifier l'ordre de la loi scoute

        function verifierOrdreLoi() {

            const loiScoute = [

                "Le louveteau Ã©coute les anciens.",

                "Le louveteau pense d'abord aux autres.",

                "Le louveteau dit toujours la vÃ©ritÃ©.",

                "Le louveteau est propre et ordonnÃ©.",

                "Le louveteau est toujours joyeux.",

                "Le louveteau est Ã©conome et soigneux.",

                "Le louveteau est courageux.",

                "Le louveteau est respectueux.",

                "Le louveteau est bon frÃ¨re et bon ami.",

                "Le louveteau est disciplinÃ©."

            ];



            const articlesDeposes = Array.from(document.getElementById("zone-depot").children).slice(1).map(el => el.textContent);

            if (JSON.stringify(articlesDeposes) === JSON.stringify(loiScoute)) {

                alert("ğŸ‰ Bravo ! Tu as retrouvÃ© la loi scoute dans le bon ordre !");

                document.getElementById('defi-loi').style.display = 'none';

                document.getElementById('defi-priere').style.display = 'block';

                initialiserDefiPriere();

            } else {

                alert("âŒ Ce n'est pas encore Ã§a. RÃ©essaye !");

            }

        }



        // Initialiser le dÃ©fi de la priÃ¨re scoute

        function initialiserDefiPriere() {

            const priereScoute = [

                "Seigneur JÃ©sus,",

                "apprends-nous Ã  Ãªtre gÃ©nÃ©reux,",

                "Ã  te servir comme tu le mÃ©rites,",

                "Ã  donner sans compter,",

                "Ã  combattre sans souci des blessures,",

                "Ã  travailler sans chercher le repos,",

                "Ã  nous donner sans attendre de rÃ©compense,",

                "sauf celle de savoir que nous faisons ta volontÃ©."

            ];



            const priereMelangee = [...priereScoute].sort(() => Math.random() - 0.5);

            const jeuPriere = document.getElementById("jeu-priere");

            jeuPriere.innerHTML = '';

            priereMelangee.forEach(mot => {

                const div = document.createElement("div");

                div.style.cssText = "background: var(--c-marine-700); color: white; padding: 0.75rem; margin: 0.25rem; border-radius: var(--r-sm); cursor: move; display: inline-block; border: 2px solid var(--c-ink-900); font-size: 0.9rem;";

                div.textContent = mot;

                div.draggable = true;

                div.ondragstart = (e) => {

                    e.dataTransfer.setData("text/plain", mot);

                };

                jeuPriere.appendChild(div);

            });



            const zoneDepotPriere = document.getElementById("zone-depot-priere");

            zoneDepotPriere.innerHTML = '<p style="text-align: center; color: var(--c-orange-600); font-weight: bold;">DÃ©pose les mots ici dans le bon ordre</p>';

            zoneDepotPriere.ondragover = (e) => {

                e.preventDefault();

            };



            zoneDepotPriere.ondrop = (e) => {

                e.preventDefault();

                const mot = e.dataTransfer.getData("text/plain");

                const div = document.createElement("div");

                div.style.cssText = "background: var(--c-forest-700); color: white; padding: 0.75rem; margin: 0.25rem; border-radius: var(--r-sm); display: inline-block; border: 2px solid var(--c-ink-900); font-size: 0.9rem;";

                div.textContent = mot;

                zoneDepotPriere.appendChild(div);

            };

        }



        // VÃ©rifier l'ordre de la priÃ¨re scoute

        function verifierOrdrePriere() {

            const priereScoute = [

                "Seigneur JÃ©sus,",

                "apprends-nous Ã  Ãªtre gÃ©nÃ©reux,",

                "Ã  te servir comme tu le mÃ©rites,",

                "Ã  donner sans compter,",

                "Ã  combattre sans souci des blessures,",

                "Ã  travailler sans chercher le repos,",

                "Ã  nous donner sans attendre de rÃ©compense,",

                "sauf celle de savoir que nous faisons ta volontÃ©."

            ];



            const motsDeposes = Array.from(document.getElementById("zone-depot-priere").children).slice(1).map(el => el.textContent);

            if (JSON.stringify(motsDeposes) === JSON.stringify(priereScoute)) {

                alert("ğŸ‰ Bravo ! Tu as retrouvÃ© la priÃ¨re scoute dans le bon ordre !");

                document.getElementById('defi-priere').style.display = 'none';

                document.getElementById('defi-quiz').style.display = 'block';

                initialiserQuiz();

            } else {

                alert("âŒ Ce n'est pas encore Ã§a. RÃ©essaye !");

            }

        }



        // Initialiser le quiz

        function initialiserQuiz() {

            const questions = [

                {

                    question: "Quel est le premier article de la loi scoute ?",

                    options: [

                        "Le louveteau Ã©coute les anciens.",

                        "Le louveteau pense d'abord aux autres.",

                        "Le louveteau dit toujours la vÃ©ritÃ©."

                    ],

                    reponse: 0

                },

                {

                    question: "Que dit la priÃ¨re scoute sur le service ?",

                    options: [

                        "Ã  te servir comme tu le mÃ©rites",

                        "Ã  donner sans compter",

                        "Ã  combattre sans souci des blessures"

                    ],

                    reponse: 0

                },

                {

                    question: "Quel est le dernier article de la loi scoute ?",

                    options: [

                        "Le louveteau est disciplinÃ©.",

                        "Le louveteau est respectueux.",

                        "Le louveteau est courageux."

                    ],

                    reponse: 0

                }

            ];



            const quiz = document.getElementById("quiz");

            quiz.innerHTML = '';

            questions.forEach((q, index) => {

                const divQuestion = document.createElement("div");

                divQuestion.style.cssText = "background: rgba(255, 255, 255, 0.7); padding: 1rem; margin: 1rem 0; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);";

                divQuestion.innerHTML = `<h4 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); margin-bottom: 0.5rem;">${index + 1}. ${q.question}</h4>`;

                const optionsDiv = document.createElement("div");

                optionsDiv.style.cssText = "display: flex; flex-direction: column; gap: 0.5rem; margin-left: 1rem;";

                q.options.forEach((option, i) => {

                    const divOption = document.createElement("div");

                    divOption.style.cssText = "display: flex; align-items: center; gap: 0.5rem;";

                    divOption.innerHTML = `

                        <input type="radio" id="q${index}-option${i}" name="q${index}" value="${i}" style="margin: 0;">

                        <label for="q${index}-option${i}" style="cursor: pointer; font-size: 0.9rem;">${option}</label>

                    `;

                    optionsDiv.appendChild(divOption);

                });

                divQuestion.appendChild(optionsDiv);

                quiz.appendChild(divQuestion);

            });

        }



        // VÃ©rifier les rÃ©ponses du quiz

        function verifierReponsesQuiz() {

            const questions = [

                { reponse: 0 },

                { reponse: 0 },

                { reponse: 0 }

            ];



            let toutesCorrectes = true;

            questions.forEach((q, index) => {

                const reponse = document.querySelector(`input[name="q${index}"]:checked`);

                if (!reponse || parseInt(reponse.value) !== q.reponse) {

                    toutesCorrectes = false;

                }

            });

            if (toutesCorrectes) {

                alert("ğŸ‰ Bravo ! Tu as rÃ©ussi le quiz des sylphes !");

                document.getElementById('defi-quiz').style.display = 'none';

                document.getElementById('jeu-fin').style.display = 'block';

            } else {

                alert("âŒ Ce n'est pas encore Ã§a. RÃ©essaye !");

            }

        }



        // Recommencer le jeu

        function recommencerJeu() {

            document.getElementById('jeu-fin').style.display = 'none';

            document.getElementById('jeu-accueil').style.display = 'block';

        }



        // ==================== JEU DES SYLPHES ====================



        // DonnÃ©es des Sylphes

        const sylphes = {

            yzo: {

                name: "YzÃ´",

                icon: "ğŸŒ±",

                image: "./images/yzo.png",

                trait: "FRANC",

                description: "Je dis toujours ce que je pense, je fais ce que je dis !",

                color: "#8e44ad"

            },

            kawane: {

                name: "Kawane",

                icon: "â˜ï¸",

                image: "./images/kawane.png",

                trait: "RESPECTUEUX",

                description: "Je prends soin de moi et des autres.",

                color: "#27ae60"

            },

            laline: {

                name: "Laline",

                icon: "ğŸ”¥",

                image: "./images/laline.png",

                trait: "DYNAMIQUE",

                description: "Je suis actif et bon joueur.",

                color: "#e74c3c"

            },

            mayls: {

                name: "MaÃ¿ls",

                icon: "ğŸ„",

                image: "./images/mayls.png",

                trait: "CURIEUX DE DIEU",

                description: "J'apprends Ã  dire qui est JÃ©sus pour moi.",

                color: "#95a5a6"

            },

            thela: {

                name: "ThÃ©la",

                icon: "ğŸŒŠ",

                image: "./images/thela.png",

                trait: "DÃ‰BROUILLARD",

                description: "Je dÃ©couvre le monde et je crÃ©e de mes mains, je protÃ¨ge notre planÃ¨te.",

                color: "#f39c12"

            },

            blogane: {

                name: "Blogane",

                icon: "ğŸŒº",

                image: "./images/blogane.png",

                trait: "SOLIDAIRE",

                description: "Je suis copain avec tous, ici et ailleurs !",

                color: "#e91e63"

            }

        };



        // Situations Ã  associer

        const situations = [

            {

                id: 1,

                text: "Tu vois quelqu'un seul dans son coin pendant la rÃ©crÃ©ation",

                emoji: "ğŸ‘¤",

                correctSylphe: "blogane",

                explanation: "Blogane est solidaire : Ãªtre copain avec tous, c'est aller vers ceux qui sont seuls !"

            },

            {

                id: 2,

                text: "Tu as cassÃ© quelque chose par accident et personne ne t'a vu",

                emoji: "ğŸ’”",

                correctSylphe: "yzo",

                explanation: "YzÃ´ est franc : dire la vÃ©ritÃ© mÃªme quand c'est difficile, c'est du courage !"

            },

            {

                id: 3,

                text: "Ton Ã©quipe perd au jeu mais vous vous Ãªtes bien amusÃ©s",

                emoji: "ğŸ²",

                correctSylphe: "laline",

                explanation: "Laline est dynamique : Ãªtre bon joueur, c'est savoir perdre avec le sourire !"

            },

            {

                id: 4,

                text: "Tu trouves un oiseau blessÃ© dans la forÃªt",

                emoji: "ğŸ¦",

                correctSylphe: "kawane",

                explanation: "Kawane est respectueux : prendre soin des animaux, c'est respecter la nature !"

            },

            {

                id: 5,

                text: "Il faut rÃ©parer la cabane avec du matÃ©riel recyclÃ©",

                emoji: "â™»ï¸",

                correctSylphe: "thela",

                explanation: "ThÃ©la est dÃ©brouillard : crÃ©er et protÃ©ger la planÃ¨te, c'est utiliser nos talents !"

            },

            {

                id: 6,

                text: "Tu veux dire merci pour cette belle journÃ©e ensemble",

                emoji: "ğŸ™",

                correctSylphe: "mayls",

                explanation: "MaÃ¿ls est curieux de Dieu : prier et remercier, c'est grandir spirituellement !"

            }

        ];
        // Variables globales
        let associations = {};
        let draggedElement = null;
        // SÃ©lection du mode

        function selectMode(mode) {

            document.getElementById('jeu-accueil').style.display = 'none';

            if (mode === 'association') {

                document.getElementById('section-association').style.display = 'block';

                initAssociationMode();

            } else if (mode === 'scenarios') {

                document.getElementById('section-scenarios').style.display = 'block';

                initScenariosMode();

            }

        }



        // Retour au menu

        function retourMenu() {

            document.getElementById('jeu-accueil').style.display = 'block';

            document.getElementById('section-association').style.display = 'none';

            document.getElementById('section-scenarios').style.display = 'none';

            resetAssociations();

        }



        // Initialiser le mode association

        function initAssociationMode() {

            associations = {};

            const situationsList = document.getElementById('situations-list');

            const sylphesZones = document.getElementById('sylphes-zones');



            // CrÃ©er les situations

            situationsList.innerHTML = '';

            situations.forEach(situation => {

                const div = document.createElement('div');

                div.className = 'situation-item';

                div.draggable = true;

                div.dataset.situationId = situation.id;

                div.style.cssText = "background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 2px solid var(--c-orange-600); border-radius: var(--r-sm); padding: 1rem; margin-bottom: 1rem; cursor: move; transition: all 0.3s ease; font-size: 0.95rem;";

                div.innerHTML = `

                    <span style="font-size: 1.5rem; margin-right: 0.5rem;">${situation.emoji}</span>

                    ${situation.text}

                `;

                div.addEventListener('dragstart', handleDragStart);

                div.addEventListener('dragend', handleDragEnd);

                situationsList.appendChild(div);

            });



            // CrÃ©er les zones de dÃ©pÃ´t pour chaque Sylphe

            sylphesZones.innerHTML = '';

            Object.keys(sylphes).forEach(key => {

                const sylphe = sylphes[key];

                const zone = document.createElement('div');

                zone.className = 'sylphe-drop-zone';

                zone.dataset.sylpheKey = key;

                zone.style.cssText = "background: rgba(255, 255, 255, 0.5); border: 2px dashed var(--c-forest-700); border-radius: var(--r-sm); padding: 1rem; margin-bottom: 1rem; min-height: 100px; transition: all 0.3s ease;";

                zone.innerHTML = `

                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.8rem; padding: 0.5rem; background: white; border-radius: var(--r-sm);">

                        <img src="${sylphe.image}" alt="${sylphe.name}" style="width: 70px; height: 70px; object-fit: contain;"

                             onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';">

                        <span style="display:none; font-size: 2.5rem;">${sylphe.icon}</span>

                        <div style="flex: 1;">

                            <div style="font-family: 'Patrick Hand', cursive; font-size: 1.1rem; color: var(--c-orange-600); font-weight: bold;">${sylphe.name}</div>

                            <div style="font-size: 0.85rem; color: var(--c-forest-700); font-weight: bold;">${sylphe.trait}</div>

                        </div>

                    </div>

                    <div class="drop-area" data-sylphe="${key}">

                        <!-- Situations dÃ©posÃ©es ici -->

                    </div>

                `;

                zone.addEventListener('dragover', handleDragOver);

                zone.addEventListener('drop', handleDrop);

                zone.addEventListener('dragleave', handleDragLeave);

                zone.addEventListener('dragenter', handleDragEnter);

                sylphesZones.appendChild(zone);

            });



            updateAssociationCount();

        }



        // Gestion du drag and drop

        function handleDragStart(e) {

            draggedElement = e.target;

            e.target.classList.add('dragging');

            e.dataTransfer.effectAllowed = 'move';

            e.dataTransfer.setData('text/html', e.target.innerHTML);

        }



        function handleDragEnd(e) {

            e.target.classList.remove('dragging');

        }



        function handleDragOver(e) {

            if (e.preventDefault) {

                e.preventDefault();

            }

            e.dataTransfer.dropEffect = 'move';

            return false;

        }



        function handleDragEnter(e) {

            if (e.target.classList.contains('sylphe-drop-zone') ||

                e.target.closest('.sylphe-drop-zone')) {

                const zone = e.target.classList.contains('sylphe-drop-zone') ?

                    e.target : e.target.closest('.sylphe-drop-zone');

                zone.classList.add('drag-over');

                zone.style.background = 'rgba(46, 125, 50, 0.1)';

                zone.style.borderColor = 'var(--c-orange-600)';

                zone.style.borderStyle = 'solid';

                zone.style.transform = 'scale(1.02)';

            }

        }



        function handleDragLeave(e) {

            if (e.target.classList.contains('sylphe-drop-zone')) {

                e.target.classList.remove('drag-over');

                e.target.style.background = 'rgba(255, 255, 255, 0.5)';

                e.target.style.borderColor = 'var(--c-forest-700)';

                e.target.style.borderStyle = 'dashed';

                e.target.style.transform = 'scale(1)';

            }

        }



        function handleDrop(e) {

            if (e.stopPropagation) {

                e.stopPropagation();

            }



            const zone = e.target.classList.contains('sylphe-drop-zone') ?

                e.target : e.target.closest('.sylphe-drop-zone');



            if (zone && draggedElement) {

                zone.classList.remove('drag-over');

                zone.style.background = 'rgba(255, 255, 255, 0.5)';

                zone.style.borderColor = 'var(--c-forest-700)';

                zone.style.borderStyle = 'dashed';

                zone.style.transform = 'scale(1)';



                const situationId = parseInt(draggedElement.dataset.situationId);

                const sylpheKey = zone.dataset.sylpheKey;



                // CrÃ©er l'Ã©lÃ©ment dÃ©posÃ©

                const dropArea = zone.querySelector('.drop-area');

                const droppedDiv = document.createElement('div');

                droppedDiv.className = 'dropped-situation';

                droppedDiv.style.cssText = "background: linear-gradient(135deg, #e3f2fd, #bbdefb); border: 2px solid #2196f3; border-radius: var(--r-sm); padding: 0.8rem; margin-top: 0.5rem; font-size: 0.9rem;";

                droppedDiv.innerHTML = draggedElement.innerHTML;

                droppedDiv.dataset.situationId = situationId;



                // Supprimer l'ancienne association si elle existe

                Object.keys(associations).forEach(key => {

                    if (associations[key] === situationId) {

                        delete associations[key];

                    }

                });



                // Supprimer les anciennes versions de cette situation

                document.querySelectorAll(`[data-situation-id="${situationId}"]`).forEach(el => {

                    if (el.classList.contains('dropped-situation')) {

                        el.remove();

                    }

                });



                dropArea.appendChild(droppedDiv);



                // Enregistrer l'association

                associations[sylpheKey] = situationId;



                // Cacher la situation originale

                draggedElement.style.display = 'none';



                updateAssociationCount();

            }



            return false;

        }



        // Mettre Ã  jour le compteur

        function updateAssociationCount() {

            const count = Object.keys(associations).length;

            document.getElementById('association-count').textContent = count;

        }



        // VÃ©rifier les associations

        function verifierAssociations() {

            if (Object.keys(associations).length < 6) {

                alert('âŒ Tu dois associer toutes les situations avant de vÃ©rifier !');

                return;

            }



            let correctCount = 0;

            const feedback = document.getElementById('feedback-association');

            let feedbackHTML = '';



            // VÃ©rifier chaque association

            Object.keys(associations).forEach(sylpheKey => {

                const situationId = associations[sylpheKey];

                const situation = situations.find(s => s.id === situationId);

                const isCorrect = situation.correctSylphe === sylpheKey;



                const zone = document.querySelector(`[data-sylphe-key="${sylpheKey}"]`);

                if (isCorrect) {

                    zone.style.background = 'rgba(46, 125, 50, 0.2)';

                    zone.style.borderColor = '#2e7d32';

                    correctCount++;

                    feedbackHTML += `<p>ï£ˆ <strong>${sylphes[sylpheKey].name}</strong> : ${situation.explanation}</p>`;

                } else {

                    zone.style.background = 'rgba(211, 47, 47, 0.2)';

                    zone.style.borderColor = '#d32f2f';

                    const correctSylphe = sylphes[situation.correctSylphe];

                    feedbackHTML += `<p>âŒ Cette situation correspond plutÃ´t Ã  <strong>${correctSylphe.name}</strong> (${correctSylphe.trait})</p>`;

                }

            });



            // Afficher le feedback

            feedback.style.display = 'block';

            if (correctCount === 6) {

                feedback.style.background = 'linear-gradient(135deg, #c8e6c9, #a5d6a7)';

                feedback.style.borderColor = '#2e7d32';

                feedback.innerHTML = `

                    <div style="font-family: 'Patrick Hand', cursive; font-size: 1.8rem; margin-bottom: 1rem; text-align: center;">ğŸ‰ Parfait ! 6/6 ! ğŸ‰</div>

                    <div style="line-height: 1.6; margin-bottom: 1rem; font-size: 1.1rem;">

                        <p>Bravo ! Tu as parfaitement compris la loi des Sylphes !</p>

                        ${feedbackHTML}

                    </div>

                `;

            } else {

                feedback.style.background = 'linear-gradient(135deg, #fff9c4, #fff59d)';

                feedback.style.borderColor = '#fbc02d';

                feedback.innerHTML = `

                    <div style="font-family: 'Patrick Hand', cursive; font-size: 1.8rem; margin-bottom: 1rem; text-align: center;">ğŸ‘ Bien jouÃ© ! ${correctCount}/6</div>

                    <div style="line-height: 1.6; margin-bottom: 1rem; font-size: 1.1rem;">

                        ${feedbackHTML}

                    </div>

                `;

            }



            // DÃ©filer vers le feedback

            feedback.scrollIntoView({ behavior: 'smooth', block: 'center' });

        }



        // Recommencer le mode association

        function recommencerAssociation() {

            // RÃ©initialiser les zones

            document.querySelectorAll('.sylphe-drop-zone').forEach(zone => {

                zone.style.background = 'rgba(255, 255, 255, 0.5)';

                zone.style.borderColor = 'var(--c-forest-700)';

                zone.style.borderStyle = 'dashed';

                const dropArea = zone.querySelector('.drop-area');

                if (dropArea) {

                    dropArea.innerHTML = '';

                }

            });



            // RÃ©afficher toutes les situations

            document.querySelectorAll('.situation-item').forEach(item => {

                item.style.display = 'block';

            });



            // Cacher le feedback

            const feedback = document.getElementById('feedback-association');

            feedback.style.display = 'none';

            feedback.innerHTML = '';



            // RÃ©initialiser les associations

            associations = {};

            updateAssociationCount();



            // DÃ©filer vers le haut

            window.scrollTo({ top: 0, behavior: 'smooth' });

        }



        // RÃ©initialiser complÃ¨tement

        function resetAssociations() {

            associations = {};

            document.getElementById('situations-list').innerHTML = '';

            document.getElementById('sylphes-zones').innerHTML = '';

            const feedback = document.getElementById('feedback-association');

            feedback.style.display = 'none';

            feedback.innerHTML = '';

        }
        // ==================== MODE SCÃ‰NARIOS ====================
        // ScÃ©narios avec choix multiples
        const scenarios = [

            {

                id: 1,

                situation: "ğŸ•ï¸ Pendant le camp, tu remarques qu'un autre scout a oubliÃ© son sac de couchage. Il fait froid ce soir.",

                choices: [

                    {

                        emoji: "ğŸ¤",

                        text: "Je lui prÃªte ma couverture de secours mÃªme si j'aurai un peu froid",

                        correct: true,

                        sylphe: "kawane",

                        feedback: "Excellent ! Tu prends soin des autres comme Kawane. Le respect et l'entraide sont essentiels.",

                        points: 20

                    },

                    {

                        emoji: "ğŸ™ˆ",

                        text: "Je fais comme si je n'avais rien vu, ce n'est pas mon problÃ¨me",

                        correct: false,

                        feedback: "Un scout ne laisse jamais un camarade dans le besoin. La solidaritÃ© est une valeur fondamentale.",

                        points: 0

                    },

                    {

                        emoji: "ğŸ’¡",

                        text: "Je vais voir les chefs pour trouver une solution ensemble",

                        correct: true,

                        sylphe: "thela",

                        feedback: "TrÃ¨s bien ! Tu es dÃ©brouillard et tu cherches des solutions comme ThÃ©la.",

                        points: 20

                    }

                ]

            },

            {

                id: 2,

                situation: "â›º Ton Ã©quipe doit monter la tente, mais certains scouts veulent jouer au lieu d'aider.",

                choices: [

                    {

                        emoji: "ğŸ˜”",

                        text: "Je monte la tente tout seul sans rien dire",

                        correct: false,

                        feedback: "Le travail d'Ã©quipe est important. Il faut communiquer avec les autres !",

                        points: 0

                    },

                    {

                        emoji: "ğŸ’¬",

                        text: "Je dis clairement qu'on doit tous participer et j'explique pourquoi c'est important",

                        correct: true,

                        sylphe: "yzo",

                        feedback: "Parfait ! Tu dis la vÃ©ritÃ© avec honnÃªtetÃ© comme YzÃ´. La communication est essentielle.",

                        points: 20

                    },

                    {

                        emoji: "ğŸ®",

                        text: "Je transforme le montage en jeu amusant pour motiver tout le monde",

                        correct: true,

                        sylphe: "laline",

                        feedback: "GÃ©nial ! Tu es dynamique et bon joueur comme Laline. Tu sais motiver l'Ã©quipe !",

                        points: 20

                    }

                ]

            },

            {

                id: 3,

                situation: "ğŸŒ² En randonnÃ©e, vous trouvez un joli endroit avec des fleurs rares. Tes amis veulent en cueillir.",

                choices: [

                    {

                        emoji: "ğŸŒ",

                        text: "J'explique qu'il faut protÃ©ger la nature et je propose de prendre des photos Ã  la place",

                        correct: true,

                        sylphe: "thela",

                        feedback: "Excellent ! Tu protÃ¨ges la planÃ¨te comme ThÃ©la. Un scout respecte la nature.",

                        points: 20

                    },

                    {

                        emoji: "ğŸŒ¸",

                        text: "Je cueille quelques fleurs, ce n'est pas grave",

                        correct: false,

                        feedback: "Un scout protÃ¨ge la nature et respecte l'environnement. Les fleurs rares doivent rester dans leur habitat.",

                        points: 0

                    },

                    {

                        emoji: "ğŸ¤",

                        text: "Je reste silencieux mÃªme si je pense que ce n'est pas bien",

                        correct: false,

                        feedback: "Il faut oser dire ce qu'on pense quand c'est important ! Le courage de ses convictions est essentiel.",

                        points: 0

                    }

                ]

            },

            {

                id: 4,

                situation: "ğŸ½ï¸ Pendant le repas, un nouveau scout est seul dans son coin et ne parle Ã  personne.",

                choices: [

                    {

                        emoji: "ğŸ‘‹",

                        text: "Je vais le voir et je l'invite Ã  venir manger avec notre groupe",

                        correct: true,

                        sylphe: "blogane",

                        feedback: "Parfait ! Tu es solidaire comme Blogane. L'inclusion est une valeur scoute essentielle.",

                        points: 20

                    },

                    {

                        emoji: "ğŸ¤·",

                        text: "Je reste avec mes amis, il viendra bien quand il voudra",

                        correct: false,

                        feedback: "Un scout fait toujours le premier pas pour accueillir quelqu'un. L'accueil est au cÅ“ur du scoutisme.",

                        points: 0

                    },

                    {

                        emoji: "â¤ï¸",

                        text: "Je lui demande comment il se sent et ce qu'il aime faire",

                        correct: true,

                        sylphe: "kawane",

                        feedback: "TrÃ¨s bien ! Tu es attentif aux autres comme Kawane. L'Ã©coute est prÃ©cieuse.",

                        points: 20

                    }

                ]

            },

            {

                id: 5,

                situation: "ğŸ® Pendant le grand jeu, ton Ã©quipe perd. Certains scouts sont dÃ©Ã§us et en colÃ¨re.",

                choices: [

                    {

                        emoji: "ğŸ˜Š",

                        text: "Je dis que ce n'est pas grave, l'important c'est de s'Ãªtre amusÃ©s et d'avoir fait de notre mieux",

                        correct: true,

                        sylphe: "laline",

                        feedback: "Super ! Tu es bon joueur comme Laline. L'esprit sportif est important.",

                        points: 20

                    },

                    {

                        emoji: "ğŸ˜ ",

                        text: "Je me plains et je dis que ce n'est pas juste",

                        correct: false,

                        feedback: "Un scout sait perdre avec Ã©lÃ©gance et apprend de ses erreurs. La dÃ©faite fait partie du jeu.",

                        points: 0

                    },

                    {

                        emoji: "ğŸ¤”",

                        text: "Je prends un moment pour remercier mon Ã©quipe et on rÃ©flÃ©chit Ã  ce qu'on peut amÃ©liorer",

                        correct: true,

                        sylphe: "yzo",

                        feedback: "Excellent ! Tu es honnÃªte et constructif comme YzÃ´. Apprendre de ses erreurs est important.",

                        points: 20

                    }

                ]

            }

        ];



        // Variables du mode scÃ©narios

        let currentScenarioIndex = 0;

        let scenariosScore = 0;

        let scenariosCorrectAnswers = 0;

        let selectedChoice = null;



        // Initialiser le mode scÃ©narios

        function initScenariosMode() {

            currentScenarioIndex = 0;

            scenariosScore = 0;

            scenariosCorrectAnswers = 0;

            selectedChoice = null;



            document.getElementById('scenarios-final').style.display = 'none';

            document.getElementById('scenarios-score-display').style.display = 'block';

            document.getElementById('total-scenarios').textContent = scenarios.length;



            displayScenario();

        }



        // Afficher un scÃ©nario

        function displayScenario() {

            const scenario = scenarios[currentScenarioIndex];

            const container = document.getElementById('scenario-container');



            let html = `

                <div style="background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 3px solid var(--c-orange-600); border-radius: var(--r-md); padding: 2rem; margin: 2rem 0;">

                    <h3 style="font-family: 'Patrick Hand', cursive; font-size: 1.8rem; color: var(--c-orange-600); margin-bottom: 1rem; text-align: center;">ScÃ©nario ${currentScenarioIndex + 1}</h3>

                    <div style="background: white; padding: 1.5rem; border-radius: var(--r-sm); border-left: 4px solid var(--c-orange-600); margin-bottom: 1.5rem; font-size: 1.1rem; line-height: 1.6;">${scenario.situation}</div>

                    <p style="text-align: center; font-weight: bold; color: var(--c-orange-600); margin-bottom: 1rem;">

                        Que ferais-tu ? ğŸ¤”

                    </p>

                    <div style="display: flex; flex-direction: column; gap: 1rem; margin: 2rem 0;">

            `;



            scenario.choices.forEach((choice, index) => {

                html += `

                    <button style="background: white; border: 3px solid var(--c-ink-900); border-radius: var(--r-md); padding: 1.5rem; text-align: left; cursor: pointer; transition: all 0.3s ease; font-family: 'Nunito', sans-serif; font-size: 1rem; line-height: 1.5; display: flex; align-items: flex-start; gap: 1rem;" onclick="selectScenarioChoice(${index})" data-choice-index="${index}">

                        <span style="font-size: 2rem; flex-shrink: 0;">${choice.emoji}</span>

                        <span style="flex: 1;">${choice.text}</span>

                    </button>

                `;

            });



            html += `

                    </div>

                </div>

            `;



            container.innerHTML = html;



            // Cacher le feedback

            const feedback = document.getElementById('scenario-feedback');

            feedback.style.display = 'none';

            feedback.innerHTML = '';



            // Mettre Ã  jour le numÃ©ro de scÃ©nario

            document.getElementById('scenario-number').textContent = currentScenarioIndex + 1;

            document.getElementById('scenarios-score').textContent = scenariosScore;



            selectedChoice = null;

        }



        // SÃ©lectionner un choix

        function selectScenarioChoice(choiceIndex) {

            const scenario = scenarios[currentScenarioIndex];

            const choice = scenario.choices[choiceIndex];

            const buttons = document.querySelectorAll('[data-choice-index]');



            // DÃ©sactiver tous les boutons

            buttons.forEach(btn => {

                btn.style.pointerEvents = 'none';

                btn.style.opacity = '0.7';

            });



            // Marquer le choix sÃ©lectionnÃ©

            const selectedButton = document.querySelector(`[data-choice-index="${choiceIndex}"]`);

            selectedButton.style.background = choice.correct ? 'rgba(46, 125, 50, 0.2)' : 'rgba(211, 47, 47, 0.2)';

            selectedButton.style.borderColor = choice.correct ? '#2e7d32' : '#d32f2f';



            selectedChoice = choiceIndex;



            // Mettre Ã  jour le score

            if (choice.correct) {

                scenariosScore += choice.points;

                scenariosCorrectAnswers++;

                document.getElementById('scenarios-score').textContent = scenariosScore;

            }



            // Afficher le feedback

            showScenarioFeedback(choice);



            // Afficher le bouton suivant aprÃ¨s un dÃ©lai

            setTimeout(() => {

                const feedback = document.getElementById('scenario-feedback');

                const nextBtn = document.createElement('div');

                nextBtn.style.textAlign = 'center';

                nextBtn.style.margin = '2rem 0';

                nextBtn.innerHTML = `

                    <button class="fey-btn" onclick="nextScenario()">

                        ${currentScenarioIndex < scenarios.length - 1 ? 'â¡ï¸ ScÃ©nario Suivant' : 'ğŸ‰ Voir les RÃ©sultats'}

                    </button>

                `;

                feedback.appendChild(nextBtn);

            }, 500);

        }



        // Afficher le feedback d'un choix

        function showScenarioFeedback(choice) {

            const feedback = document.getElementById('scenario-feedback');

            feedback.style.display = 'block';

            feedback.style.background = choice.correct ? 'linear-gradient(135deg, #c8e6c9, #a5d6a7)' : 'linear-gradient(135deg, #ffcdd2, #ffab91)';

            feedback.style.borderColor = choice.correct ? '#2e7d32' : '#d32f2f';



            let reactionHTML = '';

            if (choice.correct && choice.sylphe) {

                const sylphe = sylphes[choice.sylphe];

                reactionHTML = `

                    <div style="background: rgba(255, 255, 255, 0.9); padding: 1rem; border-radius: var(--r-sm); border-left: 4px solid var(--c-orange-600); margin-top: 1rem; font-style: italic; display: flex; align-items: center; gap: 1rem;">

                        <img src="${sylphe.image}" alt="${sylphe.name}" style="width: 60px; height: 60px; object-fit: contain; flex-shrink: 0;" onerror="this.style.display='none';">

                        <div>

                            <strong>${sylphe.icon} ${sylphe.name} dit :</strong><br>

                            ${choice.feedback}

                        </div>

                    </div>

                `;

            } else {

                reactionHTML = `

                    <div style="background: rgba(255, 255, 255, 0.9); padding: 1rem; border-radius: var(--r-sm); border-left: 4px solid var(--c-orange-600); margin-top: 1rem; font-style: italic; display: flex; align-items: center; gap: 1rem;">

                        <div style="font-size: 2rem;">ğŸ’­</div>

                        <div>${choice.feedback}</div>

                    </div>

                `;

            }



            feedback.innerHTML = `

                <div style="font-family: 'Patrick Hand', cursive; font-size: 1.8rem; margin-bottom: 1rem; text-align: center;">

                    ${choice.correct ? 'âœ… Bien jouÃ© !' : 'âŒ Pas tout Ã  fait...'}

                </div>

                ${reactionHTML}

            `;



            // DÃ©filer vers le feedback

            feedback.scrollIntoView({ behavior: 'smooth', block: 'center' });

        }



        // ScÃ©nario suivant

        function nextScenario() {

            currentScenarioIndex++;

            if (currentScenarioIndex < scenarios.length) {

                displayScenario();

                window.scrollTo({ top: 0, behavior: 'smooth' });

            } else {

                showScenariosResult();

            }

        }
        // Afficher les rÃ©sultats finaux

        function showScenariosResult() {

            document.getElementById('scenario-container').style.display = 'none';

            document.getElementById('scenario-feedback').style.display = 'none';

            document.getElementById('scenarios-score-display').style.display = 'none';

            document.getElementById('scenarios-final').style.display = 'block';



            const percentage = Math.round((scenariosCorrectAnswers / scenarios.length) * 100);



            document.getElementById('final-scenarios-score').textContent = scenariosScore;

            document.getElementById('final-correct-answers').textContent = scenariosCorrectAnswers;

            document.getElementById('final-total-questions').textContent = scenarios.length;



            let message = '';

            if (percentage === 100) {

                message = "ğŸŒŸ Incroyable ! Tu es un vrai scout ! Tous les Sylphes sont fiers de toi. Tu as compris l'esprit du scoutisme !";

            } else if (percentage >= 80) {

                message = "ğŸŠ Bravo ! Tu as trÃ¨s bien rÃ©ussi ! Les Sylphes te fÃ©licitent. Continue sur cette voie !";

            } else if (percentage >= 60) {

                message = "ğŸ‘ Bien jouÃ© ! Tu es sur la bonne voie. Les Sylphes t'encouragent Ã  continuer d'apprendre !";

            } else {

                message = "ğŸ’ª Continue tes efforts ! Les Sylphes croient en toi. Chaque jour est une nouvelle chance d'apprendre !";

            }



            document.getElementById('final-sylphes-message').textContent = message;



            window.scrollTo({ top: 0, behavior: 'smooth' });

        }



        // Recommencer le mode scÃ©narios

        function recommencerScenarios() {

            document.getElementById('scenario-container').style.display = 'block';

            document.getElementById('scenario-feedback').style.display = 'block';

            initScenariosMode();

        }



        // Ouvrir le jeu de tente 1

        function ouvrirJeuTente() {

            const windowFeatures = 'width=900,height=700,scrollbars=yes,resizable=yes,status=yes,toolbar=no,menubar=no,location=no';

            const jeuWindow = window.open('jeu_tente.html', 'JeuTente', windowFeatures);



            if (jeuWindow) {

                // Centrer la fenÃªtre

                jeuWindow.moveTo(

                    (screen.width - 900) / 2,

                    (screen.height - 700) / 2

                );

                jeuWindow.focus();

            } else {

                // Si les popups sont bloquÃ©s, ouvrir dans un nouvel onglet

                window.open('jeu_tente.html', '_blank');

            }

        }



        // Ouvrir le jeu de tente 2

        function ouvrirJeuTente2() {

            const windowFeatures = 'width=900,height=700,scrollbars=yes,resizable=yes,status=yes,toolbar=no,menubar=no,location=no';

            const jeuWindow = window.open('jeu_tente2.html', 'JeuTente2', windowFeatures);



            if (jeuWindow) {

                // Centrer la fenÃªtre

                jeuWindow.moveTo(

                    (screen.width - 900) / 2,

                    (screen.height - 700) / 2

                );

                jeuWindow.focus();

            } else {

                // Si les popups sont bloquÃ©s, ouvrir dans un nouvel onglet

                window.open('jeu_tente2.html', '_blank');

            }

        }



        // Ouvrir le jeu de sac scout

        function ouvrirJeuSac() {

            const windowFeatures = 'width=1200,height=800,scrollbars=yes,resizable=yes,status=yes,toolbar=no,menubar=no,location=no';

            const jeuWindow = window.open('scout_bag_game (1).html', 'JeuSacScout', windowFeatures);



            if (jeuWindow) {

                // Centrer la fenÃªtre

                jeuWindow.moveTo(

                    (screen.width - 1200) / 2,

                    (screen.height - 800) / 2

                );

                jeuWindow.focus();

            } else {

                // Si les popups sont bloquÃ©s, ouvrir dans un nouvel onglet

                window.open('scout_bag_game (1).html', '_blank');

            }

        }
        // Ouvrir la vidÃ©o tutoriel

        function ouvrirVideoTutorial() {

            // Ouvrir la vidÃ©o YouTube dans un nouvel onglet

            window.open('https://www.youtube.com/watch?v=1s6PgZ0o-vk', '_blank');



            // Afficher un message informatif

            alert('ğŸ¬ La vidÃ©o s\'ouvre dans un nouvel onglet !\n\nğŸ’¡ Conseil : Mets la vidÃ©o en plein Ã©cran pour mieux voir les dÃ©tails du montage de tente.');

        }
        // Ouvrir Google Maps

        function ouvrirMaps() {

            window.open('https://maps.google.com/?q=Jambville+78440', '_blank');

        }



        // Ouvrir WhatsApp

        function ouvrirWhatsApp() {

            window.open('https://chat.whatsapp.com/F2crLBuVQ17L5VbrzoR0xX', '_blank');

        }



        // Variables globales pour le calendrier

        let currentCalendarMonth = new Date().getMonth();

        let currentCalendarYear = new Date().getFullYear();



        // Fonction pour charger le calendrier

        function loadCalendar() {

            const calendarContainer = document.getElementById('calendar-container');

            if (!calendarContainer) return;



            const monthNames = [

                'Janvier', 'FÃ©vrier', 'Mars', 'Avril', 'Mai', 'Juin',

                'Juillet', 'AoÃ»t', 'Septembre', 'Octobre', 'Novembre', 'DÃ©cembre'

            ];



            const daysInMonth = new Date(currentCalendarYear, currentCalendarMonth + 1, 0).getDate();

            const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1).getDay();

            const today = new Date();



            let calendarHTML = `

                <div style="background: white; padding: 1rem; height: 100%; overflow-y: auto;">

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">

                        <button onclick="changeMonth(-1)" style="

                            background: var(--c-orange-600);

                            color: white;

                            border: 2px solid var(--c-ink-900);

                            border-radius: var(--r-sm);

                            padding: 0.5rem 1rem;

                            cursor: pointer;

                            font-family: 'Patrick Hand', cursive;

                            font-size: 1rem;

                            transition: all 0.3s ease;

                        " onmouseover="this.style.background='var(--c-gold-400)'" onmouseout="this.style.background='var(--c-orange-600)'">

                            â¬…ï¸ Mois prÃ©cÃ©dent

                        </button>

                        <div style="display: flex; flex-direction: column; align-items: center;">

                            <h3 style="font-family: 'Patrick Hand', cursive; color: var(--c-orange-600); font-size: 1.5rem; margin: 0;">

                                ${monthNames[currentCalendarMonth]} ${currentCalendarYear}

                            </h3>

                            <button onclick="goToToday()" style="

                                background: var(--c-forest-700);

                                color: white;

                                border: 2px solid var(--c-ink-900);

                                border-radius: var(--r-sm);

                                padding: 0.25rem 0.75rem;

                                cursor: pointer;

                                font-family: 'Patrick Hand', cursive;

                                font-size: 0.8rem;

                                transition: all 0.3s ease;

                                margin-top: 0.25rem;

                            " onmouseover="this.style.background='var(--c-forest-500)'" onmouseout="this.style.background='var(--c-forest-700)'">

                                ğŸ“… Aujourd'hui

                            </button>

                        </div>

                        <button onclick="changeMonth(1)" style="

                            background: var(--c-orange-600);

                            color: white;

                            border: 2px solid var(--c-ink-900);

                            border-radius: var(--r-sm);

                            padding: 0.5rem 1rem;

                            cursor: pointer;

                            font-family: 'Patrick Hand', cursive;

                            font-size: 1rem;

                            transition: all 0.3s ease;

                        " onmouseover="this.style.background='var(--c-gold-400)'" onmouseout="this.style.background='var(--c-orange-600)'">

                            Mois suivant â¡ï¸

                        </button>

                    </div>

                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; margin-bottom: 1rem;">

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Lun</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Mar</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Mer</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Jeu</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Ven</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Sam</div>

                        <div style="text-align: center; font-weight: bold; padding: 0.5rem; background: var(--c-orange-600); color: white; border-radius: var(--r-sm);">Dim</div>

                    </div>

                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px;">

            `;



            // Ajouter les jours vides du dÃ©but du mois

            for (let i = 0; i < firstDay; i++) {

                calendarHTML += `<div style="padding: 0.5rem; min-height: 40px;"></div>`;

            }



            // Ajouter les jours du mois

            for (let day = 1; day <= daysInMonth; day++) {

                const isToday = day === today.getDate() &&

                               currentCalendarMonth === today.getMonth() &&

                               currentCalendarYear === today.getFullYear();

                const isEvent = hasEventOnDay(day, currentCalendarMonth + 1, currentCalendarYear);



                let dayStyle = `

                    padding: 0.5rem;

                    min-height: 40px;

                    border: 2px solid var(--c-ink-900);

                    border-radius: var(--r-sm);

                    cursor: pointer;

                    transition: all 0.3s ease;

                    background: ${isToday ? 'var(--c-orange-600)' : isEvent ? 'var(--c-forest-700)' : 'white'};

                    color: ${isToday || isEvent ? 'white' : 'var(--c-ink-900)'};

                `;



                calendarHTML += `

                    <div style="${dayStyle}" onclick="showEventDetails(${day}, ${currentCalendarMonth + 1}, ${currentCalendarYear})">

                        <div style="font-weight: bold; margin-bottom: 0.25rem;">${day}</div>

                        ${isEvent ? '<div style="font-size: 0.7rem;">ğŸ¯</div>' : ''}

                    </div>

                `;

            }



            calendarHTML += `</div></div>`;

            calendarContainer.innerHTML = calendarHTML;

        }



        // Fonction pour charger les sorties du calendrier dans le registre

        function loadTripsFromCalendar() {

            console.log('ğŸ”„ Chargement des sorties du calendrier...');

            

            const outingsList = document.getElementById('outingsList');

            if (!outingsList) {

                console.error('âŒ outingsList non trouvÃ©');

                alert('âŒ outingsList non trouvÃ©');

                return;

            }



            console.log('âœ… outingsList trouvÃ©');



            // RÃ©cupÃ©rer les Ã©vÃ©nements

            const events = getCalendarEvents();

            console.log('ğŸ“… Ã‰vÃ©nements rÃ©cupÃ©rÃ©s:', Object.keys(events).length);

            

            if (Object.keys(events).length === 0) {

                outingsList.innerHTML = '<div style="text-align: center; color: #666; padding: 2rem;">âš ï¸ Aucune sortie trouvÃ©e dans le calendrier</div>';

                return;

            }

            

            // Construire le HTML des cases Ã  cocher

            let checkboxesHTML = '';

            let count = 0;

            

            Object.entries(events).forEach(([dateKey, event]) => {

                console.log(`ğŸ“… Ajout: ${dateKey} - ${event.title}`);

                

                // CrÃ©er un ID simple

                const tripId = dateKey.replace(/-/g, '_');

                

                // CrÃ©er une case Ã  cocher

                checkboxesHTML += `

                    <div style="display: flex; align-items: center; padding: 0.5rem; border-bottom: 1px solid #eee;">

                        <input type="checkbox" id="outing_${tripId}" value="${tripId}" onchange="selectOuting('${tripId}')" style="margin-right: 0.75rem; transform: scale(1.2);">

                        <label for="outing_${tripId}" style="flex: 1; cursor: pointer; font-size: 1rem;">

                            <strong>${event.title}</strong>

                            <br><small style="color: #666;">${dateKey}</small>

                        </label>

                    </div>

                `;

                count++;

                

                console.log(`âœ… Case Ã  cocher ajoutÃ©e: ${event.title}`);

            });

            

            // Remplacer le contenu

            outingsList.innerHTML = checkboxesHTML;

            

            console.log(`âœ… ${count} sorties ajoutÃ©es avec cases Ã  cocher`);

            alert(`âœ… ${count} sorties chargÃ©es avec cases Ã  cocher`);

        }

        

        // Fonction pour gÃ©rer la sÃ©lection d'une sortie

        function selectOuting(tripId) {

            console.log('ğŸ¯ Sortie sÃ©lectionnÃ©e:', tripId);

            

            // DÃ©cocher toutes les autres cases

            const allCheckboxes = document.querySelectorAll('#outingsList input[type="checkbox"]');

            allCheckboxes.forEach(checkbox => {

                if (checkbox.value !== tripId) {

                    checkbox.checked = false;

                }

            });

            

            // Charger les dÃ©tails de la sortie sÃ©lectionnÃ©e

            if (document.getElementById(`outing_${tripId}`).checked) {

                loadAttendanceForOuting(tripId);

            } else {

                // Masquer les dÃ©tails si dÃ©cochÃ©

                const outingInfo = document.getElementById('outingInfo');

                if (outingInfo) {

                    outingInfo.style.display = 'none';

                }

            }

        }
        // Fonction pour rÃ©cupÃ©rer les Ã©vÃ©nements du calendrier

        function getCalendarEvents() {

            // RÃ©cupÃ©rer les sorties depuis le localStorage (admin-outings)

            const adminOutings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            

            // Convertir les sorties admin en format Ã©vÃ©nements calendrier

            const events = {};

            

            adminOutings.forEach(outing => {

                // Convertir la date au format DD-MM-YYYY pour la clÃ©

                const dateKey = outing.startDate.split('-').reverse().join('-');

                

                events[dateKey] = {

                    title: outing.name,

                    time: outing.departureTime || 'Non spÃ©cifiÃ©e',

                    description: outing.description || 'Aucune description'

                };

            });

            

            // Si aucune sortie admin, utiliser les sorties par dÃ©faut du programme 2025-2026

            if (Object.keys(events).length === 0) {

                return getDefaultCalendarEvents();

            }

            

            // Code de fallback (ne devrait plus Ãªtre utilisÃ©)

            return {

                // DÃ©cembre 2024

                '15-12-2024': {

                    title: 'ğŸ•¯ï¸ LumiÃ¨re de BethlÃ©em 2024',

                    time: 'Dimanche',

                    description: 'LumiÃ¨re de BethlÃ©em + CrÃ¨che vivante'

                },

                '21-12-2024': {

                    title: 'ğŸ„ RÃ©union de Fin d\'AnnÃ©e',

                    time: 'Samedi',

                    description: 'RÃ©union de clÃ´ture de l\'annÃ©e 2024'

                },

                '22-12-2024': {

                    title: 'ğŸ„ RÃ©union de Fin d\'AnnÃ©e',

                    time: 'Dimanche',

                    description: 'RÃ©union de clÃ´ture de l\'annÃ©e 2024'

                },



                // Janvier 2025

                '5-1-2025': {

                    title: 'ğŸ“‹ RÃ©union de RentrÃ©e',

                    time: 'Dimanche',

                    description: 'RÃ©union de rentrÃ©e pour l\'annÃ©e 2025'

                },

                '19-1-2025': {

                    title: 'âš“ Sortie MusÃ©e de la Marine',

                    time: 'Dimanche',

                    description: 'Sortie MusÃ©e de la Marine + galettes'

                },

                '26-1-2025': {

                    title: 'â„ï¸ Weekend de Janvier',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend d\'hiver avec activitÃ©s scoutes'

                },

                '27-1-2025': {

                    title: 'â„ï¸ Weekend de Janvier',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'hiver avec activitÃ©s scoutes'

                },



                // FÃ©vrier 2025

                '2-2-2025': {

                    title: 'â„ï¸ Weekend de FÃ©vrier',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'hiver avec activitÃ©s scoutes'

                },

                '9-2-2025': {

                    title: 'ğŸ—¼ Sortie Montmartre',

                    time: 'Dimanche',

                    description: 'DÃ©couverte de Montmartre'

                },

                '16-2-2025': {

                    title: 'â„ï¸ Weekend de FÃ©vrier',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend d\'hiver avec activitÃ©s scoutes'

                },

                '23-2-2025': {

                    title: 'ğŸ° Sortie ChÃ¢teau',

                    time: 'Dimanche',

                    description: 'Visite d\'un chÃ¢teau historique'

                },



                // Mars 2025

                '2-3-2025': {

                    title: 'ğŸŒ¸ Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },

                '9-3-2025': {

                    title: 'ğŸŒ¿ Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie dÃ©couverte de la nature'

                },

                '16-3-2025': {

                    title: 'ğŸŒ¸ Weekend de Mars',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de printemps'

                },

                '23-3-2025': {

                    title: 'ğŸ­ Sortie Culturelle',

                    time: 'Dimanche',

                    description: 'Sortie culturelle et artistique'

                },

                '30-3-2025': {

                    title: 'ğŸŒ¸ Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },



                // Avril 2025

                '6-4-2025': {

                    title: 'ğŸ° Weekend de PÃ¢ques',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de PÃ¢ques avec activitÃ©s spÃ©ciales'

                },

                '13-4-2025': {

                    title: 'ğŸ° Weekend de PÃ¢ques',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de PÃ¢ques avec activitÃ©s spÃ©ciales'

                },

                '20-4-2025': {

                    title: 'ğŸŒ¿ Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie dÃ©couverte de la nature printaniÃ¨re'

                },

                '27-4-2025': {

                    title: 'ğŸŒ¸ Weekend d\'Avril',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de printemps'

                },



                // Mai 2025

                '4-5-2025': {

                    title: 'ğŸŒ¸ Weekend de Mai',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },

                '11-5-2025': {

                    title: 'â›µ Sortie Voile',

                    time: 'Dimanche',

                    description: 'Sortie voile Ã  Verneuil sur Seine'

                },

                '18-5-2025': {

                    title: 'ğŸŒ¸ Weekend de Mai',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de printemps'

                },

                '25-5-2025': {

                    title: 'ğŸ­ Sortie Culturelle',

                    time: 'Dimanche',

                    description: 'Sortie culturelle et artistique'

                },



                // Juin 2025

                '1-6-2025': {

                    title: 'â˜€ï¸ Weekend de Juin',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'Ã©tÃ©'

                },

                '8-6-2025': {

                    title: 'ğŸŒ¿ Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie dÃ©couverte de la nature estivale'

                },

                '15-6-2025': {

                    title: 'â˜€ï¸ Weekend de Juin',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend d\'Ã©tÃ©'

                },

                '22-6-2025': {

                    title: 'ğŸ¯ Sortie Finale',

                    time: 'Dimanche',

                    description: 'Sortie de clÃ´ture de l\'annÃ©e scolaire'

                },

                '29-6-2025': {

                    title: 'ğŸ“‹ RÃ©union de Fin d\'AnnÃ©e',

                    time: 'Dimanche',

                    description: 'RÃ©union de clÃ´ture de l\'annÃ©e scolaire'

                },



                // Juillet 2025 - Camp d'Ã©tÃ©

                '6-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'DÃ©but du camp',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '7-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 2',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '8-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 3',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '9-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 4',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '10-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 5',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '11-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 6',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '12-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 7',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '13-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 8',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '14-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 9',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '15-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 10',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '16-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 11',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '17-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 12',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '18-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 13',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '19-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Fin du camp',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },



                // Octobre 2025

                '3-10-2025': {

                    title: 'ğŸ•ï¸ Weekend de Groupe',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de groupe avec activitÃ©s scoutes'

                },

                '4-10-2025': {

                    title: 'ğŸ•ï¸ Weekend de Groupe',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de groupe avec activitÃ©s scoutes'

                },

                '12-10-2025': {

                    title: 'â›µ Sortie Voile',

                    time: 'Dimanche',

                    description: 'Sortie voile Ã  Verneuil sur Seine'

                },



                // Novembre 2025

                '15-11-2025': {

                    title: 'ğŸ° Weekend Abbaye d\'Epernon',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend Ã  l\'Abbaye d\'Epernon'

                },

                '16-11-2025': {

                    title: 'ğŸ° Weekend Abbaye d\'Epernon',

                    time: 'Dimanche - Retour',

                    description: 'Weekend Ã  l\'Abbaye d\'Epernon'

                }

            };

        }
        // Fonction pour charger le registre d'une sortie

        function loadTripRegistry() {

            const tripSelector = document.getElementById('tripSelector');

            const tripRegistry = document.getElementById('tripRegistry');

            const registryContent = document.getElementById('registryContent');



            if (!tripSelector || !tripRegistry || !registryContent) return;



            const selectedTripId = tripSelector.value;

            

            if (!selectedTripId) {

                tripRegistry.style.display = 'none';

                return;

            }



            // Afficher le registre

            tripRegistry.style.display = 'block';



            // Charger les donnÃ©es de la sortie depuis le calendrier

            const calendarEvents = getCalendarEvents();

            let selectedTrip = null;

            let selectedDate = null;



            // Trouver la sortie sÃ©lectionnÃ©e

            Object.entries(calendarEvents).forEach(([dateKey, event]) => {

                const tripId = dateKey.replace(/-/g, '_');

                if (tripId === selectedTripId) {

                    selectedTrip = event;

                    selectedDate = dateKey;

                }

            });



            if (!selectedTrip) {

                registryContent.innerHTML = '<p>âŒ Sortie non trouvÃ©e dans le calendrier</p>';

                return;

            }



            // CrÃ©er le contenu du registre

            const tripDate = new Date(selectedDate.split('-').reverse().join('-'));

            const formattedDate = tripDate.toLocaleDateString('fr-FR', {

                weekday: 'long',

                day: 'numeric',

                month: 'long',

                year: 'numeric'

            });



            registryContent.innerHTML = `

                <div style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); padding: 1rem; border-radius: var(--r-sm); margin-bottom: 1rem;">

                    <h4 style="margin: 0 0 0.5rem 0; color: var(--c-forest-700);">${selectedTrip.title}</h4>

                    <p style="margin: 0; color: var(--c-forest-600);">ğŸ“… ${formattedDate}</p>

                    ${selectedTrip.description ? `<p style="margin: 0.5rem 0 0 0; color: var(--c-forest-600);">${selectedTrip.description}</p>` : ''}

                </div>

                

                <div style="background: white; padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                    <h5 style="margin: 0 0 1rem 0; color: var(--c-ink-900);">ğŸ“ Registre de prÃ©sence</h5>

                    <p style="color: var(--c-ink-600); margin: 0;">Le registre de prÃ©sence sera disponible ici pour cette sortie.</p>

                    <div style="margin-top: 1rem; padding: 1rem; background: var(--c-gold-100); border-radius: var(--r-sm); border-left: 4px solid var(--c-gold-600);">

                        <strong>ğŸ’¡ FonctionnalitÃ© en dÃ©veloppement</strong><br>

                        Le systÃ¨me de registre de prÃ©sence sera bientÃ´t intÃ©grÃ© avec les donnÃ©es des Ã©quipes.

                    </div>

                </div>

            `;

        }
        // Fonction pour vÃ©rifier s'il y a un Ã©vÃ©nement un jour donnÃ©

        function hasEventOnDay(day, month, year) {

            const events = {

                // DÃ©cembre 2024

                '15-12-2024': true, // LumiÃ¨re de BethlÃ©em 2024

                '21-12-2024': true, // RÃ©union de fin d'annÃ©e

                '22-12-2024': true, // RÃ©union de fin d'annÃ©e



                // Janvier 2025

                '12-1-2025': true, // RÃ©union de rentrÃ©e

                '19-1-2025': true, // Sortie MusÃ©e de la Marine

                '26-1-2025': true, // Weekend de janvier



                // FÃ©vrier 2025

                '2-2-2025': true, // Weekend de fÃ©vrier

                '9-2-2025': true, // Sortie Montmartre

                '16-2-2025': true, // Weekend de fÃ©vrier

                '23-2-2025': true, // Sortie chÃ¢teau



                // Mars 2025

                '2-3-2025': true, // Weekend de mars

                '9-3-2025': true, // Sortie nature

                '16-3-2025': true, // Weekend de mars

                '23-3-2025': true, // Sortie culturelle

                '30-3-2025': true, // Weekend de mars



                // Avril 2025

                '6-4-2025': true, // Weekend de PÃ¢ques

                '13-4-2025': true, // Weekend de PÃ¢ques

                '20-4-2025': true, // Sortie nature

                '27-4-2025': true, // Weekend d'avril



                // Mai 2025

                '4-5-2025': true, // Weekend de mai

                '11-5-2025': true, // Sortie voile

                '18-5-2025': true, // Weekend de mai

                '25-5-2025': true, // Sortie culturelle



                // Juin 2025

                '1-6-2025': true, // Weekend de juin

                '8-6-2025': true, // Sortie nature

                '15-6-2025': true, // Weekend de juin

                '22-6-2025': true, // Sortie finale

                '29-6-2025': true, // RÃ©union de fin d'annÃ©e



                // Juillet 2025

                '6-7-2025': true, // Camp d'Ã©tÃ© (dÃ©but)

                '7-7-2025': true, // Camp d'Ã©tÃ©

                '8-7-2025': true, // Camp d'Ã©tÃ©

                '9-7-2025': true, // Camp d'Ã©tÃ©

                '10-7-2025': true, // Camp d'Ã©tÃ©

                '11-7-2025': true, // Camp d'Ã©tÃ©

                '12-7-2025': true, // Camp d'Ã©tÃ©

                '13-7-2025': true, // Camp d'Ã©tÃ©

                '14-7-2025': true, // Camp d'Ã©tÃ©

                '15-7-2025': true, // Camp d'Ã©tÃ©

                '16-7-2025': true, // Camp d'Ã©tÃ©

                '17-7-2025': true, // Camp d'Ã©tÃ©

                '18-7-2025': true, // Camp d'Ã©tÃ©

                '19-7-2025': true, // Camp d'Ã©tÃ© (fin)



                // Septembre 2025

                '28-9-2025': true, // RÃ©union parents



                // Octobre 2025

                '3-10-2025': true, // Weekend de Groupe (Jour 1)

                '4-10-2025': true, // Weekend de Groupe (Jour 2)

                '12-10-2025': true, // Sortie voile (Verneuil sur Seine)



                // Novembre 2025

                '15-11-2025': true, // Weekend Abbaye d'Epernon (Jour 1)

                '16-11-2025': true, // Weekend Abbaye d'Epernon (Jour 2)



                // DÃ©cembre 2025

                '14-12-2025': true, // LumiÃ¨re de BethlÃ©em + CrÃ¨che vivante



                // Janvier 2026

                '18-1-2026': true, // Sortie MusÃ©e de la Marine + galettes



                // FÃ©vrier 2026

                '8-2-2026': true, // Sortie Montmartre



                // Mars 2026

                '14-3-2026': true, // Weekend de mars (Jour 1)

                '15-3-2026': true, // Weekend de mars (Jour 2)



                // Avril 2026

                '5-4-2026': true, // Sortie chÃ¢teau



                // Mai 2026

                '15-5-2026': true, // Mini-camp Mont Saint-Michel (Jour 1)

                '16-5-2026': true, // Mini-camp Mont Saint-Michel (Jour 2)

                '17-5-2026': true, // Mini-camp Mont Saint-Michel (Jour 3)



                // Juin 2026

                '12-6-2026': true, // RÃ©union prÃ©sentation camp

                '13-6-2026': true, // Weekend de juin (Jour 1)

                '14-6-2026': true, // Weekend de juin (Jour 2)



                // Juillet 2026

                '5-7-2026': true, // Camp d'Ã©tÃ© (dÃ©but)

                '6-7-2026': true, // Camp d'Ã©tÃ©

                '7-7-2026': true, // Camp d'Ã©tÃ©

                '8-7-2026': true, // Camp d'Ã©tÃ©

                '9-7-2026': true, // Camp d'Ã©tÃ©

                '10-7-2026': true, // Camp d'Ã©tÃ©

                '11-7-2026': true, // Camp d'Ã©tÃ©

                '12-7-2026': true, // Camp d'Ã©tÃ©

                '13-7-2026': true, // Camp d'Ã©tÃ©

                '14-7-2026': true, // Camp d'Ã©tÃ©

                '15-7-2026': true, // Camp d'Ã©tÃ©

                '16-7-2026': true, // Camp d'Ã©tÃ©

                '17-7-2026': true, // Camp d'Ã©tÃ©

                '18-7-2026': true, // Camp d'Ã©tÃ©

                '19-7-2026': true  // Camp d'Ã©tÃ© (fin)

            };



            const dateKey = `${day}-${month}-${year}`;

            return events[dateKey] || false;

        }
        // Fonction pour afficher les dÃ©tails d'un Ã©vÃ©nement

        function showEventDetails(day, month, year) {

            const events = {

                // DÃ©cembre 2024

                '15-12-2024': {

                    title: 'ğŸ•¯ï¸ LumiÃ¨re de BethlÃ©em 2024',

                    time: 'Dimanche',

                    description: 'LumiÃ¨re de BethlÃ©em + CrÃ¨che vivante'

                },

                '21-12-2024': {

                    title: 'ğŸ„ RÃ©union de Fin d\'AnnÃ©e',

                    time: 'Samedi',

                    description: 'RÃ©union de clÃ´ture de l\'annÃ©e 2024'

                },

                '22-12-2024': {

                    title: 'ğŸ„ RÃ©union de Fin d\'AnnÃ©e',

                    time: 'Dimanche',

                    description: 'RÃ©union de clÃ´ture de l\'annÃ©e 2024'

                },



                // Janvier 2025

                '12-1-2025': {

                    title: 'ğŸ“‹ RÃ©union de RentrÃ©e',

                    time: 'Dimanche',

                    description: 'RÃ©union de rentrÃ©e pour l\'annÃ©e 2025'

                },

                '19-1-2025': {

                    title: 'âš“ Sortie MusÃ©e de la Marine',

                    time: 'Dimanche',

                    description: 'Sortie MusÃ©e de la Marine + galettes'

                },

                '26-1-2025': {

                    title: 'â„ï¸ Weekend de Janvier',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend d\'hiver avec activitÃ©s scoutes'

                },



                // FÃ©vrier 2025

                '2-2-2025': {

                    title: 'â„ï¸ Weekend de FÃ©vrier',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'hiver avec activitÃ©s scoutes'

                },

                '9-2-2025': {

                    title: 'ğŸ—¼ Sortie Montmartre',

                    time: 'Dimanche',

                    description: 'DÃ©couverte de Montmartre'

                },

                '16-2-2025': {

                    title: 'â„ï¸ Weekend de FÃ©vrier',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend d\'hiver avec activitÃ©s scoutes'

                },

                '23-2-2025': {

                    title: 'ğŸ° Sortie ChÃ¢teau',

                    time: 'Dimanche',

                    description: 'Visite d\'un chÃ¢teau historique'

                },



                // Mars 2025

                '2-3-2025': {

                    title: 'ğŸŒ¸ Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },

                '9-3-2025': {

                    title: 'ğŸŒ¿ Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie dÃ©couverte de la nature'

                },

                '16-3-2025': {

                    title: 'ğŸŒ¸ Weekend de Mars',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de printemps'

                },

                '23-3-2025': {

                    title: 'ğŸ­ Sortie Culturelle',

                    time: 'Dimanche',

                    description: 'Sortie culturelle et artistique'

                },

                '30-3-2025': {

                    title: 'ğŸŒ¸ Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },



                // Avril 2025

                '6-4-2025': {

                    title: 'ğŸ° Weekend de PÃ¢ques',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de PÃ¢ques avec activitÃ©s spÃ©ciales'

                },

                '13-4-2025': {

                    title: 'ğŸ° Weekend de PÃ¢ques',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de PÃ¢ques avec activitÃ©s spÃ©ciales'

                },

                '20-4-2025': {

                    title: 'ğŸŒ¿ Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie dÃ©couverte de la nature printaniÃ¨re'

                },

                '27-4-2025': {

                    title: 'ğŸŒ¸ Weekend d\'Avril',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de printemps'

                },



                // Mai 2025

                '4-5-2025': {

                    title: 'ğŸŒ¸ Weekend de Mai',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },

                '11-5-2025': {

                    title: 'â›µ Sortie Voile',

                    time: 'Dimanche',

                    description: 'Sortie voile Ã  Verneuil sur Seine'

                },

                '18-5-2025': {

                    title: 'ğŸŒ¸ Weekend de Mai',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de printemps'

                },

                '25-5-2025': {

                    title: 'ğŸ­ Sortie Culturelle',

                    time: 'Dimanche',

                    description: 'Sortie culturelle et artistique'

                },



                // Juin 2025

                '1-6-2025': {

                    title: 'â˜€ï¸ Weekend de Juin',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'Ã©tÃ©'

                },

                '8-6-2025': {

                    title: 'ğŸŒ¿ Sortie Nature',

                    time: 'Dimanche',

                    description: 'Sortie dÃ©couverte de la nature estivale'

                },

                '15-6-2025': {

                    title: 'â˜€ï¸ Weekend de Juin',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend d\'Ã©tÃ©'

                },

                '22-6-2025': {

                    title: 'ğŸ¯ Sortie Finale',

                    time: 'Dimanche',

                    description: 'Sortie de clÃ´ture de l\'annÃ©e scolaire'

                },

                '29-6-2025': {

                    title: 'ğŸ“‹ RÃ©union de Fin d\'AnnÃ©e',

                    time: 'Dimanche',

                    description: 'RÃ©union de clÃ´ture de l\'annÃ©e scolaire'

                },



                // Juillet 2025 - Camp d'Ã©tÃ©

                '6-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'DÃ©but du camp',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '7-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 2',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '8-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 3',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '9-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 4',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '10-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 5',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '11-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 6',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '12-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 7',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '13-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 8',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '14-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 9',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '15-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 10',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '16-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 11',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '17-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 12',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '18-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Jour 13',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '19-7-2025': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ© 2025',

                    time: 'Fin du camp',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },



                // Septembre 2025

                '28-9-2025': {

                    title: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ RÃ©union Parents',

                    time: 'Dimanche',

                    description: 'RÃ©union d\'information pour les parents'

                },



                // Octobre 2025

                '3-10-2025': {

                    title: 'ğŸ•ï¸ Weekend de Groupe',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de groupe avec activitÃ©s scoutes'

                },

                '4-10-2025': {

                    title: 'ğŸ•ï¸ Weekend de Groupe',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de groupe avec activitÃ©s scoutes'

                },

                '12-10-2025': {

                    title: 'â›µ Sortie Voile',

                    time: 'Dimanche',

                    description: 'Sortie voile Ã  Verneuil sur Seine'

                },



                // Novembre 2025

                '15-11-2025': {

                    title: 'ğŸ° Weekend Abbaye d\'Epernon',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend au PrieurÃ© Saint Thomas'

                },

                '16-11-2025': {

                    title: 'ğŸ° Weekend Abbaye d\'Epernon',

                    time: 'Dimanche - Retour',

                    description: 'Weekend au PrieurÃ© Saint Thomas'

                },



                // DÃ©cembre 2025

                '14-12-2025': {

                    title: 'ğŸ•¯ï¸ LumiÃ¨re de BethlÃ©em',

                    time: 'Dimanche',

                    description: 'LumiÃ¨re de BethlÃ©em + CrÃ¨che vivante'

                },



                // Janvier 2026

                '18-1-2026': {

                    title: 'âš“ Sortie MusÃ©e de la Marine',

                    time: 'Dimanche',

                    description: 'Sortie MusÃ©e de la Marine + galettes'
                },
                // Mars 2026

                '14-3-2026': {

                    title: 'ğŸŒ¸ Weekend de Mars',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de printemps'

                },

                '15-3-2026': {

                    title: 'ğŸŒ¸ Weekend de Mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps'

                },



                // Avril 2026

                '5-4-2026': {

                    title: 'ğŸ° Sortie ChÃ¢teau',

                    time: 'Dimanche',

                    description: 'Visite d\'un chÃ¢teau historique'

                },



                // Mai 2026

                '15-5-2026': {

                    title: 'ğŸ° Mini-camp Mont Saint-Michel',

                    time: 'Vendredi - DÃ©part',

                    description: 'Mini-camp de 3 jours au Mont Saint-Michel'

                },

                '16-5-2026': {

                    title: 'ğŸ° Mini-camp Mont Saint-Michel',

                    time: 'Samedi',

                    description: 'Mini-camp de 3 jours au Mont Saint-Michel'

                },

                '17-5-2026': {

                    title: 'ğŸ° Mini-camp Mont Saint-Michel',

                    time: 'Dimanche - Retour',

                    description: 'Mini-camp de 3 jours au Mont Saint-Michel'
                },

                '13-6-2026': {

                    title: 'â˜€ï¸ Weekend de Juin',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend d\'Ã©tÃ©'

                },

                '14-6-2026': {

                    title: 'â˜€ï¸ Weekend de Juin',

                    time: 'Dimanche - Retour',

                    description: 'Weekend d\'Ã©tÃ©'

                },



                // Juillet 2026 - Camp d'Ã©tÃ©

                '5-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'DÃ©but du camp',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '6-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 2',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '7-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 3',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '8-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 4',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '9-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 5',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '10-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 6',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '11-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 7',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '12-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 8',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '13-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 9',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '14-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 10',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '15-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 11',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '16-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 12',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '17-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 13',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '18-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Jour 14',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                },

                '19-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã‰tÃ©',

                    time: 'Fin du camp',

                    description: 'Camp d\'Ã©tÃ© - PremiÃ¨re quinzaine des vacances Zone C'

                }

            };



            const dateKey = `${day}-${month}-${year}`;

            const event = events[dateKey];



            if (event) {

                alert(`ğŸ“… ${event.title}\nâ° ${event.time}\nğŸ“ ${event.description}`);

            } else {

                alert(`ğŸ“… ${day}/${month}/${year}\nAucun Ã©vÃ©nement prÃ©vu ce jour.`);

            }

        }



        // Gestion des formulaires de covoiturage

        document.addEventListener('DOMContentLoaded', function() {

            // Charger les notes admin

            loadAdminNotes();

            updateMainPageNotes();
            

            // Ancien code de covoiturage supprimÃ© - maintenant dans carpool-link.html

            (async () => {
                await loadChildrenFromSupabase();
                try { populateChildSelects(); } catch (e) {}
                try { updateChildrenCount(); } catch (e) {}
            })();

        });



        // Liste des enfants scouts - sera surchargÃ©e par Supabase (voir ChildrenService)
        const DEFAULT_SCOUT_CHILDREN = [

            { nom: 'DESCAMPS', prenom: 'JEANNE' },

            { nom: 'LAURENT BILLET', prenom: 'CLAIRE' },

            { nom: 'PICHEREAU', prenom: 'JULES' },

            { nom: 'POTTER', prenom: 'FELIX' },

            { nom: 'ROUSSEAU', prenom: 'LEOPOLD' },

            { nom: 'JEANJEAN', prenom: 'MADELEINE' },

            { nom: 'LALIGAND', prenom: 'LEA' },

            { nom: 'MILLART', prenom: 'CONSTANCE' },

            { nom: 'REYNAL DE SAINT MICHEL', prenom: 'ALEXIA' },

            { nom: 'D\'ANDREA', prenom: 'DANTE' },

            { nom: 'JANDARD', prenom: 'LEV' },

            { nom: 'ROIG', prenom: 'OCTAVE' },

            { nom: 'RUEF', prenom: 'ALFRED' },

            { nom: 'MATHIEN', prenom: 'AMBRE' },

            { nom: 'FAUGERE', prenom: 'LEA' },

            { nom: 'GENTIL', prenom: 'CONSTANCE' },

            { nom: 'HUCHEZ', prenom: 'SIBYLLE' },

            { nom: 'LANASPRE', prenom: 'ROMANE' },

            { nom: 'NIERAT', prenom: 'ZOE' },

            { nom: 'SERVONNAT', prenom: 'LOUISON' },

            { nom: 'WARGNIER', prenom: 'GABRIELLE' },

            { nom: 'POTTER', prenom: 'OSCAR' },

            { nom: 'ROIG', prenom: 'JULES' },

            { nom: 'TALPAERT', prenom: 'GABRIEL' }

        ];

        // Chargement depuis le stockage si importÃ©, sinon valeurs par dÃ©faut
        let scoutChildren = DEFAULT_SCOUT_CHILDREN;

        async function loadChildrenFromSupabase() {
            if (!window.ChildrenService) return;
            try {
                const list = await window.ChildrenService.list();
                if (Array.isArray(list) && list.length > 0) {
                    scoutChildren = list.map(c => ({ nom: c.nom, prenom: c.prenom }));
                }
            } catch (e) {
                console.warn('Impossible de charger les enfants depuis Supabase, utilisation de la liste locale.');
            }
        }

        function populateChildSelects() {
            const selects = document.querySelectorAll("select[name='childName']");
            selects.forEach(sel => {
                const preserveFirst = sel.querySelector('option[value=""]');
                sel.innerHTML = '';
                const first = document.createElement('option');
                first.value = '';
                first.textContent = 'Choisir un enfant...';
                sel.appendChild(first);
                (scoutChildren || []).forEach(child => {
                    const opt = document.createElement('option');
                    const full = `${child.nom} ${child.prenom}`.trim();
                    opt.value = full;
                    opt.textContent = full;
                    sel.appendChild(opt);
                });
            });
        }

        // ============ Import enfants (Admin) ============
        function parseChildrenCSV(text) {
            const lines = text.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
            if (lines.length === 0) return [];
            const delim = lines[0].includes(';') ? ';' : ',';
            const rows = lines.map(l => l.split(delim).map(s => s.trim()))
                              .filter(r => r.length >= 2);
            const isHeader = rows[0] && rows[0].some(c => /nom|prÃ©nom|prenom/i.test(c));
            const start = isHeader ? 1 : 0;
            const out = [];
            for (let i = start; i < rows.length; i++) {
                const [nom = '', prenom = ''] = rows[i];
                if (!nom && !prenom) continue;
                out.push({ nom, prenom });
            }
            return out;
        }

        function loadChildrenFile(ev) {
            const file = ev.target.files && ev.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = () => {
                const ta = document.getElementById('childrenImport');
                if (ta) ta.value = reader.result;
            };
            reader.readAsText(file, 'utf-8');
        }

        function detectAndParseChildren(inputText) {
            const text = (inputText || '').trim();
            if (!text) return [];
            if (text.startsWith('[')) {
                try {
                    const arr = JSON.parse(text);
                    if (Array.isArray(arr)) {
                        return arr
                            .map(x => ({ nom: (x.nom || x.lastName || '').toString(), prenom: (x.prenom || x.firstName || '').toString() }))
                            .filter(x => x.nom || x.prenom);
                    }
                } catch (e) {}
            }
            return parseChildrenCSV(text);
        }

        function previewChildren() {
            const ta = document.getElementById('childrenImport');
            if (!ta) return;
            const arr = detectAndParseChildren(ta.value);
            const preview = document.getElementById('childrenPreview');
            if (!preview) return;
            preview.style.display = 'block';
            if (arr.length === 0) {
                preview.innerHTML = 'âš ï¸ Aucune donnÃ©e dÃ©tectÃ©e.';
                return;
            }
            const list = arr.slice(0, 20).map(c => `${c.nom} ${c.prenom}`).join('<br>');
            preview.innerHTML = `âœ… ${arr.length} enfants dÃ©tectÃ©s.<br><br>${list}${arr.length > 20 ? '<br>â€¦' : ''}`;
        }

        async function saveImportedChildren() {
            const ta = document.getElementById('childrenImport');
            if (!ta) return;
            const arr = detectAndParseChildren(ta.value);
            if (arr.length === 0) {
                alert('âš ï¸ Aucune donnÃ©e valide Ã  importer.');
                return;
            }
            const secret = prompt('Entrez le mot de passe chef pour enregistrer dans Supabase:');
            if (!secret) { alert('Action annulÃ©e.'); return; }
            if (!window.ChildrenService) { alert('Service enfants non chargÃ©.'); return; }
            // Import cÃ´tÃ© Supabase, un par un (RPC sÃ©curisÃ©)
            const created = await window.ChildrenService.importMany(arr, secret, (i, total, err) => {
                const preview = document.getElementById('childrenPreview');
                if (preview) {
                    if (err) preview.innerHTML = `âš ï¸ Erreur Ã  l\'Ã©lÃ©ment ${i}/${total}: ${err.message || err}`;
                    else preview.innerHTML = `â³ Import ${i}/${total}...`;
                }
            });
            // Recharger depuis Supabase
            await loadChildrenFromSupabase();
            try { populateChildSelects(); } catch (e) {}
            updateChildrenCount();
            alert(`âœ… Import terminÃ©: ${created.length} enfants enregistrÃ©s dans Supabase.`);
        }

        function exportChildren() {
            const current = (function() {
                try {
                    const s = localStorage.getItem('scout-children');
                    if (s) return JSON.parse(s);
                } catch (e) {}
                return scoutChildren || [];
            })();
            const blob = new Blob([JSON.stringify(current, null, 2)], { type: 'application/json;charset=utf-8' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `enfants-${new Date().toISOString().slice(0,10)}.json`;
            document.body.appendChild(a);
            a.click();
            a.remove();
        }

        function updateChildrenCount() {
            const compute = () => {
                let count = 0;
                try {
                    const s = localStorage.getItem('scout-children');
                    if (s) { const arr = JSON.parse(s); if (Array.isArray(arr)) count = arr.length; }
                    else if (Array.isArray(scoutChildren)) count = scoutChildren.length;
                } catch (e) {}
                return count;
            };
            const count = compute();
            const text = count ? `ğŸ‘¶ ${count} enfants enregistrÃ©s` : 'Aucun enfant importÃ© (liste par dÃ©faut)';
            const ids = ['childrenCount', 'childrenCountCarpool'];
            ids.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.textContent = text;
            });
        }



        // Fonction pour afficher les sous-onglets de covoiturage

        function showCarpoolTab(tabId) {

            // Masquer toutes les sections

            document.querySelectorAll('.carpool-section').forEach(section => {

                section.style.display = 'none';

            });



            // DÃ©sactiver tous les onglets

            document.querySelectorAll('.carpool-tab').forEach(tab => {

                tab.classList.remove('active');

            });



            // Afficher la section sÃ©lectionnÃ©e

            document.getElementById(tabId).style.display = 'block';



            // Activer l'onglet sÃ©lectionnÃ©

            document.querySelector(`[onclick="showCarpoolTab('${tabId}')"]`).classList.add('active');



            // Charger les donnÃ©es pour cette section

            loadCarpoolListForSection(tabId);

        }
        // Fonction pour charger la liste des covoiturages (ancienne version pour compatibilitÃ©)

        function loadCarpoolList() {

            loadCarpoolListForSection('weekend');

        }
        // Fonction pour crÃ©er une voiture

        function createCar(sectionId) {

            const form = document.getElementById(`carForm-${sectionId}`);

            const formData = new FormData(form);



            const carData = {

                parentName: formData.get('parentName'),

                parentPhone: formData.get('parentPhone'),

                departurePoint: 'Place de la Mairie', // FixÃ© par admin

                arrivalPoint: 'Jambville', // FixÃ© par admin

                childSeats: formData.get('childSeats'),

                adultSeats: formData.get('adultSeats'),

                comments: formData.get('comments'),

                id: Date.now(),

                date: new Date().toISOString(),

                children: [], // Liste des enfants ajoutÃ©s par les parents

                status: 'available' // available, full

            };



            // Sauvegarder la voiture comme disponible

            const existingCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');

            existingCars.push(carData);

            localStorage.setItem(`available-cars-${sectionId}`, JSON.stringify(existingCars));



            // Afficher confirmation

            alert('âœ… Voiture crÃ©Ã©e et disponible !\n\nLes parents peuvent maintenant ajouter leurs enfants.');



            // Recharger les listes

            loadAvailableCars(sectionId);

            loadChildrenWithoutCar(sectionId, 'aller');

            loadChildrenWithoutCar(sectionId, 'retour');



            // RÃ©initialiser le formulaire

            form.reset();

        }



        // Fonction pour afficher la sÃ©lection des enfants

        function showChildrenSelection(sectionId, carData) {

            // Masquer le formulaire de voiture

            document.getElementById(`carForm-${sectionId}`).parentElement.style.display = 'none';



            // Afficher la sÃ©lection des enfants

            const childrenSelection = document.getElementById(`children-selection-${sectionId}`);

            childrenSelection.style.display = 'block';



            // Afficher les informations de la voiture

            const carInfo = document.getElementById(`selected-car-info-${sectionId}`);

            carInfo.innerHTML = `

                <strong>ğŸš— Votre voiture :</strong><br>

                <strong>ğŸ‘¤ ${carData.parentName}</strong> - ğŸ“± ${carData.parentPhone}<br>

                <strong>ğŸ“ ${carData.departurePoint} â†’ ${carData.arrivalPoint}</strong><br>

                <strong>ğŸ‘¶ ${carData.childSeats} enfant${carData.childSeats > 1 ? 's' : ''} / ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ${carData.adultSeats} adulte${carData.adultSeats > 1 ? 's' : ''}</strong><br>

                <strong>ğŸš— ${carData.roundTrip}</strong> - â° ${carData.timePreference || 'Aucune prÃ©fÃ©rence'}

            `;



            // Charger la liste des enfants disponibles

            loadChildrenCheckboxes(sectionId);

        }
        // Fonction pour charger les cases Ã  cocher des enfants

        function loadChildrenCheckboxes(sectionId) {

            const container = document.getElementById(`children-checkboxes-${sectionId}`);

            let html = '';



            (getChildrenForSection(sectionId)).forEach(child => {
                
                const fullName = `${child.nom} ${child.prenom}`;

                html += `

                    <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; border: 1px solid var(--c-ink-900); border-radius: var(--r-sm); background: rgba(255, 255, 255, 0.7);">

                        <input type="checkbox" id="child-${child.nom}-${child.prenom}-${sectionId}" value="${fullName}" style="transform: scale(1.2);">

                        <label for="child-${child.nom}-${child.prenom}-${sectionId}" style="cursor: pointer; font-weight: bold;">${fullName}</label>

                    </div>

                `;

            });



            container.innerHTML = html;

        }
        // Fonction pour confirmer la sÃ©lection des enfants

        function confirmChildrenSelection(sectionId) {

            const checkboxes = document.querySelectorAll(`#children-checkboxes-${sectionId} input[type="checkbox"]:checked`);

            const selectedChildren = Array.from(checkboxes).map(cb => cb.value);



            if (selectedChildren.length === 0) {

                alert('âš ï¸ Veuillez sÃ©lectionner au moins un enfant !');

                return;

            }



            // RÃ©cupÃ©rer les donnÃ©es de la voiture

            const carData = JSON.parse(localStorage.getItem(`car-${sectionId}`) || '{}');



            // CrÃ©er les covoiturages pour chaque enfant sÃ©lectionnÃ©

            selectedChildren.forEach(childName => {

                const carpoolData = {

                    ...carData,

                    childName: childName,

                    id: Date.now() + Math.random()

                };



                // Sauvegarder le covoiturage

                const existingCarpools = JSON.parse(localStorage.getItem(`carpools-${sectionId}`) || '[]');

                existingCarpools.push(carpoolData);

                localStorage.setItem(`carpools-${sectionId}`, JSON.stringify(existingCarpools));

            });



            // Afficher confirmation

            alert(`âœ… Covoiturage crÃ©Ã© pour ${selectedChildren.length} enfant${selectedChildren.length > 1 ? 's' : ''} !\n\nMerci de votre participation Ã©cologique ! ğŸŒ±`);



            // Recharger les listes

            loadCarpoolListForSection(sectionId);

            loadChildrenWithoutCar(sectionId);



            // RÃ©initialiser le formulaire

            document.getElementById(`carForm-${sectionId}`).reset();

            document.getElementById(`children-selection-${sectionId}`).style.display = 'none';

            document.getElementById(`carForm-${sectionId}`).parentElement.style.display = 'block';

        }



        // Fonction pour charger les voitures disponibles

        function loadAvailableCars(sectionId) {

            const allerContainer = document.getElementById(`carpoolList-${sectionId}-aller`);

            const retourContainer = document.getElementById(`carpoolList-${sectionId}-retour`);



            if (!allerContainer || !retourContainer) return;



            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');



            // Afficher les voitures pour l'aller

            let allerHtml = '';

            availableCars.forEach(car => {

                const remainingChildSeats = car.childSeats - car.children.length;

                const remainingAdultSeats = car.adultSeats;

                const status = remainingChildSeats <= 0 ? 'COMPLET' : 'DISPONIBLE';

                const statusColor = remainingChildSeats <= 0 ? '#F44336' : '#4CAF50';



                allerHtml += `

                    <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3;">

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">

                            <strong>ğŸš— ${car.parentName}</strong>

                            <span style="background: ${statusColor}; color: white; padding: 0.25rem 0.5rem; border-radius: var(--r-sm); font-size: 0.8rem; font-weight: bold;">

                                ${status}

                            </span>

                        </div>

                        <div style="font-size: 0.9rem; color: var(--c-forest-700); margin-bottom: 0.5rem;">

                            ğŸ“± ${car.parentPhone}

                        </div>

                        <div style="font-size: 0.9rem; color: var(--c-forest-700); margin-bottom: 0.5rem;">

                            ğŸ‘¶ Places enfants: ${remainingChildSeats}/${car.childSeats} | ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Places adultes: ${remainingAdultSeats}/${car.adultSeats}

                        </div>

                        <div style="font-size: 0.9rem; color: var(--c-forest-700); margin-bottom: 0.5rem;">

                            ğŸ“ ${car.departurePoint} â†’ ${car.arrivalPoint}

                        </div>

                        ${car.comments ? `<div style="font-size: 0.8rem; color: var(--c-ink-700); font-style: italic;">ğŸ’¬ ${car.comments}</div>` : ''}

                        <div style="margin-top:0.5rem; display:flex; gap:0.5rem; align-items:center;">
                            <select id="add-child-select-${sectionId}-${car.id}" style="flex:1; padding:0.5rem; border:2px solid var(--c-ink-900); border-radius: var(--r-sm);">
                                <option value="">Choisir un enfant...</option>
                                ${ (getChildrenForSection(sectionId) || []).filter(ch => !car.children.includes(`${ch.nom} ${ch.prenom}`)).map(ch => {
                                    const fn = `${ch.nom} ${ch.prenom}`;
                                    return `<option value="${fn}">${fn}</option>`;
                                }).join('') }
                            </select>
                            <button class="fey-btn" onclick="addSelectedChildToCar('${sectionId}', '${car.id}')" style="background:#4CAF50; font-size:0.8rem; padding:0.25rem 0.5rem;" ${remainingChildSeats <= 0 ? 'disabled' : ''}>â• Ajouter</button>
                            <button class="fey-btn" onclick="showChildrenSelection('${sectionId}', ${car.id})" style="background:#607D8B; font-size:0.8rem; padding:0.25rem 0.5rem;">ğŸ§© SÃ©lection avancÃ©e</button>
                        </div>

                    </div>

                `;

            });



            allerContainer.innerHTML = allerHtml;

            retourContainer.innerHTML = allerHtml; // MÃªme affichage pour le retour

        }



        // Fonction pour charger la liste des enfants sans voiture

        function loadChildrenWithoutCar(sectionId, direction) {

            const container = document.getElementById(`children-list-${sectionId}-${direction}`);

            if (!container) return;



            // RÃ©cupÃ©rer toutes les voitures disponibles

            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');

            const childrenWithCar = [];



            availableCars.forEach(car => {

                car.children.forEach(child => {

                    childrenWithCar.push(child);

                });

            });



            // Filtrer les enfants sans voiture

            const childrenWithoutCar = (getChildrenForSection(sectionId)).filter(child => {
                
                const fullName = `${child.nom} ${child.prenom}`;
                
                return !childrenWithCar.includes(fullName);
                
            });



            if (childrenWithoutCar.length === 0) {

                container.innerHTML = `

                    <div style="text-align: center; color: #4CAF50; font-weight: bold; padding: 1rem;">

                        ğŸ‰ Tous les enfants ont un covoiturage !

                    </div>

                `;

                return;

            }



            let html = '';

            childrenWithoutCar.forEach(child => {

                const fullName = `${child.nom} ${child.prenom}`;

                html += `

                    <div style="background: linear-gradient(135deg, #FFE0E0, #FFB3B3); border: 2px solid #F44336; border-radius: var(--r-sm); padding: 0.5rem; text-align: center; font-weight: bold; color: #D32F2F;">

                        ğŸ‘¶ ${fullName}

                    </div>

                `;

            });



            container.innerHTML = html;

        }



        // Fonction pour afficher les onglets du dashboard

        function showDashboardTab(sectionId, direction) {

            // Masquer toutes les sections

            document.querySelectorAll(`#children-without-car-${sectionId}-aller, #children-without-car-${sectionId}-retour`).forEach(section => {

                section.style.display = 'none';

            });



            // Afficher la section sÃ©lectionnÃ©e

            document.getElementById(`children-without-car-${sectionId}-${direction}`).style.display = 'block';



            // Mettre Ã  jour les onglets actifs

            document.querySelectorAll(`.dashboard-tab`).forEach(tab => {

                tab.classList.remove('active');

            });

            event.target.classList.add('active');

        }



        // Fonction pour ajouter un enfant Ã  une voiture

        function addChildToCar(sectionId, carId, direction) {

            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');

            const car = availableCars.find(c => c.id == carId);



            if (!car) return;



            if (car.children.length >= car.childSeats) {

                alert('âš ï¸ Cette voiture est complÃ¨te !');

                return;

            }



            // CrÃ©er une liste des enfants disponibles

            const availableChildren = (getChildrenForSection(sectionId)).filter(child => {
                
                const fullName = `${child.nom} ${child.prenom}`;
                
                return !car.children.includes(fullName);
                
            });



            if (availableChildren.length === 0) {

                alert('âš ï¸ Aucun enfant disponible !');

                return;

            }



            // CrÃ©er une modal pour la sÃ©lection

            showChildSelectionModal(sectionId, carId, direction, availableChildren, car);

        }
        // Fonction pour basculer la case Ã  cocher

        function toggleChildCheckbox(childName) {

            const checkbox = document.getElementById(`child-${childName.replace(/\s+/g, '-')}`);

            checkbox.checked = !checkbox.checked;

        }



        // Fonction pour confirmer la sÃ©lection

        function confirmChildSelection(sectionId, carId, direction) {

            const checkboxes = document.querySelectorAll('#childSelectionModal input[type="checkbox"]:checked');

            const selectedChildren = Array.from(checkboxes).map(cb => cb.value);



            if (selectedChildren.length === 0) {

                alert('âš ï¸ Veuillez sÃ©lectionner au moins un enfant !');

                return;

            }



            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');

            const car = availableCars.find(c => c.id == carId);



            if (car.children.length + selectedChildren.length > car.childSeats) {

                alert('âš ï¸ Trop d\'enfants sÃ©lectionnÃ©s ! VÃ©rifiez les places disponibles.');

                return;

            }



            // Ajouter les enfants sÃ©lectionnÃ©s

            selectedChildren.forEach(childName => {

                car.children.push(childName);

            });



            localStorage.setItem(`available-cars-${sectionId}`, JSON.stringify(availableCars));



            alert(`âœ… ${selectedChildren.length} enfant${selectedChildren.length > 1 ? 's' : ''} ajoutÃ©${selectedChildren.length > 1 ? 's' : ''} Ã  la voiture de ${car.parentName} !`);



            // Fermer la modal

            closeChildSelectionModal();



            // Recharger les listes

            loadAvailableCars(sectionId);

            loadChildrenWithoutCar(sectionId, 'aller');

            loadChildrenWithoutCar(sectionId, 'retour');

        }



        // Fonction pour fermer la modal

        function closeChildSelectionModal() {

            const modal = document.getElementById('childSelectionModal');

            if (modal) {

                modal.remove();

            }

        }



        // Fonctions pour la gestion des sorties en mode admin

        function showCreateTripModal() {

            document.getElementById('createTripModal').style.display = 'block';

        }



        function hideCreateTripModal() {

            document.getElementById('createTripModal').style.display = 'none';

        }



        // Gestion du formulaire de crÃ©ation de sortie

        document.addEventListener('DOMContentLoaded', function() {

            const createTripForm = document.getElementById('createTripForm');

            if (createTripForm) {

                createTripForm.addEventListener('submit', function(e) {

                    e.preventDefault();



                    const formData = new FormData(createTripForm);

                    const tripData = {

                        name: formData.get('tripName'),

                        startDate: formData.get('startDate'),

                        endDate: formData.get('endDate'),

                        departurePoint: formData.get('departurePoint'),

                        arrivalPoint: formData.get('arrivalPoint'),

                        departureTime: formData.get('departureTime'),

                        returnTime: formData.get('returnTime'),

                        description: formData.get('description'),

                        id: Date.now()

                    };



                    // Sauvegarder la sortie

                    const existingTrips = JSON.parse(localStorage.getItem('admin-trips') || '[]');

                    existingTrips.push(tripData);

                    localStorage.setItem('admin-trips', JSON.stringify(existingTrips));



                    alert('âœ… Sortie crÃ©Ã©e avec succÃ¨s !');

                    hideCreateTripModal();

                    createTripForm.reset();

                });

            }



            // GÃ©rer les formulaires de voiture

            const carForms = document.querySelectorAll('[id^="carForm-"]');

            carForms.forEach(form => {

                form.addEventListener('submit', function(e) {

                    e.preventDefault();

                    const sectionId = form.id.replace('carForm-', '');

                    createCar(sectionId);

                });

            });



            // Charger les enfants sans voiture pour toutes les sections

            loadChildrenWithoutCar('weekend-groupe');

        });



        // Fonction pour activer le mode admin - sera redÃ©finie plus tard



        // VÃ©rifier si l'utilisateur est admin (mot de passe spÃ©cial)

        function checkAdminAccess() {

            const password = document.getElementById('passwordInput').value;

            if (password === 'Scout2025!') {

                if (typeof enableAdminMode === 'function') {

                    enableAdminMode();

                }

                return true;

            }

            return false;

        }



        // Fonctions pour gÃ©rer les notes admin

        function saveAdminNotes() {

            const notes = document.getElementById('adminNotes').value;

            if (notes.trim()) {

                localStorage.setItem('adminNotes', notes);

                showNotification('Notes sauvegardÃ©es avec succÃ¨s !', 'success');

                updateMainPageNotes();

            } else {

                showNotification('Veuillez saisir des notes avant de sauvegarder.', 'warning');

            }

        }



        function clearAdminNotes() {

            if (confirm('ÃŠtes-vous sÃ»r de vouloir effacer toutes les notes ?')) {

                document.getElementById('adminNotes').value = '';

                localStorage.removeItem('adminNotes');

                showNotification('Notes effacÃ©es !', 'info');

                updateMainPageNotes();

            }

        }



        function previewAdminNotes() {

            const notes = document.getElementById('adminNotes').value;

            const preview = document.getElementById('adminNotesPreview');

            const content = document.getElementById('previewContent');

            

            if (notes.trim()) {

                content.innerHTML = notes.replace(/\n/g, '<br>');

                preview.style.display = 'block';

            } else {

                preview.style.display = 'none';

            }

        }



        function loadAdminNotes() {

            const notes = localStorage.getItem('adminNotes');

            if (notes) {

                document.getElementById('adminNotes').value = notes;

            }

        }



        function updateMainPageNotes() {

            const notes = localStorage.getItem('adminNotes');

            const notesContainer = document.getElementById('adminNotesDisplay');

            

            if (notes && notes.trim()) {

                if (!notesContainer) {

                    // CrÃ©er le conteneur de notes s'il n'existe pas

                    const messageCard = document.querySelector('.fey-card:has(.fey-card-header:contains("Message pour les Parents"))');

                    if (messageCard) {

                        const notesContainer = document.createElement('div');

                        notesContainer.id = 'adminNotesDisplay';

                        notesContainer.className = 'fey-card';

                        notesContainer.style.cssText = 'background: linear-gradient(135deg, #FFF8E1, #FFECB3); border-left: 6px solid #FFC107; margin-bottom: 2rem;';

                        notesContainer.innerHTML = `

                            <div class="fey-card-header">ğŸ“ Message de l'Administrateur</div>

                            <div class="fey-note" style="background: transparent; border: none; margin: 0;">

                                <div id="adminNotesContent"></div>

                            </div>

                        `;

                        messageCard.parentNode.insertBefore(notesContainer, messageCard.nextSibling);

                    }

                }

                

                const content = document.getElementById('adminNotesContent');

                if (content) {

                    content.innerHTML = notes.replace(/\n/g, '<br>');

                }

            } else if (notesContainer) {

                notesContainer.remove();

            }

        }
        function showNotification(message, type = 'info') {

            // CrÃ©er une notification temporaire

            const notification = document.createElement('div');

            notification.style.cssText = `

                position: fixed;

                top: 20px;

                right: 20px;

                padding: 1rem 2rem;

                border-radius: var(--r-sm);

                color: white;

                font-weight: bold;

                z-index: 10000;

                animation: slideIn 0.3s ease-out;

                max-width: 300px;

            `;

            

            const colors = {

                success: '#4CAF50',

                warning: '#FF9800',

                error: '#f44336',

                info: '#2196F3'

            };

            

            notification.style.backgroundColor = colors[type] || colors.info;

            notification.textContent = message;

            

            document.body.appendChild(notification);

            

            setTimeout(() => {

                notification.style.animation = 'slideOut 0.3s ease-in';

                setTimeout(() => notification.remove(), 300);

            }, 3000);

        }
        function updateGameScore() {

            document.getElementById('game-score').textContent = bagItems.length;

            document.getElementById('max-score').textContent = maxScore;

        }
        function checkScoutBagGame() {

            // VÃ©rifier l'ordre

            let correctOrder = true;

            for (let i = 0; i < bagItems.length; i++) {

                if (bagItems[i].order !== i + 1) {

                    correctOrder = false;

                    break;

                }

            }

            

            if (correctOrder && bagItems.length === maxScore) {

                alert('ğŸ‰ Bravo ! Tu as parfaitement rangÃ© ton sac ! Tu es prÃªt pour l\'aventure ! ğŸ•ï¸');

            } else if (bagItems.length === maxScore) {

                alert('âŒ Presque ! L\'ordre n\'est pas tout Ã  fait correct. Essaie de nouveau !');

            } else {

                alert('âŒ Il manque encore des objets dans ton sac !');

            }

        }

        

        function resetScoutBagGame() {

            // Vider le sac

            bagItems = [];

            document.getElementById('scout-bag').innerHTML = '<p style="text-align: center; color: var(--orange); font-style: italic;">Glisse les objets ici dans le bon ordre !</p>';

            

            // RÃ©initialiser le jeu

            initScoutBagGame();

        }

        

        // Fonctions de gestion des sorties

        function showCreateOutingModal() {

            const modal = document.createElement('div');

            modal.id = 'createOutingModal';

            modal.style.cssText = `

                position: fixed;

                top: 0;

                left: 0;

                width: 100%;

                height: 100%;

                background: rgba(0, 0, 0, 0.5);

                z-index: 1000;

                display: flex;

                justify-content: center;

                align-items: center;

            `;



            modal.innerHTML = `

                <div style="

                    background: white;

                    border-radius: var(--r-md);

                    padding: 2rem;

                    max-width: 600px;

                    width: 90%;

                    max-height: 80vh;

                    overflow-y: auto;

                    border: 3px solid var(--c-ink-900);

                ">

                    <div class="fey-card-header">â• CrÃ©er une Nouvelle Sortie</div>

                    <form id="createOutingForm" style="display: flex; flex-direction: column; gap: 1rem;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ•ï¸ Nom de la Sortie</label>

                                <input type="text" name="outingName" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Date</label>

                                <input type="date" name="outingDate" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>



                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Lieu</label>

                                <input type="text" name="outingLocation" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure DÃ©part</label>

                                <input type="time" name="departureTime" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure Retour</label>

                            <input type="time" name="returnTime" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Description</label>

                            <textarea name="description" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 80px; resize: vertical;"></textarea>

                        </div>



                        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">

                            <button type="submit" class="fey-btn" style="background: #4CAF50; padding: 0.75rem 1.5rem;">

                                âœ… CrÃ©er la Sortie

                            </button>

                            <button type="button" onclick="closeCreateOutingModal()" class="fey-btn" style="background: #F44336; padding: 0.75rem 1.5rem;">

                                âŒ Annuler

                            </button>

                        </div>

                    </form>

                </div>

            `;



            document.body.appendChild(modal);



            // GÃ©rer la soumission du formulaire

            document.getElementById('createOutingForm').addEventListener('submit', function(e) {

                e.preventDefault();

                

                const formData = new FormData(this);

                const outingData = {

                    name: formData.get('outingName'),

                    date: formData.get('outingDate'),

                    location: formData.get('outingLocation'),

                    departureTime: formData.get('departureTime'),

                    returnTime: formData.get('returnTime'),

                    description: formData.get('description'),

                    id: Date.now()

                };



                // Sauvegarder la sortie

                const existingOutings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

                existingOutings.push(outingData);

                localStorage.setItem('admin-outings', JSON.stringify(existingOutings));



                alert('âœ… Sortie crÃ©Ã©e avec succÃ¨s !');

                closeCreateOutingModal();

                loadOutings(); // Recharger la liste

            });

        }

        

        function closeCreateOutingModal() {

            const modal = document.getElementById('createOutingModal');

            if (modal) {

                modal.remove();

            }

        }

        

        function loadOutings() {

            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            const container = document.getElementById('outings-list');

            

            if (outings.length === 0) {

                container.innerHTML = '<p style="text-align: center; color: #666;">Aucune sortie programmÃ©e</p>';

                return;

            }

            

            let html = '<h3 style="color: var(--c-forest-700); margin-bottom: 1rem; font-size: 1.2rem;">ğŸ“… Sorties ProgrammÃ©es</h3>';

            

            outings.forEach(outing => {

                html += `

                    <div class="fey-item" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50; margin-bottom: 1rem;">

                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; align-items: center;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ•ï¸ Nom de la Sortie</label>

                                <input type="text" value="${outing.name}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Date</label>

                                <input type="date" value="${outing.date}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Lieu</label>

                                <input type="text" value="${outing.location}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure DÃ©part</label>

                                <input type="time" value="${outing.departureTime}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure Retour</label>

                                <input type="time" value="${outing.returnTime}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                            </div>

                        </div>

                        <div style="margin-top: 1rem;">

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Description</label>

                            <textarea style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 60px; resize: vertical;">${outing.description}</textarea>

                        </div>

                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">

                            <button class="fey-btn" onclick="saveOuting(${outing.id})" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;">ğŸ’¾ Sauvegarder</button>

                            <button class="fey-btn" onclick="deleteOuting(${outing.id})" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;">ğŸ—‘ï¸ Supprimer</button>

                        </div>

                    </div>

                `;

            });

            

            container.innerHTML = html;

        }

        

        function saveOuting(outingId) {

            // Logique pour sauvegarder les modifications

            alert('âœ… Sortie sauvegardÃ©e !');

        }

        

        function deleteOuting(outingId) {

            if (confirm('ÃŠtes-vous sÃ»r de vouloir supprimer cette sortie ?')) {

                const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

                const updatedOutings = outings.filter(outing => outing.id !== outingId);

                localStorage.setItem('admin-outings', JSON.stringify(updatedOutings));

                loadOutings();

                alert('âœ… Sortie supprimÃ©e !');

            }

            

            console.log('ğŸ“… Ã‰vÃ©nements rÃ©cupÃ©rÃ©s:', Object.keys(events).length);

            console.log('ğŸ“… DÃ©tails des Ã©vÃ©nements:', events);

            

            return events;

        }
        // Fonction pour obtenir les Ã©vÃ©nements par dÃ©faut du programme 2025-2026

        function getDefaultCalendarEvents() {

            return {

                // Septembre 2025

                '28-9-2025': {

                    title: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ RÃ©union parents',

                    time: 'Dimanche',

                    description: 'RÃ©union d\'information pour les parents'

                },



                // Octobre 2025

                '3-10-2025': {

                    title: 'ğŸ•ï¸ Weekend de Groupe',

                    time: 'Vendredi - DÃ©part',

                    description: 'Weekend de groupe avec activitÃ©s scoutes'

                },

                '4-10-2025': {

                    title: 'ğŸ•ï¸ Weekend de Groupe',

                    time: 'Samedi - Retour',

                    description: 'Weekend de groupe avec activitÃ©s scoutes'

                },

                '12-10-2025': {

                    title: 'â›µ Sortie voile',

                    time: 'Dimanche',

                    description: 'Sortie voile Ã  Verneuil sur Seine'

                },



                // Novembre 2025

                '15-11-2025': {

                    title: 'â›ª Weekend Abbaye d\'Epernon',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend au PrieurÃ© Saint Thomas'

                },

                '16-11-2025': {

                    title: 'â›ª Weekend Abbaye d\'Epernon',

                    time: 'Dimanche - Retour',

                    description: 'Weekend au PrieurÃ© Saint Thomas'

                },



                // DÃ©cembre 2025

                '14-12-2025': {

                    title: 'ğŸ•¯ï¸ LumiÃ¨re de BethlÃ©em',

                    time: 'Dimanche',

                    description: 'LumiÃ¨re de BethlÃ©em + CrÃ¨che vivante'

                },



                // Janvier 2026

                '18-1-2026': {

                    title: 'âš“ Sortie MusÃ©e de la Marine',

                    time: 'Dimanche',

                    description: 'Sortie MusÃ©e de la Marine + galettes'

                },



                // Mars 2026

                '14-3-2026': {

                    title: 'ğŸŒ¸ Weekend de mars',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de printemps avec activitÃ©s nature'

                },

                '15-3-2026': {

                    title: 'ğŸŒ¸ Weekend de mars',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de printemps avec activitÃ©s nature'

                },



                // Avril 2026

                '12-4-2026': {

                    title: 'ğŸ° Sortie chÃ¢teau',

                    time: 'Dimanche',

                    description: 'Visite d\'un chÃ¢teau historique'

                },



                // Mai 2026

                '15-5-2026': {

                    title: 'ğŸ° Mini-camp Mont Saint-Michel',

                    time: 'Vendredi - DÃ©part',

                    description: 'Mini-camp au Mont Saint-Michel'

                },

                '16-5-2026': {

                    title: 'ğŸ° Mini-camp Mont Saint-Michel',

                    time: 'Samedi',

                    description: 'Mini-camp au Mont Saint-Michel'

                },

                '17-5-2026': {

                    title: 'ğŸ° Mini-camp Mont Saint-Michel',

                    time: 'Dimanche - Retour',

                    description: 'Mini-camp au Mont Saint-Michel'

                },



                // Juin 2026

                '12-6-2026': {

                    title: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ RÃ©union prÃ©sentation camp',

                    time: 'Vendredi 18h-20h',

                    description: 'RÃ©union de prÃ©sentation du camp d\'Ã©tÃ©'

                },

                '13-6-2026': {

                    title: 'ğŸŒ¸ Weekend de juin',

                    time: 'Samedi - DÃ©part',

                    description: 'Weekend de fin d\'annÃ©e'

                },

                '14-6-2026': {

                    title: 'ğŸŒ¸ Weekend de juin',

                    time: 'Dimanche - Retour',

                    description: 'Weekend de fin d\'annÃ©e'

                },



                // Juillet 2026

                '5-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã©tÃ©',

                    time: 'DÃ©part',

                    description: 'Camp d\'Ã©tÃ© (premiÃ¨re quinzaine des vacances Zone C)'

                },

                '19-7-2026': {

                    title: 'ğŸ•ï¸ Camp d\'Ã©tÃ©',

                    time: 'Retour',

                    description: 'Fin du camp d\'Ã©tÃ© (dates exactes Ã  confirmer)'

                }

            };

        }

        

        // Charger les sorties au dÃ©marrage

        document.addEventListener('DOMContentLoaded', function() {

            if (document.getElementById('outings-list')) {

                loadOutings();

            }

            // Charger les sorties pour le registre d'appel

            loadOutingsForAttendance();

        });



        // ===============================

        // FONCTIONS REGISTRE D'APPEL

        // ===============================
        // Charger les sorties dans le sÃ©lecteur du registre d'appel

        function loadOutingsForAttendance() {

            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            const select = document.getElementById('selectedOuting');

            

            if (!select) return;

            

            // Vider le sÃ©lecteur

            select.innerHTML = '<option value="">-- SÃ©lectionnez une sortie --</option>';

            

            // Ajouter chaque sortie

            outings.forEach(outing => {

                const option = document.createElement('option');

                option.value = outing.id;

                option.textContent = `${outing.name} - ${new Date(outing.startDate).toLocaleDateString('fr-FR')}`;

                select.appendChild(option);

            });

        }



        // Charger le registre d'appel pour une sortie sÃ©lectionnÃ©e

        function loadAttendanceForOuting(tripId) {

            if (!tripId) {

                document.getElementById('outingInfo').style.display = 'none';

                document.getElementById('participantsList').style.display = 'none';

                return;

            }



            // RÃ©cupÃ©rer les dÃ©tails de la sortie depuis le calendrier

            const events = getCalendarEvents();

            const dateKey = tripId.replace(/_/g, '-');

            const event = events[dateKey];

            

            if (!event) {

                console.error('Sortie non trouvÃ©e:', tripId);

                return;

            }



            // Afficher les informations de la sortie
displayOutingInfo(event, dateKey);

            

            // CrÃ©er la liste d'appel

            createAttendanceList(tripId, event);

            document.getElementById('outingInfo').style.display = 'block';

            document.getElementById('participantsList').style.display = 'block';

        }



        // Afficher les informations de la sortie

        function displayOutingInfo(event, dateKey) {

            const detailsContainer = document.getElementById('outingDetails');

            if (detailsContainer) {

            detailsContainer.innerHTML = `

                <div style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <strong>ğŸ•ï¸ ${event.title}</strong><br>

                        <small>${dateKey}</small>

                </div>

                <div style="background: linear-gradient(135deg, #F3E5F5, #E1BEE7); padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                        <strong>â° Heure</strong><br>

                        <small>${event.time || 'Non spÃ©cifiÃ©e'}</small>

                </div>

                <div style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                    <strong>ğŸ“ Description</strong><br>

                        <small>${event.description || 'Aucune description'}</small>

                </div>

            `;

            }

        }

        

        // CrÃ©er la liste d'appel avec les enfants

        function createAttendanceList(tripId, event) {

            const participantsList = document.getElementById('participantsList');

            if (!participantsList) return;

            

            // Liste des enfants scouts (copie directe pour Ã©viter les problÃ¨mes de portÃ©e)

            const children = [

                'DESCAMPS JEANNE',

                'LAURENT BILLET CLAIRE', 

                'PICHEREAU JULES',

                'POTTER FELIX',

                'ROUSSEAU LEOPOLD',

                'JEANJEAN MADELEINE',

                'LALIGAND LEA',

                'MILLART CONSTANCE',

                'REYNAL DE SAINT MICHEL ALEXIA',

                'D\'ANDREA DANTE',

                'JANDARD LEV',

                'ROIG OCTAVE',

                'RUEF ALFRED',

                'MATHIEN AMBRE',

                'FAUGERE LEA',

                'GENTIL CONSTANCE',

                'HUCHEZ SIBYLLE',

                'LANASPRE ROMANE',

                'NIERAT ZOE',

                'SERVONNAT LOUISON',

                'WARGNIER GABRIELLE',

                'POTTER OSCAR',

                'ROIG JULES',

                'TALPAERT GABRIEL'

            ];

            

            console.log('ğŸ‘¥ Enfants chargÃ©s:', children);

            

            // RÃ©cupÃ©rer les prÃ©sences sauvegardÃ©es

            const savedAttendance = JSON.parse(localStorage.getItem(`attendance_${tripId}`) || '{}');

            

            let attendanceHTML = `

                <div class="fey-card">

                    <div class="fey-card-header">ğŸ“‹ Liste d'Appel - ${event.title}</div>

                    <div style="margin-bottom: 1rem;">

                        <p><strong>ğŸ“… Date :</strong> ${tripId.replace(/_/g, '-')}</p>

                        <p><strong>ğŸ‘¥ Nombre d'enfants :</strong> ${children.length}</p>

                    </div>

                    <div style="max-height: 400px; overflow-y: auto; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); padding: 1rem;">

            `;

            

            children.forEach((child, index) => {

                const isPresent = savedAttendance[child] || false;

                attendanceHTML += `

                    <div style="display: flex; align-items: center; padding: 0.75rem; border-bottom: 1px solid #eee; background: ${isPresent ? '#e8f5e8' : '#fff'};">

                        <input type="checkbox" 

                               id="attendance_${tripId}_${index}" 

                               ${isPresent ? 'checked' : ''} 

                               onchange="updateAttendance('${tripId}', '${child}', this.checked)"

                               style="margin-right: 1rem; transform: scale(1.3);">

                        <label for="attendance_${tripId}_${index}" style="flex: 1; cursor: pointer; font-size: 1.1rem;">

                            <strong>${child}</strong>

                            <span id="status_${tripId}_${index}" style="color: ${isPresent ? '#2e7d32' : '#666'}; margin-left: 0.5rem;">

                                ${isPresent ? 'âœ… PrÃ©sent' : 'âŒ Absent'}

                            </span>

                        </label>

                    </div>

                `;

            });

            

            attendanceHTML += `

                    </div>

                    <div style="margin-top: 1rem; text-align: center;">

                        <button onclick="saveAttendance('${tripId}')" class="fey-btn" style="background: #4CAF50; padding: 0.75rem 1.5rem; margin-right: 1rem;">

                            ğŸ’¾ Sauvegarder l'Appel

                        </button>

                        <button onclick="exportAttendance('${tripId}')" class="fey-btn" style="background: #2196F3; padding: 0.75rem 1.5rem;">

                            ğŸ“Š Exporter

                        </button>

                    </div>

                </div>

            `;

            

            participantsList.innerHTML = attendanceHTML;

        }

        

        // Mettre Ã  jour la prÃ©sence d'un enfant

        function updateAttendance(tripId, childName, isPresent) {

            const savedAttendance = JSON.parse(localStorage.getItem(`attendance_${tripId}`) || '{}');

            savedAttendance[childName] = isPresent;

            localStorage.setItem(`attendance_${tripId}`, JSON.stringify(savedAttendance));

            

            // Mettre Ã  jour l'affichage en trouvant l'Ã©lÃ©ment par l'index

            const children = [

                'DESCAMPS JEANNE',

                'LAURENT BILLET CLAIRE', 

                'PICHEREAU JULES',

                'POTTER FELIX',

                'ROUSSEAU LEOPOLD',

                'JEANJEAN MADELEINE',

                'LALIGAND LEA',

                'MILLART CONSTANCE',

                'REYNAL DE SAINT MICHEL ALEXIA',

                'D\'ANDREA DANTE',

                'JANDARD LEV',

                'ROIG OCTAVE',

                'RUEF ALFRED',

                'MATHIEN AMBRE',

                'FAUGERE LEA',

                'GENTIL CONSTANCE',

                'HUCHEZ SIBYLLE',

                'LANASPRE ROMANE',

                'NIERAT ZOE',

                'SERVONNAT LOUISON',

                'WARGNIER GABRIELLE',

                'POTTER OSCAR',

                'ROIG JULES',

                'TALPAERT GABRIEL'

            ];

            const childIndex = children.indexOf(childName);

            

            if (childIndex !== -1) {

                const statusSpan = document.getElementById(`status_${tripId}_${childIndex}`);

                if (statusSpan) {

                    statusSpan.textContent = isPresent ? 'âœ… PrÃ©sent' : 'âŒ Absent';

                    statusSpan.style.color = isPresent ? '#2e7d32' : '#666';

                }

                

                // Changer la couleur de fond

                const container = document.getElementById(`attendance_${tripId}_${childIndex}`).closest('div');

                if (container) {

                    container.style.background = isPresent ? '#e8f5e8' : '#fff';

                }

            }

        }

        

        // Sauvegarder l'appel

        function saveAttendance(tripId) {

            const savedAttendance = JSON.parse(localStorage.getItem(`attendance_${tripId}`) || '{}');

            const presentCount = Object.values(savedAttendance).filter(present => present).length;

            const totalCount = Object.keys(savedAttendance).length;

            

            // Sauvegarder dans l'historique

            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const event = getCalendarEvents()[tripId.replace(/_/g, '-')];

            

            const record = {

                id: tripId,

                title: event.title,

                date: tripId.replace(/_/g, '-'),

                attendance: savedAttendance,

                presentCount: presentCount,

                totalCount: totalCount,

                timestamp: new Date().toISOString()

            };

            

            // Supprimer l'ancien enregistrement s'il existe

            const existingIndex = history.findIndex(h => h.id === tripId);

            if (existingIndex !== -1) {

                history[existingIndex] = record;

            } else {

                history.push(record);

            }

            

            localStorage.setItem('attendance-history', JSON.stringify(history));

            

            // Recharger l'historique pour l'afficher

            loadAttendanceHistory();

            

            alert(`âœ… Appel sauvegardÃ© !\nğŸ‘¥ PrÃ©sents: ${presentCount}/${totalCount}`);

        }

        

        // Exporter l'appel

        function exportAttendance(tripId) {

            const savedAttendance = JSON.parse(localStorage.getItem(`attendance_${tripId}`) || '{}');

            const event = getCalendarEvents()[tripId.replace(/_/g, '-')];

            

            let csvContent = `Appel - ${event.title} (${tripId.replace(/_/g, '-')})\n`;

            csvContent += `Nom,PrÃ©sent\n`;

            

            Object.entries(savedAttendance).forEach(([child, isPresent]) => {

                csvContent += `${child},${isPresent ? 'Oui' : 'Non'}\n`;

            });

            

            // CrÃ©er et tÃ©lÃ©charger le fichier

            const blob = new Blob([csvContent], { type: 'text/csv' });

            const url = window.URL.createObjectURL(blob);

            const a = document.createElement('a');

            a.href = url;

            a.download = `appel_${tripId.replace(/_/g, '-')}.csv`;

            a.click();

            window.URL.revokeObjectURL(url);

        }

        

        // Nettoyer l'historique des entrÃ©es invalides

        function cleanAttendanceHistory() {

            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const events = getCalendarEvents();

            

            // Filtrer les entrÃ©es valides

            const validHistory = history.filter(record => {

                const event = events[record.date];

                return event && event.title !== undefined;

            });

            

            // Mettre Ã  jour les titres des entrÃ©es existantes

            validHistory.forEach(record => {

                const event = events[record.date];

                if (event) {

                    record.title = event.title;

                }

            });

            

            localStorage.setItem('attendance-history', JSON.stringify(validHistory));

            loadAttendanceHistory();

            

            alert(`ğŸ§¹ Historique nettoyÃ© ! ${history.length - validHistory.length} entrÃ©es invalides supprimÃ©es.`);

        }

        

        // Supprimer tout l'historique

        function clearAllAttendanceHistory() {

            if (confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir supprimer TOUT l\'historique des appels ? Cette action est irrÃ©versible.')) {

                localStorage.removeItem('attendance-history');

                loadAttendanceHistory();

                alert('ğŸ—‘ï¸ Historique complÃ¨tement supprimÃ© !');

            }

        }



        // Charger la liste des participants pour le registre d'appel

        function loadParticipantsForAttendance(outing) {

            // RÃ©cupÃ©rer les Ã©quipes

            const lifeTeams = JSON.parse(localStorage.getItem('life-teams') || '[]');

            const nightTeams = JSON.parse(localStorage.getItem('night-teams') || '[]');



            // RÃ©cupÃ©rer le registre d'appel existant pour cette sortie

            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            const currentAttendance = attendanceRecords[outing.id] || {};



            let participants = [];

            

            // Ajouter les membres des Ã©quipes de vie

            lifeTeams.forEach(team => {

                team.members.forEach(member => {

                    participants.push({

                        id: `life_${team.name}_${member}`,

                        name: member,

                        team: team.name,

                        teamType: 'life',

                        attendance: currentAttendance[`life_${team.name}_${member}`] || 'unknown'

                    });

                });

            });



            // Ajouter les membres des Ã©quipes de nuit

            nightTeams.forEach(team => {

                team.members.forEach(member => {

                    participants.push({

                        id: `night_${team.name}_${member}`,

                        name: member,

                        team: team.name,

                        teamType: 'night',

                        attendance: currentAttendance[`night_${team.name}_${member}`] || 'unknown'

                    });

                });

            });



            // GÃ©nÃ©rer le tableau des participants

            generateParticipantsTable(participants);

            updateAttendanceStats(participants);

        }
        // GÃ©nÃ©rer le tableau des participants

        function generateParticipantsTable(participants) {

            const tableContainer = document.getElementById('participantsTable');

            

            if (participants.length === 0) {

                tableContainer.innerHTML = `

                    <div class="fey-note" style="text-align: center; padding: 2rem;">

                        <strong>ğŸ‘¥ Aucun participant trouvÃ©</strong><br>

                        <small>Assurez-vous que les Ã©quipes sont configurÃ©es dans le panneau admin.</small>

                    </div>

                `;

                return;

            }



            let html = `

                <div style="overflow-x: auto;">

                    <table style="width: 100%; border-collapse: collapse; border: 2px solid var(--c-ink-900);">

                        <thead>

                            <tr style="background: linear-gradient(135deg, #FF5722, #FF7043); color: white;">

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: left;">ğŸ‘¤ Participant</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: left;">ğŸ‘¥ Ã‰quipe</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: center;">âœ… PrÃ©sent</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: center;">âŒ Absent</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: center;">ğŸ“ JustifiÃ©</th>

                                <th style="padding: 1rem; border: 1px solid var(--c-ink-900); text-align: left;">ğŸ’¬ Commentaire</th>

                            </tr>

                        </thead>

                        <tbody>

            `;



            participants.forEach(participant => {

                const presentChecked = participant.attendance === 'present' ? 'checked' : '';

                const absentChecked = participant.attendance === 'absent' ? 'checked' : '';

                const justifiedChecked = participant.attendance === 'justified' ? 'checked' : '';

                

                html += `

                    <tr style="border-bottom: 1px solid var(--c-ink-900);">

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900);">

                            <strong>${participant.name}</strong><br>

                            <small style="color: #666;">${participant.teamType === 'life' ? 'ğŸ•ï¸ Vie' : 'ğŸŒ™ Nuit'}</small>

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900);">

                            ${participant.team}

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900); text-align: center;">

                            <input type="radio" name="attendance_${participant.id}" value="present" ${presentChecked} 

                                   onchange="updateParticipantAttendance('${participant.id}', 'present')" 

                                   style="transform: scale(1.2);">

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900); text-align: center;">

                            <input type="radio" name="attendance_${participant.id}" value="absent" ${absentChecked}

                                   onchange="updateParticipantAttendance('${participant.id}', 'absent')"

                                   style="transform: scale(1.2);">

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900); text-align: center;">

                            <input type="radio" name="attendance_${participant.id}" value="justified" ${justifiedChecked}

                                   onchange="updateParticipantAttendance('${participant.id}', 'justified')"

                                   style="transform: scale(1.2);">

                        </td>

                        <td style="padding: 0.75rem; border: 1px solid var(--c-ink-900);">

                            <input type="text" id="comment_${participant.id}" placeholder="Commentaire..." 

                                   value="${participant.comment || ''}" 

                                   onchange="updateParticipantComment('${participant.id}', this.value)"

                                   style="width: 100%; padding: 0.25rem; border: 1px solid #ccc; border-radius: 4px;">

                        </td>

                    </tr>

                `;

            });



            html += `

                        </tbody>

                    </table>

                </div>

            `;



            tableContainer.innerHTML = html;

        }



        // Mettre Ã  jour l'attendance d'un participant

        function updateParticipantAttendance(participantId, status) {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            if (!attendanceRecords[outingId]) {

                attendanceRecords[outingId] = {};

            }

            

            attendanceRecords[outingId][participantId] = status;

            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));

            

            // Mettre Ã  jour les statistiques

            updateAttendanceStatsFromCurrent();

        }
        // Mettre Ã  jour le commentaire d'un participant

        function updateParticipantComment(participantId, comment) {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            if (!attendanceRecords[outingId]) {

                attendanceRecords[outingId] = {};

            }

            

            if (!attendanceRecords[outingId][participantId]) {

                attendanceRecords[outingId][participantId] = 'unknown';

            }

            

            // Stocker le commentaire sÃ©parÃ©ment

            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            if (!comments[outingId]) {

                comments[outingId] = {};

            }

            comments[outingId][participantId] = comment;

            localStorage.setItem('attendance-comments', JSON.stringify(comments));

        }



        // Mettre Ã  jour les statistiques d'attendance

        function updateAttendanceStats(participants) {

            let present = 0, absent = 0, justified = 0, total = participants.length;

            

            participants.forEach(participant => {

                switch(participant.attendance) {

                    case 'present': present++; break;

                    case 'absent': absent++; break;

                    case 'justified': justified++; break;

                }

            });



            document.getElementById('presentCount').textContent = present;

            document.getElementById('absentCount').textContent = absent;

            document.getElementById('justifiedCount').textContent = justified;

            document.getElementById('totalCount').textContent = total;

        }



        // Mettre Ã  jour les statistiques depuis les donnÃ©es actuelles

        function updateAttendanceStatsFromCurrent() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            const currentAttendance = attendanceRecords[outingId] || {};

            

            let present = 0, absent = 0, justified = 0, total = 0;

            

            Object.values(currentAttendance).forEach(status => {

                total++;

                switch(status) {

                    case 'present': present++; break;

                    case 'absent': absent++; break;

                    case 'justified': justified++; break;

                }

            });



            document.getElementById('presentCount').textContent = present;

            document.getElementById('absentCount').textContent = absent;

            document.getElementById('justifiedCount').textContent = justified;

            document.getElementById('totalCount').textContent = total;

        }



        // Marquer tous les participants comme prÃ©sents

        function markAllPresent() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            if (!attendanceRecords[outingId]) {

                attendanceRecords[outingId] = {};

            }



            // Marquer tous les participants comme prÃ©sents

            document.querySelectorAll('input[type="radio"][value="present"]').forEach(radio => {

                radio.checked = true;

                const participantId = radio.name.replace('attendance_', '');

                attendanceRecords[outingId][participantId] = 'present';

            });



            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));

            updateAttendanceStatsFromCurrent();

            

            alert('âœ… Tous les participants ont Ã©tÃ© marquÃ©s comme prÃ©sents !');

        }



        // Marquer tous les participants comme absents

        function markAllAbsent() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            if (!attendanceRecords[outingId]) {

                attendanceRecords[outingId] = {};

            }



            // Marquer tous les participants comme absents

            document.querySelectorAll('input[type="radio"][value="absent"]').forEach(radio => {

                radio.checked = true;

                const participantId = radio.name.replace('attendance_', '');

                attendanceRecords[outingId][participantId] = 'absent';

            });



            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));

            updateAttendanceStatsFromCurrent();

            

            alert('âŒ Tous les participants ont Ã©tÃ© marquÃ©s comme absents !');

        }



        // Effacer toutes les donnÃ©es d'attendance

        function clearAttendance() {

            if (!confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir effacer toutes les donnÃ©es d\'attendance pour cette sortie ?')) {

                return;

            }



            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            // DÃ©cocher tous les boutons radio

            document.querySelectorAll('input[type="radio"]').forEach(radio => {

                radio.checked = false;

            });



            // Effacer les commentaires

            document.querySelectorAll('input[type="text"]').forEach(input => {

                if (input.placeholder === 'Commentaire...') {

                    input.value = '';

                }

            });



            // Supprimer les donnÃ©es du localStorage

            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            delete attendanceRecords[outingId];

            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));



            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            delete comments[outingId];

            localStorage.setItem('attendance-comments', JSON.stringify(comments));



            updateAttendanceStatsFromCurrent();

            alert('ğŸ”„ Toutes les donnÃ©es d\'attendance ont Ã©tÃ© effacÃ©es !');

        }



        // Filtrer par Ã©quipe

        function filterByTeam() {

            const filter = document.getElementById('teamFilter').value;

            const rows = document.querySelectorAll('#participantsTable tbody tr');

            

            rows.forEach(row => {

                const teamType = row.querySelector('td:first-child small').textContent.includes('Vie') ? 'life' : 'night';

                if (filter === '' || teamType === filter) {

                    row.style.display = '';

                } else {

                    row.style.display = 'none';

                }

            });

        }



        // Sauvegarder le registre d'attendance

        function saveAttendanceRecord() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            

            const record = {

                outingId: outingId,

                timestamp: new Date().toISOString(),

                attendance: attendanceRecords[outingId] || {},

                comments: comments[outingId] || {}

            };



            // Sauvegarder dans l'historique

            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const existingIndex = history.findIndex(h => h.outingId === outingId);

            

            if (existingIndex >= 0) {

                history[existingIndex] = record;

            } else {

                history.push(record);

            }

            

            localStorage.setItem('attendance-history', JSON.stringify(history));

            

            alert('ğŸ’¾ Registre d\'appel sauvegardÃ© avec succÃ¨s !');

            loadAttendanceHistory();

        }



        // Exporter les donnÃ©es d'attendance

        function exportAttendanceData() {

            const attendanceHistory = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            

            if (attendanceHistory.length === 0) {

                alert('ğŸ“Š Aucune donnÃ©e d\'attendance Ã  exporter.');

                return;

            }



            let csvContent = "Sortie,Date,Participant,Ã‰quipe,PrÃ©sence,Commentaire\n";

            

            attendanceHistory.forEach(record => {

                const outing = outings.find(o => o.id === record.outingId);

                const outingName = outing ? outing.name : 'Sortie inconnue';

                const date = new Date(record.timestamp).toLocaleDateString('fr-FR');

                

                Object.entries(record.attendance).forEach(([participantId, status]) => {

                    const [teamType, teamName, participantName] = participantId.split('_');

                    const comment = record.comments[participantId] || '';

                    const statusText = status === 'present' ? 'PrÃ©sent' : status === 'absent' ? 'Absent' : 'JustifiÃ©';

                    

                    csvContent += `"${outingName}","${date}","${participantName}","${teamName}","${statusText}","${comment}"\n`;

                });

            });



            // TÃ©lÃ©charger le fichier CSV

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });

            const link = document.createElement('a');

            const url = URL.createObjectURL(blob);

            link.setAttribute('href', url);

            link.setAttribute('download', `registre_appel_${new Date().toISOString().split('T')[0]}.csv`);

            link.style.visibility = 'hidden';

            document.body.appendChild(link);

            link.click();

            document.body.removeChild(link);

            

            alert('ğŸ“Š DonnÃ©es exportÃ©es avec succÃ¨s !');

        }
        // Supprimer un registre d'attendance

        function deleteAttendanceRecord(outingId) {

            if (!confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir supprimer ce registre d\'appel ? Cette action est irrÃ©versible.')) {

                return;

            }



            const history = JSON.parse(localStorage.getItem('attendance-history') || '[]');

            const updatedHistory = history.filter(record => record.outingId !== outingId);

            localStorage.setItem('attendance-history', JSON.stringify(updatedHistory));

            

            // Supprimer aussi les donnÃ©es actuelles

            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            delete attendanceRecords[outingId];

            localStorage.setItem('attendance-records', JSON.stringify(attendanceRecords));

            

            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            delete comments[outingId];

            localStorage.setItem('attendance-comments', JSON.stringify(comments));

            

            loadAttendanceHistory();

            alert('ğŸ—‘ï¸ Registre d\'appel supprimÃ© avec succÃ¨s !');

        }
        // Imprimer le registre d'attendance

        function printAttendanceRecord() {

            const outingId = document.getElementById('selectedOuting').value;

            if (!outingId) return;



            const outings = JSON.parse(localStorage.getItem('admin-outings') || '[]');

            const outing = outings.find(o => o.id === outingId);

            const attendanceRecords = JSON.parse(localStorage.getItem('attendance-records') || '{}');

            const comments = JSON.parse(localStorage.getItem('attendance-comments') || '{}');

            

            const currentAttendance = attendanceRecords[outingId] || {};

            const currentComments = comments[outingId] || {};



            if (!outing) {

                alert('âš ï¸ Sortie non trouvÃ©e.');

                return;

            }



            // CrÃ©er une fenÃªtre d'impression

            const printWindow = window.open('', '_blank');

            printWindow.document.write(`

                <html>

                    <head>

                        <title>Registre d'Appel - ${outing.name}</title>

                        <style>

                            body { font-family: Arial, sans-serif; margin: 20px; }

                            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }

                            .outing-info { margin-bottom: 30px; }

                            .info-row { margin-bottom: 10px; }

                            table { width: 100%; border-collapse: collapse; margin-top: 20px; }

                            th, td { border: 1px solid #333; padding: 8px; text-align: left; }

                            th { background-color: #f0f0f0; font-weight: bold; }

                            .stats { display: flex; justify-content: space-around; margin-top: 30px; }

                            .stat-box { text-align: center; padding: 10px; border: 1px solid #333; }

                            .footer { margin-top: 50px; text-align: center; font-size: 12px; color: #666; }

                        </style>

                    </head>

                    <body>

                        <div class="header">

                            <h1>ğŸ“‹ REGISTRE D'APPEL</h1>

                            <h2>${outing.name}</h2>

                        </div>

                        

                        <div class="outing-info">

                            <div class="info-row"><strong>Date :</strong> ${new Date(outing.startDate).toLocaleDateString('fr-FR')}</div>

                            <div class="info-row"><strong>Lieu :</strong> ${outing.location || 'Non spÃ©cifiÃ©'}</div>

                            <div class="info-row"><strong>Heure de dÃ©part :</strong> ${outing.departureTime || 'Non spÃ©cifiÃ©'}</div>

                            <div class="info-row"><strong>Description :</strong> ${outing.description || 'Aucune description'}</div>

                        </div>

                        

                        <table>

                            <thead>

                                <tr>

                                    <th>Participant</th>

                                    <th>Ã‰quipe</th>

                                    <th>PrÃ©sent</th>

                                    <th>Absent</th>

                                    <th>JustifiÃ©</th>

                                    <th>Commentaire</th>

                                    <th>Signature</th>

                                </tr>

                            </thead>

                            <tbody>

            `);



            // Ajouter les participants

            const lifeTeams = JSON.parse(localStorage.getItem('life-teams') || '[]');

            const nightTeams = JSON.parse(localStorage.getItem('night-teams') || '[]');

            

            [...lifeTeams, ...nightTeams].forEach(team => {

                team.members.forEach(member => {

                    const participantId = `${team.name.includes('Vie') ? 'life' : 'night'}_${team.name}_${member}`;

                    const attendance = currentAttendance[participantId] || 'unknown';

                    const comment = currentComments[participantId] || '';

                    

                    printWindow.document.write(`

                        <tr>

                            <td>${member}</td>

                            <td>${team.name}</td>

                            <td>${attendance === 'present' ? 'âœ“' : ''}</td>

                            <td>${attendance === 'absent' ? 'âœ“' : ''}</td>

                            <td>${attendance === 'justified' ? 'âœ“' : ''}</td>

                            <td>${comment}</td>

                            <td></td>

                        </tr>

                    `);

                });

            });



            // Calculer les statistiques

            const stats = { present: 0, absent: 0, justified: 0, total: 0 };

            Object.values(currentAttendance).forEach(status => {

                stats.total++;

                switch(status) {

                    case 'present': stats.present++; break;

                    case 'absent': stats.absent++; break;

                    case 'justified': stats.justified++; break;

                }

            });



            printWindow.document.write(`

                            </tbody>

                        </table>

                        

                        <div class="stats">

                            <div class="stat-box">

                                <strong>${stats.present}</strong><br>

                                PrÃ©sents

                            </div>

                            <div class="stat-box">

                                <strong>${stats.absent}</strong><br>

                                Absents

                            </div>

                            <div class="stat-box">

                                <strong>${stats.justified}</strong><br>

                                JustifiÃ©s

                            </div>

                            <div class="stat-box">

                                <strong>${stats.total}</strong><br>

                                Total

                            </div>

                        </div>

                        

                        <div class="footer">

                            <p>Registre gÃ©nÃ©rÃ© le ${new Date().toLocaleDateString('fr-FR')} Ã  ${new Date().toLocaleTimeString('fr-FR')}</p>

                        </div>

                    </body>

                </html>

            `);

            

            printWindow.document.close();

            printWindow.print();

        }



        // Activer l'onglet registre d'appel pour les admins

        function enableRegistreTab() {

            const registreTab = document.getElementById('registreTab');

            if (registreTab) {

                registreTab.style.display = 'inline-block';

            }

        }
        // Ajouter un enfant via la liste dÃ©roulante d'une voiture
        function addSelectedChildToCar(sectionId, carId) {
            const sel = document.getElementById(`add-child-select-${sectionId}-${carId}`);
            if (!sel) return;
            const fullName = sel.value;
            if (!fullName) return;
            const availableCars = JSON.parse(localStorage.getItem(`available-cars-${sectionId}`) || '[]');
            const car = availableCars.find(c => c.id == carId);
            if (!car) return;
            car.children = car.children || [];
            if (car.children.includes(fullName)) return;
            const capacity = parseInt(car.childSeats, 10) || 0;
            if (car.children.length >= capacity) {
                alert('âš ï¸ Plus de place dans cette voiture');
                return;
            }
            car.children.push(fullName);
            const idx = availableCars.findIndex(c => c.id == carId);
            if (idx >= 0) availableCars[idx] = car;
            localStorage.setItem(`available-cars-${sectionId}`, JSON.stringify(availableCars));
            loadAvailableCars(sectionId);
            try { loadChildrenWithoutCar(sectionId, 'aller'); } catch (e) {}
            try { loadChildrenWithoutCar(sectionId, 'retour'); } catch (e) {}
        }



        // Fonction enableAdminMode complÃ¨te

        function enableAdminMode() {

            // Utiliser notre nouveau systÃ¨me d'onglets admin

            if (typeof showAdminTabs === 'function') {

                showAdminTabs();

            }

            

            // Activer aussi le registre d'appel

            if (typeof enableRegistreTab === 'function') {

                enableRegistreTab();

            }

            // Mettre Ã  jour le compteur d'enfants importÃ©s sur la page Admin
            if (typeof updateChildrenCount === 'function') {
                try { updateChildrenCount(); } catch (e) {}
            }

            

            // Charger les Ã©lÃ©ments de la checklist

            setTimeout(() => {

                if (typeof loadChecklistItems === 'function') {

                    loadChecklistItems();

                }

                if (typeof loadCalendarTrips === 'function') {

                    loadCalendarTrips();

                }

            }, 100);

        }



        // Fonction pour charger les sorties du calendrier dans l'admin

        function loadCalendarTrips() {

            const calendarTripsList = document.getElementById('calendar-trips-list');

            if (!calendarTripsList) return;



            const events = getCalendarEvents();

            const trips = [];



            // Parcourir TOUS les Ã©vÃ©nements du calendrier (pas de filtre)

            Object.entries(events).forEach(([dateKey, event]) => {

                const tripDate = new Date(dateKey.split('-').reverse().join('-'));

                const formattedDate = tripDate.toLocaleDateString('fr-FR', {

                    weekday: 'long',

                    day: 'numeric',

                    month: 'long',

                    year: 'numeric'

                });



                trips.push({

                    id: dateKey.replace(/-/g, '_'),

                    title: event.title,

                    date: formattedDate,

                    description: event.description || '',

                    rawDate: dateKey

                });

            });



            // Trier les sorties par date

            trips.sort((a, b) => new Date(a.rawDate) - new Date(b.rawDate));



            // Charger les sÃ©lections sauvegardÃ©es (seulement pour le covoiturage)

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');



            // CrÃ©er l'interface

            let html = '';

            trips.forEach(trip => {

                const hasCarpool = savedCarpoolSelections[trip.id] || false;

                html += `

                    <div class="fey-item" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50; margin-bottom: 1rem;">

                        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 1rem; align-items: center;">

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ¯ Sortie</label>

                                <div style="font-weight: bold; color: var(--c-forest-700);">${trip.title}</div>

                                <div style="font-size: 0.9rem; color: var(--c-forest-600);">${trip.date}</div>

                                ${trip.description ? `<div style="font-size: 0.8rem; color: var(--c-ink-600); margin-top: 0.25rem;">${trip.description}</div>` : ''}

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“‹ Registre d'Appel</label>

                                <div style="font-size: 0.9rem; color: var(--c-forest-700); font-weight: bold;">

                                    ï£ˆ Automatique

                                </div>

                            </div>

                            <div>

                                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸš— Covoiturage</label>

                                <div style="display: flex; align-items: center; gap: 0.5rem;">

                                    <input type="checkbox" id="carpool-${trip.id}" ${hasCarpool ? 'checked' : ''} onchange="updateCarpoolSelection('${trip.id}', this.checked)">

                                    <label for="carpool-${trip.id}" style="font-size: 0.9rem;">Activer le covoiturage</label>

                                </div>

                            </div>

                        </div>

                    </div>

                `;

            });



            calendarTripsList.innerHTML = html;

            console.log(`âœ… ${trips.length} sorties chargÃ©es dans l'admin`);

            

            // Charger aussi les sorties avec covoiturage dans la section dÃ©diÃ©e

            loadCarpoolTripsInAdmin();

        }



        // Fonction pour charger les sorties avec covoiturage dans la section admin

        function loadCarpoolTripsInAdmin() {

            console.log('ğŸ”„ Chargement des sorties covoiturage dans l\'admin...');

            

            const tripsManagement = document.getElementById('trips-management');

            if (!tripsManagement) return;

            

            // RÃ©cupÃ©rer les sÃ©lections de covoiturage sauvegardÃ©es

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

            const events = getCalendarEvents();

            

            // Filtrer les sorties qui ont le covoiturage activÃ©

            const carpoolTrips = [];

            Object.entries(events).forEach(([dateKey, event]) => {

                const tripId = dateKey.replace(/-/g, '_');

                if (savedCarpoolSelections[tripId]) {

                    const tripDate = new Date(dateKey.split('-').reverse().join('-'));

                    const formattedDate = tripDate.toISOString().split('T')[0]; // Format YYYY-MM-DD pour input date

                    

                    carpoolTrips.push({

                        id: tripId,

                        title: event.title,

                        date: formattedDate,

                        description: event.description || '',

                        rawDate: dateKey

                    });

                }

            });

            

            // Trier par date

            carpoolTrips.sort((a, b) => new Date(a.rawDate) - new Date(b.rawDate));

            

            console.log(`ğŸš— ${carpoolTrips.length} sorties avec covoiturage trouvÃ©es pour l'admin`);

            

            // Charger les donnÃ©es sauvegardÃ©es

            const carpoolTripsData = JSON.parse(localStorage.getItem('carpool-trips-data') || '{}');

            

            // CrÃ©er l'interface pour chaque sortie avec covoiturage

            let html = '';

            if (carpoolTrips.length === 0) {

                html = `

                    <div class="fey-note" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800;">

                        <strong>ğŸ“ Aucune sortie avec covoiturage :</strong> Activez le covoiturage pour des sorties dans la section ci-dessus.

                    </div>

                `;

            } else {

                carpoolTrips.forEach(trip => {

                    // RÃ©cupÃ©rer les donnÃ©es sauvegardÃ©es pour cette sortie

                    const savedData = carpoolTripsData[trip.id] || {};

                    const title = savedData.title || trip.title;

                    const date = savedData.date || trip.date;

                    const departureTime = savedData.departureTime || '08:00';

                    const returnTime = savedData.returnTime || '17:00';

                    

                    html += `

                        <div class="fey-item" data-title="${trip.title}" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3; margin-bottom: 1rem; cursor: pointer;" onclick="selectCarpoolOuting('${trip.id}', this.getAttribute('data-title'))">

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; align-items: center;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ¯ Nom de la Sortie</label>

                                    <input type="text" value="${title}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);" data-trip-id="${trip.id}" disabled>

                                </div>

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“… Date</label>

                                    <input type="date" value="${date}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);" data-trip-id="${trip.id}" disabled>

                                </div>

                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Point de DÃ©part (FIXÃ‰)</label>

                                    <input type="text" value="Place de la Mairie" readonly style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); background: #f5f5f5;">

                                </div>

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Point d'ArrivÃ©e (FIXÃ‰)</label>

                                    <input type="text" value="Jambville" readonly style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); background: #f5f5f5;">

                                </div>

                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure DÃ©part</label>

                                    <input type="time" value="${departureTime}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);" data-trip-id="${trip.id}" disabled>

                                </div>

                                <div>

                                    <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">â° Heure Retour</label>

                                    <input type="time" value="${returnTime}" style="width: 100%; padding: 0.5rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);" data-trip-id="${trip.id}" disabled>

                                </div>

                            </div>

                            <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">

                                <button class="fey-btn" onclick="saveCarpoolTrip('${trip.id}')" style="background: #4CAF50; font-size: 0.9rem; padding: 0.5rem 1rem;">ğŸ’¾ Sauvegarder</button>

                                <button class="fey-btn" onclick="editCarpoolTrip('${trip.id}')" style="background: #FF9800; font-size: 0.9rem; padding: 0.5rem 1rem;">âœï¸ Modifier</button>

                                <button class="fey-btn" onclick="removeCarpoolTrip('${trip.id}')" style="background: #F44336; font-size: 0.9rem; padding: 0.5rem 1rem;">ğŸ—‘ï¸ Supprimer</button>

                                <button class="fey-btn" onclick="copyCarpoolLink('${trip.id}')" style="background: #9C27B0; font-size: 0.9rem; padding: 0.5rem 1rem;">ğŸ”— Copier lien parents</button>

                            </div>

                        </div>

                    `;

                });

            }

            

            tripsManagement.innerHTML = html;

            

            // Ajouter un bouton de rechargement si il y a des sorties

            if (carpoolTrips.length > 0) {

                const refreshButton = `

                    <div style="margin-top: 1rem; text-align: center;">

                        <button onclick="loadCarpoolTripsInAdmin()" class="fey-btn" style="background: #2196F3;">

                            ğŸ”„ Recharger les sorties covoiturage

                        </button>

                    </div>

                `;

                tripsManagement.insertAdjacentHTML('beforeend', refreshButton);

            }

        }
        // Fonction pour mettre Ã  jour la sÃ©lection de covoiturage d'une sortie

        function updateCarpoolSelection(tripId, hasCarpool) {

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

            savedCarpoolSelections[tripId] = hasCarpool;

            localStorage.setItem('carpool-selections', JSON.stringify(savedCarpoolSelections));

            

            console.log(`ğŸš— Covoiturage ${hasCarpool ? 'activÃ©' : 'dÃ©sactivÃ©'} pour ${tripId}`);

            

            // Recharger la section covoiturage si elle est visible

            const covoituragePage = document.getElementById('covoiturage');

            if (covoituragePage && covoituragePage.classList.contains('active')) {

                loadCarpoolTripsFromCalendar();

            }

            

            // Recharger la section admin des sorties covoiturage

            loadCarpoolTripsInAdmin();

        }



        // Fonction pour sauvegarder toutes les sÃ©lections

        function saveTripSelections() {

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

            const selectedCarpoolTrips = Object.keys(savedCarpoolSelections).filter(id => savedCarpoolSelections[id]);

            

            localStorage.setItem('carpool-selections', JSON.stringify(savedCarpoolSelections));

            alert(`ğŸ’¾ ${selectedCarpoolTrips.length} sorties avec covoiturage sauvegardÃ©es !`);

            

            // Recharger la liste du registre d'appel

            loadTripsFromCalendar();

            

            // Recharger la section covoiturage si elle est visible

            const covoituragePage = document.getElementById('covoiturage');

            if (covoituragePage && covoituragePage.classList.contains('active')) {

                loadCarpoolTripsFromCalendar();

            }

            

            // Recharger la section admin des sorties covoiturage

            loadCarpoolTripsInAdmin();

        }
        // Fonctions pour gÃ©rer les sorties covoiturage dans l'admin

        function saveCarpoolTrip(tripId) {

            console.log(`ğŸ’¾ Sauvegarde de la sortie covoiturage: ${tripId}`);

            // RÃ©cupÃ©rer les donnÃ©es du formulaire

            const tripContainer = document.querySelector(`[data-trip-id="${tripId}"]`).closest('.fey-item');

            const title = tripContainer.querySelector('input[type="text"]').value;

            const date = tripContainer.querySelector('input[type="date"]').value;

            const departureTime = tripContainer.querySelector('input[type="time"]').value;

            const returnTime = tripContainer.querySelectorAll('input[type="time"]')[1].value;

            

            // Sauvegarder dans le localStorage

            const carpoolTripsData = JSON.parse(localStorage.getItem('carpool-trips-data') || '{}');

            carpoolTripsData[tripId] = {

                title: title,

                date: date,

                departureTime: departureTime,

                returnTime: returnTime,

                departurePoint: 'Place de la Mairie',

                arrivalPoint: 'Jambville'

            };

            localStorage.setItem('carpool-trips-data', JSON.stringify(carpoolTripsData));

            

            alert(`âœ… Sortie "${title}" sauvegardÃ©e avec succÃ¨s !`);

        }



        function editCarpoolTrip(tripId) {

            console.log(`âœï¸ Modification de la sortie covoiturage: ${tripId}`);

            const tripContainer = document.querySelector(`[data-trip-id="${tripId}"]`).closest('.fey-item');

            const inputs = tripContainer.querySelectorAll('input:not([readonly])');

            

            // Activer l'Ã©dition

            inputs.forEach(input => {

                input.disabled = false;

                input.style.background = '#fff';

            });

            

            // Changer le bouton en "Confirmer"

            const editBtn = tripContainer.querySelector(`button[onclick="editCarpoolTrip('${tripId}')"]`);

            editBtn.innerHTML = 'ï£ˆ Confirmer';

            editBtn.onclick = () => confirmCarpoolTripEdit(tripId);

        }



        function confirmCarpoolTripEdit(tripId) {

            console.log(`âœ… Confirmation de l'Ã©dition: ${tripId}`);

            const tripContainer = document.querySelector(`[data-trip-id="${tripId}"]`).closest('.fey-item');

            const inputs = tripContainer.querySelectorAll('input:not([readonly])');

            

            // DÃ©sactiver l'Ã©dition

            inputs.forEach(input => {

                input.disabled = true;

                input.style.background = '#f5f5f5';

            });

            

            // Remettre le bouton en "Modifier"

            const editBtn = tripContainer.querySelector(`button[onclick="confirmCarpoolTripEdit('${tripId}')"]`);

            editBtn.innerHTML = 'âœï¸ Modifier';

            editBtn.onclick = () => editCarpoolTrip(tripId);

            

            // Sauvegarder automatiquement

            saveCarpoolTrip(tripId);

        }
        function removeCarpoolTrip(tripId) {

            if (confirm(`ğŸ—‘ï¸ ÃŠtes-vous sÃ»r de vouloir supprimer cette sortie covoiturage ?`)) {

                console.log(`ğŸ—‘ï¸ Suppression de la sortie covoiturage: ${tripId}`);

                

                // DÃ©sactiver le covoiturage pour cette sortie

                const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

                savedCarpoolSelections[tripId] = false;

                localStorage.setItem('carpool-selections', JSON.stringify(savedCarpoolSelections));

                

                // Supprimer les donnÃ©es de covoiturage

                const carpoolTripsData = JSON.parse(localStorage.getItem('carpool-trips-data') || '{}');

                delete carpoolTripsData[tripId];

                localStorage.setItem('carpool-trips-data', JSON.stringify(carpoolTripsData));

                

                // Recharger les sections

                loadCarpoolTripsInAdmin();

                loadCalendarTrips();

                

                alert(`âœ… Sortie covoiturage supprimÃ©e ! Le covoiturage a Ã©tÃ© dÃ©sactivÃ© pour cette sortie.`);

            }

        }



        // Fonction pour copier le lien de covoiturage dans le presse-papier

        function copyCarpoolLink(tripId) {

            // Construire l'URL complÃ¨te avec le paramÃ¨tre outing

            const baseUrl = window.location.origin + window.location.pathname.replace('index.html', '');

            const carpoolUrl = `${baseUrl}carpool-link.html?outing=${tripId}`;



            // Copier dans le presse-papier

            navigator.clipboard.writeText(carpoolUrl).then(() => {

                alert(`ğŸ”— Lien copiÃ© !\n\nVous pouvez maintenant l'envoyer aux parents :\n\n${carpoolUrl}`);

            }).catch(err => {

                // Fallback si clipboard API n'est pas disponible

                prompt('ğŸ“‹ Copiez ce lien pour les parents:', carpoolUrl);

            });

        }



        // Fonction pour charger les sorties avec covoiturage depuis le calendrier

        function loadCarpoolTripsFromCalendar() {

            console.log('ğŸ”„ Chargement des sorties avec covoiturage...');

            

            // RÃ©cupÃ©rer les sÃ©lections de covoiturage sauvegardÃ©es

            const savedCarpoolSelections = JSON.parse(localStorage.getItem('carpool-selections') || '{}');

            const events = getCalendarEvents();

            

            // Filtrer les sorties qui ont le covoiturage activÃ©

            const carpoolTrips = [];

            Object.entries(events).forEach(([dateKey, event]) => {

                const tripId = dateKey.replace(/-/g, '_');

                if (savedCarpoolSelections[tripId]) {

                    const tripDate = new Date(dateKey.split('-').reverse().join('-'));

                    const formattedDate = tripDate.toLocaleDateString('fr-FR', {

                        weekday: 'long',

                        day: 'numeric',

                        month: 'long',

                        year: 'numeric'

                    });

                    

                    carpoolTrips.push({

                        id: tripId,

                        title: event.title,

                        date: formattedDate,

                        description: event.description || '',

                        rawDate: dateKey

                    });

                }

            });

            

            // Trier par date

            carpoolTrips.sort((a, b) => new Date(a.rawDate) - new Date(b.rawDate));

            

            console.log(`ğŸš— ${carpoolTrips.length} sorties avec covoiturage trouvÃ©es`);

            

            // Mettre Ã  jour l'interface covoiturage

            updateCarpoolInterface(carpoolTrips);

        }
        // Fonction pour mettre Ã  jour l'interface covoiturage

        function updateCarpoolInterface(carpoolTrips) {

            // Trouver le conteneur des sorties covoiturage

            const carpoolContainer = document.querySelector('#covoiturage .fey-card:first-of-type');

            if (!carpoolContainer) return;

            

            // Nettoyer le contenu existant (garder seulement le header)

            const header = carpoolContainer.querySelector('.fey-card-header');

            if (header) {

                // Supprimer tous les Ã©lÃ©ments aprÃ¨s le header

                let nextElement = header.nextElementSibling;

                while (nextElement) {

                    const toRemove = nextElement;

                    nextElement = nextElement.nextElementSibling;

                    toRemove.remove();

                }

            }

            

            // CrÃ©er la liste des sorties avec covoiturage

            let html = '';

            if (carpoolTrips.length === 0) {

                html = `

                    <div class="fey-note" style="background: linear-gradient(135deg, #FFF3E0, #FFE0B2); border-left: 4px solid #FF9800;">

                        <strong>ğŸ“ Aucune sortie avec covoiturage :</strong> Activez le covoiturage pour des sorties dans la section Admin.

                    </div>

                `;

            } else {

                html = `

                    <div class="fey-note" style="background: linear-gradient(135deg, #E8F5E8, #C8E6C9); border-left: 4px solid #4CAF50;">

                        <strong>ğŸš— Sorties avec covoiturage activÃ© :</strong> ${carpoolTrips.length} sortie(s) nÃ©cessitant du covoiturage.

                    </div>

                `;

                

                carpoolTrips.forEach(trip => {

                    html += `

                        <div class="fey-item" style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-left: 4px solid #2196F3; margin-bottom: 1rem;">

                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem; align-items: center;">

                                <div>

                                    <div style="font-weight: bold; color: var(--c-forest-700); font-size: 1.1rem;">${trip.title}</div>

                                    <div style="font-size: 0.9rem; color: var(--c-forest-600); margin-top: 0.25rem;">${trip.date}</div>

                                    ${trip.description ? `<div style="font-size: 0.8rem; color: var(--c-ink-600); margin-top: 0.25rem;">${trip.description}</div>` : ''}

                                </div>

                                <div style="text-align: center;">

                                    <div style="font-size: 0.9rem; color: var(--c-forest-700); font-weight: bold; margin-bottom: 0.5rem;">ğŸš— Covoiturage</div>

                                    <div style="background: #4CAF50; color: white; padding: 0.5rem; border-radius: var(--r-sm); font-weight: bold;">

                                        âœ… ActivÃ©

                                    </div>

                                </div>

                            </div>

                        </div>

                    `;

                });

            }

            

            // Ajouter le contenu aprÃ¨s le header

            if (header) {

                header.insertAdjacentHTML('afterend', html);

                

                // Ajouter un bouton de rechargement

                const refreshButton = `

                    <div style="margin-top: 1rem; text-align: center;">

                        <button onclick="loadCarpoolTripsFromCalendar()" class="fey-btn" style="background: #2196F3; margin-right: 1rem;">

                            ğŸ”„ Recharger les sorties

                        </button>

                        <button onclick="showPage('admin')" class="fey-btn" style="background: #9C27B0;">

                            âš™ï¸ GÃ©rer les sorties

                        </button>

                    </div>

                `;

                header.insertAdjacentHTML('afterend', refreshButton);

            }

        }



        // Met Ã  jour l'URL ?outing=... sans rechargement
        function setOutingQueryParam(outingTitleOrId) {
            try {
                const url = new URL(window.location.href);
                if (outingTitleOrId) {
                    url.searchParams.set('outing', outingTitleOrId);
                } else {
                    url.searchParams.delete('outing');
                }
                window.history.replaceState({}, '', url.toString());
            } catch (e) {}
        }

        // Lors d'un clic sur une sortie covoiturage
        function selectCarpoolOuting(tripId, tripTitle) {
            setOutingQueryParam(tripTitle || tripId);
            try { document.getElementById('covoiturage').scrollIntoView({ behavior: 'smooth' }); } catch (e) {}
        }

        // Au chargement, si ?outing= prÃ©sent, afficher la page covoiturage
        (function initOutingFromURL_Index() {
            try {
                const url = new URL(window.location.href);
                const outing = url.searchParams.get('outing');
                if (outing && typeof window.showPage === 'function') {
                    window.showPage('covoiturage');
                }
            } catch (e) {}
        })();

        // Fonction pour charger les Ã©lÃ©ments de la checklist

        function loadChecklistItems() {

            const container = document.getElementById('checklistItemsList');

            if (!container) return;



            const items = JSON.parse(localStorage.getItem('checklist-items') || '[]');

            

            if (items.length === 0) {

                container.innerHTML = '<p style="text-align: center; color: #666;">Aucun Ã©lÃ©ment personnalisÃ© ajoutÃ©</p>';

                return;

            }



            let html = '<h4 style="color: var(--c-forest-700); margin-bottom: 1rem;">ğŸ“‹ Ã‰lÃ©ments PersonnalisÃ©s</h4>';

            

            items.forEach(item => {

                html += `

                    <div style="display: flex; align-items: center; gap: 1rem; padding: 0.5rem; border: 1px solid var(--c-ink-900); border-radius: var(--r-sm); margin-bottom: 0.5rem; background: ${item.isOptional ? 'linear-gradient(135deg, #FFF3E0, #FFE0B2)' : 'linear-gradient(135deg, #E8F5E8, #C8E6C9)'};">

                        <div style="flex: 1;">

                            <div style="font-weight: bold;">${item.text}</div>

                            <div style="font-size: 0.9rem; color: #666;">

                                ğŸ“‚ ${item.category} ${item.isOptional ? 'ğŸ”§ (Facultatif)' : 'âš¡ (Obligatoire)'}

                            </div>

                            ${item.tooltip ? `<div style="font-size: 0.8rem; color: #888; font-style: italic;">ğŸ’¡ ${item.tooltip}</div>` : ''}

                        </div>

                        <button class="fey-btn" onclick="deleteChecklistItem(${item.id})" style="background: #F44336; font-size: 0.8rem; padding: 0.25rem 0.5rem;">

                            ğŸ—‘ï¸

                        </button>

                    </div>

                `;

            });

            

            container.innerHTML = html;

        }
        // Fonction pour afficher le modal d'ajout d'Ã©lÃ©ment

        function showAddItemModal() {

            const modal = document.createElement('div');

            modal.id = 'addItemModal';

            modal.style.cssText = `

                position: fixed;

                top: 0;

                left: 0;

                width: 100%;

                height: 100%;

                background: rgba(0, 0, 0, 0.5);

                z-index: 1000;

                display: flex;

                justify-content: center;

                align-items: center;

            `;

            

            modal.innerHTML = `

                <div style="

                    background: var(--c-parchment);

                    border-radius: var(--r-md);

                    padding: 2rem;

                    max-width: 600px;

                    width: 90%;

                    max-height: 80vh;

                    overflow-y: auto;

                    border: 3px solid var(--c-ink-900);

                ">

                    <div class="fey-card-header">â• Ajouter un Ã‰lÃ©ment Ã  la Liste</div>

                    <form id="addItemForm" style="display: flex; flex-direction: column; gap: 1rem;">

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“ Texte de l'Ã©lÃ©ment</label>

                            <input type="text" name="itemText" placeholder="Ex: T-shirt de rechange" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>

                        

                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ“‚ CatÃ©gorie</label>

                            <select name="category" required style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                                <option value="sac-couchage">ğŸ’ Sac et couchage</option>

                                <option value="vÃªtements">ğŸ‘• VÃªtements</option>

                                <option value="chaussures">ğŸ‘Ÿ Chaussures</option>

                                <option value="hygiÃ¨ne">ğŸ§¼ HygiÃ¨ne</option>

                                <option value="matÃ©riel">ğŸ› ï¸ MatÃ©riel</option>

                                <option value="documents">ğŸ“„ Documents</option>

                                <option value="nourriture">ğŸ Nourriture</option>

                                <option value="autre">ğŸ”§ Autre</option>

                            </select>

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ”— Lien exemple (optionnel)</label>

                            <input type="url" name="exampleLink" placeholder="https://exemple.com" style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm);">

                        </div>



                        <div>

                            <label style="display: block; margin-bottom: 0.5rem; font-weight: bold;">ğŸ’¡ Info-bulle (optionnel)</label>

                            <textarea name="tooltip" placeholder="Conseil ou information supplÃ©mentaire..." style="width: 100%; padding: 0.75rem; border: 2px solid var(--c-ink-900); border-radius: var(--r-sm); height: 60px; resize: vertical;"></textarea>

                        </div>



                        <div style="background: linear-gradient(135deg, #E3F2FD, #BBDEFB); padding: 1rem; border-radius: var(--r-sm); border: 2px solid var(--c-ink-900);">

                            <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: bold; cursor: pointer;">

                                <input type="checkbox" name="isOptional" style="transform: scale(1.2);">

                                ğŸ”§ Ã‰lÃ©ment facultatif

                            </label>

                            <small style="color: #666; margin-top: 0.5rem; display: block;">

                                Si cochÃ©, l'Ã©lÃ©ment sera marquÃ© comme facultatif dans la liste

                            </small>

                        </div>



                        <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem;">

                            <button type="submit" class="fey-btn" style="background: #4CAF50; padding: 0.75rem 1.5rem;">

                                âœ… Ajouter l'Ã‰lÃ©ment

                            </button>

                            <button type="button" onclick="closeAddItemModal()" class="fey-btn" style="background: #F44336; padding: 0.75rem 1.5rem;">

                                âŒ Annuler

                            </button>

                        </div>

                    </form>

                </div>

            `;



            document.body.appendChild(modal);



            // GÃ©rer la soumission du formulaire

            document.getElementById('addItemForm').addEventListener('submit', function(e) {

                e.preventDefault();

                

                const formData = new FormData(this);

                const itemData = {

                    id: Date.now(),

                    text: formData.get('itemText'),

                    category: formData.get('category'),

                    exampleLink: formData.get('exampleLink'),

                    tooltip: formData.get('tooltip'),

                    isOptional: formData.get('isOptional') === 'on',

                    isChecked: false

                };



                // Sauvegarder l'Ã©lÃ©ment

                const existingItems = JSON.parse(localStorage.getItem('checklist-items') || '[]');

                existingItems.push(itemData);

                localStorage.setItem('checklist-items', JSON.stringify(existingItems));



                alert('âœ… Ã‰lÃ©ment ajoutÃ© avec succÃ¨s !');

                closeAddItemModal();

                loadChecklistItems();

            });

        }



        // Fonction pour fermer le modal d'ajout

        function closeAddItemModal() {

            const modal = document.getElementById('addItemModal');

            if (modal) {

                modal.remove();

            }

        }
        // RÃ©initialiser les informations de contact

        function resetContactInfo() {

            if (!confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir rÃ©initialiser toutes les informations de contact ?')) {

                return;

            }



            localStorage.removeItem('contact-info');

            loadContactInfo();

            alert('ğŸ”„ Informations de contact rÃ©initialisÃ©es !');

        }



        // Ouvrir le drive des documents

        function ouvrirDrive() {

            const contactInfo = JSON.parse(localStorage.getItem('contact-info') || '{}');

            const driveLink = contactInfo.driveLink || 'https://drive.google.com/drive/folders/1BiH607P0bDlCc7g8thPl5V-uZQ71qA_a';

            

            if (driveLink) {

                window.open(driveLink, '_blank');

            } else {

                alert('âš ï¸ Veuillez d\'abord configurer le lien du drive dans le panneau admin.');

            }

        }



        // Fonctions existantes (Ã  conserver)

        function ouvrirMaps() {

            window.open('https://maps.google.com/?q=Jambville+78440', '_blank');

        }
        function ouvrirWhatsApp() {

            const contactInfo = JSON.parse(localStorage.getItem('contact-info') || '{}');

            const contacts = contactInfo.contacts || [];

            const responsable = contacts.find(c => c.role === 'Responsable');

            

            if (responsable && responsable.phone) {

                const phoneNumber = responsable.phone.replace(/[^0-9]/g, '');

                window.open(`https://wa.me/33${phoneNumber}`, '_blank');

            } else {

                alert('âš ï¸ Aucun numÃ©ro de responsable configurÃ©. Veuillez configurer les contacts dans le panneau admin.');

            }

        }
        // Ajouter un nouveau contact

        function addNewContact() {

            const name = prompt('Nom du contact:');

            if (!name) return;

            

            const role = prompt('RÃ´le (ex: Cheftaine, Assistant, etc.):');

            if (!role) return;

            

            const phone = prompt('TÃ©lÃ©phone:');

            if (!phone) return;

            

            const email = prompt('Email:');

            if (!email) return;

            

            const period = prompt('PÃ©riode d\'activitÃ© (ex: Toute l\'annÃ©e, Samedis, etc.):');

            if (!period) return;

            

            const contacts = JSON.parse(localStorage.getItem('scout-contacts') || '[]');

            const newContact = {

                id: Date.now(),

                name,

                role,

                phone,

                email,

                period

            };

            

            contacts.push(newContact);

            localStorage.setItem('scout-contacts', JSON.stringify(contacts));

            displayContacts(contacts);

        }

        

        // Ã‰diter un contact

        function editContact(contactId) {

            const contacts = JSON.parse(localStorage.getItem('scout-contacts') || '[]');

            const contact = contacts.find(c => c.id === contactId);

            if (!contact) return;

            

            const name = prompt('Nom du contact:', contact.name);

            if (name === null) return;

            

            const role = prompt('RÃ´le:', contact.role);

            if (role === null) return;

            

            const phone = prompt('TÃ©lÃ©phone:', contact.phone);

            if (phone === null) return;

            

            const email = prompt('Email:', contact.email);

            if (email === null) return;

            

            const period = prompt('PÃ©riode d\'activitÃ©:', contact.period);

            if (period === null) return;

            

            // Mettre Ã  jour le contact

            contact.name = name;

            contact.role = role;

            contact.phone = phone;

            contact.email = email;

            contact.period = period;

            

            localStorage.setItem('scout-contacts', JSON.stringify(contacts));

            displayContacts(contacts);

        }

        

        // Supprimer un contact

        function deleteContact(contactId) {

            if (confirm('ÃŠtes-vous sÃ»r de vouloir supprimer ce contact ?')) {

                const contacts = JSON.parse(localStorage.getItem('scout-contacts') || '[]');

                const filtered = contacts.filter(c => c.id !== contactId);

                localStorage.setItem('scout-contacts', JSON.stringify(filtered));

                displayContacts(filtered);

            }

        }



        // Fonction pour charger les donnÃ©es de la page infos (stub pour compatibilitÃ©)
        function loadInfoData() {
            // Les donnÃ©es sont maintenant gÃ©rÃ©es par les autres services
            // Cette fonction est gardÃ©e pour Ã©viter les erreurs
            console.log('[loadInfoData] Fonction obsolÃ¨te - maintenant gÃ©rÃ©e par les services');
        }

        // Fonctions covoiturage obsolÃ¨tes (stubs pour compatibilitÃ©)
        function loadCarpoolListForSection(sectionId) {
            console.log('[loadCarpoolListForSection] Fonction obsolÃ¨te - covoiturage maintenant dans carpool-link.html');
        }

        function loadCarpoolList() {
            console.log('[loadCarpoolList] Fonction obsolÃ¨te - covoiturage maintenant dans carpool-link.html');
        }

        function showCarpoolTab(tabId) {
            console.log('[showCarpoolTab] Fonction obsolÃ¨te - covoiturage maintenant dans carpool-link.html');
        }

        function loadChildrenWithoutCar(sectionId, direction) {
            console.log('[loadChildrenWithoutCar] Fonction obsolÃ¨te - covoiturage maintenant dans carpool-link.html');
        }

        // Ã‰diter la prochaine sortie

        function editNextOuting() {

            const currentData = JSON.parse(localStorage.getItem('scout-info-data') || '{}').nextOuting || {};

            

            const title = prompt('Titre de la sortie:', currentData.title || 'Sortie en forÃªt');

            if (title === null) return;

            

            const date = prompt('Date:', currentData.date || '15 dÃ©cembre 2024');

            if (date === null) return;

            

            const time = prompt('Heures (ex: 09h00 - 17h00):', currentData.time || '09h00 - 17h00');

            if (time === null) return;

            

            const location = prompt('Lieu:', currentData.location || 'ForÃªt de CompiÃ¨gne');

            if (location === null) return;

            

            const contact = prompt('Contact:', currentData.contact || 'Marie (06 12 34 56 78)');

            if (contact === null) return;



            // Mettre Ã  jour les donnÃ©es

            const data = JSON.parse(localStorage.getItem('scout-info-data') || '{}');

            data.nextOuting = { title, date, time, location, contact };

            localStorage.setItem('scout-info-data', JSON.stringify(data));

            

            // Recharger l'affichage

            loadInfoData();

        }



        // Ã‰diter le lieu de rendez-vous

        function editMeetingPlace() {

            const currentData = JSON.parse(localStorage.getItem('scout-info-data') || '{}').meetingPlace || {};

            

            const address = prompt('Adresse du lieu de rendez-vous:', currentData.address || 'Local Scout, 123 Rue de la Paix, 60200 CompiÃ¨gne');

            if (address === null) return;

            

            const time = prompt('Heure habituelle:', currentData.time || '08h30');

            if (time === null) return;

            

            const contact = prompt('Contact local:', currentData.contact || 'Jean (06 98 76 54 32)');

            if (contact === null) return;



            // Mettre Ã  jour les donnÃ©es

            const data = JSON.parse(localStorage.getItem('scout-info-data') || '{}');

            data.meetingPlace = { address, time, contact };

            localStorage.setItem('scout-info-data', JSON.stringify(data));

            

            // Recharger l'affichage

            loadInfoData();

        }
        // Ã‰diter les informations gÃ©nÃ©rales

        function editGeneralInfo() {

            const currentData = JSON.parse(localStorage.getItem('scout-info-data') || '{}').general || {};

            

            const responsable = prompt('Responsable:', currentData.responsable || 'Marie Dubois');

            if (responsable === null) return;

            

            const phone = prompt('TÃ©lÃ©phone:', currentData.phone || '06 12 34 56 78');

            if (phone === null) return;

            

            const email = prompt('Email:', currentData.email || 'marie.dubois@scouts.fr');

            if (email === null) return;

            

            const hours = prompt('Horaires habituels:', currentData.hours || 'Samedi 09h-17h');

            if (hours === null) return;



            // Mettre Ã  jour les donnÃ©es

            const data = JSON.parse(localStorage.getItem('scout-info-data') || '{}');

            data.general = { responsable, phone, email, hours };

            localStorage.setItem('scout-info-data', JSON.stringify(data));

            

            // Recharger l'affichage

            loadInfoData();

        }



        // Sauvegarder toutes les informations

        function saveAllInfo() {

            alert('âœ… Toutes les informations ont Ã©tÃ© sauvegardÃ©es automatiquement !');

        }



        // RÃ©initialiser toutes les informations

        function resetAllInfo() {

            if (confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir rÃ©initialiser toutes les informations ?')) {

                localStorage.removeItem('scout-info-data');

                loadInfoData();

                alert('âœ… Informations rÃ©initialisÃ©es !');

            }

        }



        // Fonction pour vÃ©rifier l'authentification admin sur changement de page

        function checkAdminAuthOnPageChange() {

            setTimeout(() => {

                checkAdminAuth();

            }, 100);

        }

        

        // Fonctions admin obsolÃ¨tes (stubs pour compatibilitÃ©)
        function checkGlobalAdminAuth() {
            console.log('[checkGlobalAdminAuth] Fonction obsolÃ¨te');
        }

        function checkAdminAuth() {
            console.log('[checkAdminAuth] VÃ©rification de l\'authentification admin');
            // VÃ©rifier si on a le mot de passe admin en localStorage/sessionStorage
            const isAdmin = localStorage.getItem('admin-authenticated') === 'true' ||
                           sessionStorage.getItem('admin_mode') === 'true';
            const adminTab = document.getElementById('adminTab');
            const registreTab = document.getElementById('registreTab');

            if (adminTab) adminTab.style.display = isAdmin ? 'inline-block' : 'none';
            if (registreTab) registreTab.style.display = isAdmin ? 'inline-block' : 'none';
        }

        // Charger les informations au dÃ©marrage

        document.addEventListener('DOMContentLoaded', function() {

            loadInfoData();

            checkGlobalAdminAuth();

            checkAdminAuth();

        });

    </script>

</body>

</html>
